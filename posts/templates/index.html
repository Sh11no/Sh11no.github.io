<!DOCTYPE html>
<html itemscope itemtype="http://schema.org/WebPage" lang="zh-CN">
  <head>
    
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=2">
    <meta name="robots" content="noodp" />
    <title>板子 (Ver.诗乃) - Shino Channel</title><meta name="author" content="Shino">
<meta name="description" content="Tarjan&amp;Topo1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 void tarjan(int u) { dfn[u] = low[u] = &#43;&#43;tim; ins[u] = 1; stac[&#43;&#43;top] = u; for(int v, i = h[u]; ~i; i = e[i].next) if(!dfn[(v = e[i].to)]) { tarjan(v); low[u] = min(low[u], low[v]); } else if(ins[v]) low[u] = min(low[u], low[v]); if(low[u] == dfn[u]) { int y; while(y = stac[top--]) { sd[y] = u; ins[y] = 0; if(u == y) break; p[u] &#43;= p[y]; } } } void topo() { queue &lt;int&gt; q; for(int i = 1; i &lt;= n; &#43;&#43;i) if(sd[i] == i &amp;&amp; !in[i]) q.push(i), dis[i] = p[i]; while(!q.empty()) { int u = q.front(); q.pop(); for(int v, i = h[u]; ~i; i = e[i].next) { v = e[i].to; dis[v] = max(dis[v], dis[u] &#43; p[v]); --in[v]; if(!in[v]) q.push(v); } } int ans = 0; for(int i = 1; i &lt;= n; &#43;&#43;i) ans = max(ans, dis[i]); printf(&#34;%d\n&#34;, ans); } ST1 2 3 4 5 6 7 8 9 void ST_Build() { for(int j = 1; j &lt;= 21; &#43;&#43;j) for(int i = 1; i &#43; (1 &lt;&lt; j) - 1 &lt;= n; &#43;&#43;i) st[i][j] = max(st[i][j-1], st[i&#43;(1&lt;&lt;(j-1))][j-1]); } int ST_query(int l, int r) { int k = lg2[r-l&#43;1]; return max(st[l][k], st[r-(1&lt;&lt;k)&#43;1][k]); } ST-BlackMagic1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 struct RMQ { #define L(x) ((x-1)*siz&#43;1) #define R(x) std::min(n, x*siz&#43;1) #define bl(x) ((x-1)/siz&#43;1) const int MAXB = 2050, siz = 50; int prf[MAXN], suf[MAXN], n, st[MAXB][13], lg2[MAXN], a[MAXN]; void init(int *s, int _n, int k) { n = _n; for(int i = 1; i &lt;= n; &#43;&#43;i) a[i] = s[i] % k, st[bl(i)][0] = min(st[bl(i)][0], a[i]); for(int i = 1; i &lt;= bl(n); &#43;&#43;i) { prf[L(i)] = a[L(i)]; suf[R(i)] = a[R(i)]; for(int j = L(i)&#43;1; j &lt;= R(i); &#43;&#43;j) prf[j] = min(prf[j-1], a[j]); for(int j = R(i)-1; j &gt;= L(i); --j) suf[j] = min(suf[j&#43;1], a[j]); } for(int j = 1; j &lt;= 12; &#43;&#43;j) for(int i = 1; i &#43; (1 &lt;&lt; j) - 1 &lt;= bl(n); &#43;&#43;i) st[i][j] = min(st[i][j-1], st[i&#43;(1&lt;&lt;(j-1))][j-1]); } int QST(int l, int r) { if(l &gt; r) return 0; int k = lg2[r-l&#43;1]; return min(st[l][k], st[r-(1&lt;&lt;k)&#43;1][k]); } int query(int l, int r) { if(bl(l) == bl(r)) { int res = 0; for(int i = l; i &lt;= r; &#43;&#43;i) res = max(res, a[i]); return res; } else return min(min(prf[r], suf[l]), QST(bl(l)&#43;1, bl(r)-1)); } } ST; Manacher1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 void Manacher() { int mr = 0, mid; for(int i = 0; i &lt; n; &#43;&#43;i) { p[i] = i &lt; mr ? min(p[(mid &lt;&lt; 1) - i], p[mid] &#43; mid - i) : 1; for(; s[i-p[i]] == s[i&#43;p[i]]; &#43;&#43;p[i]); if(p[i] &#43; i &gt; mr) mr = i &#43; p[i], mid = i; } } int main() { scanf(&#34;%s&#34;, a); _n = strlen(a); s[0] = s[1] = &#39;#&#39;; n = 1; for(int i = 0; i &lt; _n; &#43;&#43;i) s[&#43;&#43;n] = a[i], s[&#43;&#43;n] = &#39;#&#39;; s[&#43;&#43;n] = 0; Manacher(); for(int i = 0; i &lt; n; &#43;&#43;i) ans = max(ans, p[i]); printf(&#34;%d\n&#34;, ans-1); } 线性基1 2 3 4 5 6 7 8 9 10 11 for(int i = 1; i &lt;= n; &#43;&#43;i) { read(a); for(int j = 50; j &gt;= 0; --j) { if((a &gt;&gt; j) &amp; 1) { if(!p[j]) {p[j] = a; break;} a ^= p[j]; } } } for(int i = 50; i &gt;= 0; --i) if(p[i]) ans = max(ans, ans ^ p[i]); 线性逆元1 2 3 inv[1] = 1; for(int i = 2; i &lt;= n; &#43;&#43;i) inv[i] = 1ll * (P - P / i) % P * inv[P % i]	% P; 后缀数组1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 void getSA() { for(int i = 1; i &lt;= n; &#43;&#43;i) &#43;&#43;c[x[i] = s[i]]; for(int i = 1; i &lt;= m; &#43;&#43;i) c[i] &#43;= c[i-1]; for(int i = n; i &gt;= 1; --i) sa[c[x[i]]--] = i; for(int k = 1; k &lt;= n; k &lt;&lt;= 1) { int num = 0; for(int i = n - k &#43; 1; i &lt;= n; &#43;&#43;i) y[&#43;&#43;num] = i; for(int i = 1; i &lt;= n; &#43;&#43;i) if(sa[i] &gt; k) y[&#43;&#43;num] = sa[i] - k; memset(c, 0, sizeof c); for(int i = 1; i &lt;= n; &#43;&#43;i) &#43;&#43;c[x[i]]; for(int i = 1; i &lt;= m; &#43;&#43;i) c[i] &#43;= c[i-1]; for(int i = n; i &gt;= 1; --i) sa[c[x[y[i]]]--] = y[i], y[i] = 0; swap(x, y); x[sa[1]] = 1; num = 0; for(int i = 1; i &lt;= n; &#43;&#43;i) x[sa[i]] = (y[sa[i-1]] == y[sa[i]] &amp;&amp; y[sa[i-1]&#43;k] == y[sa[i]&#43;k]) ? num : &#43;&#43;num; if(num == n) break; m = num; } } 点分治1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 void getroot(int u, int p, int S) { siz[u] = 1, f[u] = 0; for(int v, i = h[u]; ~i; i = e[i].next) if((v = e[i].to) != p &amp;&amp; !vis[v]) getroot(v, u, S), siz[u] &#43;= siz[v], f[u] = max(f[u], siz[v]); f[u] = max(f[u], S - siz[u]); rt = f[u] &lt; f[rt] ? u : rt; } void getdis(int u, int p) { stk[&#43;&#43;top] = dis[u]; for(int v, i = h[u]; ~i; i = e[i].next) if((v = e[i].to) != p &amp;&amp; !vis[v]) dis[v] = dis[u] &#43; e[i].w, getdis(v, u); } void solve(int u, int w, int t) { top = 0, dis[u] = w, getdis(u, 0); for(int i = 1; i &lt;= top; &#43;&#43;i) for(int j = 1; j &lt;= top; &#43;&#43;j) if(i != j) ans[stk[i] &#43; stk[j]] &#43;= t; } void devide(int u) { solve(u, 0, 1); vis[u] = 1; for(int v, i = h[u]; ~i; i = e[i].next) if(!vis[(v = e[i].to)]) { solve(v, e[i].w, -1), rt = 0, f[0] = n; getroot(v, u, siz[u]), devide(rt); } } 线段树1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 #define L(u) (u&lt;&lt;1) #define R(u) (u&lt;&lt;1|1) #define mid ((l&#43;r)&gt;&gt;1) void PU(int u) {t[u] = (t[L(u)] &#43; t[R(u)]) % P;} void ADD(int u, int l, int r, int k) { t[u] &#43;= (r - l &#43; 1) * k % P; t[u] %= P; add[u] = (add[u] &#43; k) % P; } void MUL(int u, int l, int r, int k) { t[u] = t[u] * k % P; add[u] = add[u] * k % P; mul[u] = mul[u] * k % P; } void PD(int u, int l, int r) { MUL(L(u), l, mid, mul[u]); MUL(R(u), mid&#43;1, r, mul[u]); mul[u] = 1; ADD(L(u), l, mid, add[u]); ADD(R(u), mid&#43;1, r, add[u]); add[u] = 0; } void build(int u, int l, int r) { mul[u] = 1; if(l == r) {t[u] = a[l]; return;} build(L(u), l, mid); build(R(u), mid&#43;1, r); PU(u); } void MA(int u, int l, int r, int tl, int tr, int k) { if(tr &lt; l || tl &gt; r) return; if(tl &lt;= l &amp;&amp; r &lt;= tr) {ADD(u, l, r, k); return;} PD(u, l, r); MA(L(u), l, mid, tl, tr, k); MA(R(u), mid&#43;1, r, tl, tr, k); PU(u); } void MM(int u, int l, int r, int tl, int tr, int k) { if(tr &lt; l || tl &gt; r) return; if(tl &lt;= l &amp;&amp; r &lt;= tr) {MUL(u, l, r, k); return;} PD(u, l, r); MM(L(u), l, mid, tl, tr, k); MM(R(u), mid&#43;1, r, tl, tr, k); PU(u); } int Q(int u, int l, int r, int tl, int tr) { if(tr &lt; l || tl &gt; r) return 0; if(tl &lt;= l &amp;&amp; r &lt;= tr) return t[u]; PD(u, l, r); return (Q(L(u), l, mid, tl, tr) &#43; Q(R(u), mid&#43;1, r, tl, tr)) % P; } 三分1 2 3 4 5 while(fabs(r-l) &gt;= eps) { double mid = (l &#43; r) / 2; if(f(mid - eps) &lt; f(mid &#43; eps)) l = mid; else r = mid; } 树状数组1 2 void U(int x, int k) {for(; x &lt;= n; t[x] &#43;= k, x &#43;= x&amp;-x);} int Q(int x) {int w = 0; for(; x; w &#43;= t[x], x -= x&amp;-x); return w;} 高斯消元1 2 3 4 5 6 7 8 9 10 11 12 13 for(int i = 1; i &lt;= n; &#43;&#43;i) { int p = i; for(int j = i &#43; 1; j &lt;= n; &#43;&#43;j) if(fabs(a[j][i]) &gt; fabs(a[p][i])) p = j; if(a[p][i] == 0) {puts(&#34;No Solution&#34;); return 0;} for(int j = 1; j &lt;= n&#43;1; &#43;&#43;j) swap(a[i][j], a[p][j]); for(int j = 1; j &lt;= n; &#43;&#43;j) { if(i == j) continue; double t = a[j][i] / a[i][i]; for(int k = i; k &lt;= n&#43;1; &#43;&#43;k) a[j][k] -= a[i][k] * t; } } for(int i = 1; i &lt;= n; &#43;&#43;i) printf(&#34;%.2lf\n&#34;, a[i][n&#43;1] / a[i][i]); 最小生成树&amp;并查集1 2 3 4 5 6 7 8 9 10 11 12 int findfa(int x) {return x == fa[x] ? x : fa[x] = findfa(fa[x]);} int main() { for(int i = 1; i &lt;= n; &#43;&#43;i) fa[i] = i; sort(e&#43;1, e&#43;m&#43;1); for(int i = 1; i &lt;= m; &#43;&#43;i) { int x = findfa(e[i].u), y = findfa(e[i].v); if(x == y) continue; ans &#43;= e[i].w; &#43;&#43;cnt; if(cnt == n-1) break; fa[x] = y; } } DINIC1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 bool bfs() { memset(d, -1, sizeof d); queue &lt;int&gt; q; q.push(s); d[s] = 0; while(!q.empty()) { int u = q.front(); q.pop(); for(int v, i = h[u]; ~i; i = e[i].next) if(d[v = e[i].to] == -1 &amp;&amp; e[i].w &gt; 0) d[v] = d[u] &#43; 1, q.push(v); } return d[t] != -1; } int dfs(int u, int f) { int r = 0; if(u == t) return f; for(int v, i = h[u]; ~i &amp;&amp; r &lt; f; i = e[i].next) if(d[(v = e[i].to)] == d[u] &#43; 1 &amp;&amp; e[i].w &gt; 0) { int x = dfs(v, min(e[i].w, f-r)); e[i].w -= x; e[i^1].w &#43;= x; r &#43;= x; } if(!r) d[u] = -1; return r; } int dinic() { int x, ans = 0; while(bfs()) while(x = dfs(s, 1e9)) ans &#43;= x; return ans; } 线性筛1 2 3 4 5 6 7 for(int i = 2; i &lt;= n; &#43;&#43;i) { if(!notp[i]) p[&#43;&#43;cntp] = i; for(int j = 1; 1ll*i*p[j] &lt;= n &amp;&amp; j &lt;= cntp; &#43;&#43;j) { notp[i*p[j]] = 1; if(i % p[j] == 0) break; } } 左偏树1 2 3 4 5 6 7 8 9 10 11 12 13 14 int F(int x) {return x == fa[x] ? x : fa[x] = F(fa[x]);} int Merge(int x, int y) { if(x*y == 0) return x&#43;y; if(v[x] &gt; v[y] || (v[x] == v[y] &amp;&amp; x &gt; y)) swap(x, y); R(x) = Merge(R(x), y); fa[R(x)] = fa[L(x)] = x; if(dis[R(x)] &gt; dis[L(x)]) swap(L(x), R(x)); dis[x] = dis[R(x)] &#43; 1; return x; } int Top(int x) {return del[x] ? -1 : v[x];} void Pop(int x) { if(del[x]) return; del[x] = 1; fa[L(x)] = L(x); fa[R(x)] = R(x); fa[x] = Merge(L(x), R(x)); } LCT1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 bool nroot(int x) {return ch[fa[x]][0] == x || ch[fa[x]][1] == x;} void pushup(int x) {sumx[x] = sumx[ch[x][1]] ^ sumx[ch[x][0]] ^ val[x];} void pushr(int x) {swap(ch[x][1], ch[x][0]); rot[x] ^= 1;} void pushdown(int x) {if(rot[x]) {if(ch[x][0]) pushr(ch[x][0]); if(ch[x][1]) pushr(ch[x][1]); rot[x] = 0;}} void rotate(int x) { int y = fa[x], z = fa[y], k = (x == ch[y][1]); if(nroot(y)) ch[z][(y == ch[z][1])] = x; fa[x] = z; ch[y][k] = ch[x][k^1]; if(ch[x][k^1]) fa[ch[x][k^1]] = y; ch[x][k^1] = y; fa[y] = x; pushup(y); } void splay(int x) { int y = x, z = 0; st[&#43;&#43;z] = y; while(nroot(y)) st[&#43;&#43;z] = y = fa[y]; while(z) pushdown(st[z--]); for(int y; nroot(x); rotate(x)) if(nroot(y = fa[x])) rotate((y == ch[fa[y]][0]) ^ (x == ch[y][0]) ? x : y); pushup(x); } void access(int x) {for(int y = 0; x; x = fa[y = x]) splay(x), ch[x][1] = y, pushup(x);} void makeroot(int x) {access(x); splay(x); pushr(x);} int findroot(int x) {access(x); splay(x); for(; ch[x][0]; x = ch[x][0]) pushdown(x); splay(x); return x;} void spilit(int x, int y) {makeroot(x); access(y); splay(y);} void link(int x, int y) {makeroot(x); if(findroot(y) != x) fa[x] = y;} void cut(int x, int y) {makeroot(x); if(findroot(y) == x &amp;&amp; fa[y] == x &amp;&amp; !ch[y][0]) {fa[y] = ch[x][1] = 0; pushup(x);}} KMP1 2 3 4 5 6 7 8 9 for(int i = 2, j = 0; i &lt;= n; &#43;&#43;i) { while(j &amp;&amp; s[i] != s[j&#43;1]) j = nxt[j]; if(s[j&#43;1] == s[i]) &#43;&#43;j; nxt[i] = j; } for(int i = 1, j = 0; i &lt;= m; &#43;&#43;i) { while(j &gt; 0 &amp;&amp; t[i] != s[j&#43;1]) j = nxt[j]; if(s[j&#43;1] == t[i]) &#43;&#43;j; if(j == n) printf(&#34;%d\n&#34;, i-n&#43;1); } SAM1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 struct SoumAsuMire { int ch[MAXN][26], fa[MAXN], last, cnt, len[MAXN]; void insert(int c) { int p = last, np = &#43;&#43;cnt; last = np; len[np] = len[p] &#43; 1; for(; p &amp;&amp; !ch[p][c]; ch[p][c] = np, p = fa[p]); if(!p) fa[np] = 1; else { int q = ch[p][c]; if(len[q] == len[p] &#43; 1) fa[np] = q; else { int nq = &#43;&#43;cnt; len[nq] = len[p] &#43; 1; memcpy(ch[nq], ch[q], sizeof ch[q]); fa[nq] = fa[q]; fa[q] = fa[np] = nq; for(; p &amp;&amp; ch[p][c] == q; ch[p][c] = nq, p = fa[p]); } } } void build(char *s) { int n = strlen(s&#43;1); last = 1; for(int i = 1; i &lt;= n; &#43;&#43;i) insert(s[i] - &#39;a&#39;); } int getans() { int ans = 0; for(int i = 2; i &lt;= cnt; &#43;&#43;i) ans &#43;= len[i] - len[fa[i]]; return ans; } } SAM; LCA(ST)1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 void dfsRMQ(int u, int p) { st[&#43;&#43;idx][0] = u; dfn[u] = idx; dep[u] = dep[p] &#43; 1; for(int v, i = h[u]; ~i; i = e[i].next) if((v = e[i].to) != p) dfsRMQ(v, u), st[&#43;&#43;idx][0] = u; } void LCAinit() { for(int i = 2; i &lt;= (n &lt;&lt; 1); &#43;&#43;i) lg2[i] = lg2[i&gt;&gt;1] &#43; 1; dep[1] = 1; dfsRMQ(rt, 0); for(int j = 1; j &lt; 20; &#43;&#43;j) for(int i = 1; i &#43; (1 &lt;&lt; j) &lt;= (n &lt;&lt; 1); &#43;&#43;i) st[i][j] = Min(st[i][j-1], st[i&#43;(1&lt;&lt;(j-1))][j-1]); } int LCA(int x, int y) { x = dfn[x]; y = dfn[y]; if(x &gt; y) swap(x, y); int k = lg2[y-x&#43;1]; return Min(st[x][k], st[y-(1&lt;&lt;k)&#43;1][k]); } mcmf1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 bool SPFA() { memset(d, 63, sizeof d); memset(vis, 0, sizeof vis); memset(flow, 63, sizeof flow); queue &lt;int&gt; q; q.push(s); d[s] = 0; vis[s] = 1; while(!q.empty()) { int u = q.front(); q.pop(); vis[u] = 0; for(int v, i = h[u]; ~i; i = e[i].next) if(d[v = e[i].to] &gt; d[u] &#43; e[i].c &amp;&amp; e[i].f) { d[v] = d[u] &#43; e[i].c; pos[v] = i; fa[v] = u; flow[v] = min(flow[u], e[i].f); if(!vis[v]) vis[v] = 1, q.push(v); } } return flow[s] != flow[t]; } void mcmf() { while(SPFA()) { mc &#43;= flow[t]; mf &#43;= flow[t] * d[t]; for(int u = t; u != s; u = fa[u]) e[pos[u]].f -= flow[t], e[pos[u]^1].f &#43;= flow[t]; } } AC自动机1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 #include &lt;bits/stdc&#43;&#43;.h&gt; using namespace std; const int S = 2000050, T = 200050; struct Edge {int to, next;} e[T]; char s[S]; int n, h[T], cnt, ch[T][26], fail[T], match[T], siz[T], tot = 1, en; queue &lt;int&gt; q; void addedge(int u, int v) {e[en] = (Edge) {v, h[u]}; h[u] = en&#43;&#43;;} void dfs(int u) { for(int v, i = h[u]; ~i; i = e[i].next) dfs(v = e[i].to), siz[u] &#43;= siz[v]; } int main() { scanf(&#34;%d&#34;, &amp;n); memset(h, -1, sizeof h); for(int i = 1; i &lt;= n; &#43;&#43;i) { scanf(&#34;%s&#34;, s); int u = 1, j; for(u = 1, j = 0; s[j]; &#43;&#43;j) { int c = s[j] - &#39;a&#39;; if(!ch[u][c]) ch[u][c] = &#43;&#43;tot; u = ch[u][c]; } match[i] = u; } for(int i = 0; i &lt; 26; &#43;&#43;i) ch[0][i] = 1; q.push(1); while(!q.empty()) { int u = q.front(); q.pop(); for(int i = 0; i &lt; 26; &#43;&#43;i) if(ch[u][i]) { fail[ch[u][i]] = ch[fail[u]][i]; q.push(ch[u][i]); } else ch[u][i] = ch[fail[u]][i]; } scanf(&#34;%s&#34;, s); for(int u = 1, i = 0; s[i]; &#43;&#43;i) &#43;&#43;siz[u = ch[u][s[i]-&#39;a&#39;]]; for(int i = 2; i &lt;= tot; &#43;&#43;i) addedge(fail[i], i); dfs(1); for(int i = 1; i &lt;= n; &#43;&#43;i) printf(&#34;%d\n&#34;, siz[match[i]]); puts(&#34;&#34;); } dijkstra1 2 3 4 5 6 7 8 9 10 11 12 13 void dijkstra() { memset(d, 0x3f, sizeof d); d[s] = 0; q.push((D) {s, 0}); while(!q.empty()) { int u = q.top().u; q.pop(); if(vis[u]) continue; vis[u] = 1; for(int v, i = h[u]; ~i; i = e[i].next) if(d[v = e[i].to] &gt; d[u] &#43; e[i].w) { d[v] = d[u] &#43; e[i].w; if(!vis[v]) q.push((D) {v, d[v]}); } } } 树哈希1 2 3 4 5 6 7 8 ull Hash(int u, int p) { ull q[MAXN], ans = X; int top = 0; for(int i = h[u]; ~i; i = e[i].next) if(e[i].to != p) q[&#43;&#43;top] = Hash(e[i].to, u); sort(q&#43;1, q&#43;top&#43;1); for(int i = 1; i &lt;= top; &#43;&#43;i) ans = ans * P &#43; q[i]; return ans * P &#43; X &#43; 1; } CDQ分治1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 struct BITS { int t[MAXN]; void U(int x, int k) {for(; x &lt;= m; t[x] &#43;= k, x &#43;= x&amp;-x);} int Q(int x) {int res = 0; for(; x; res &#43;= t[x], x -= x&amp;-x); return res;} } T; void cdq(int l, int r) { if(l == r) return; int mid = (l &#43; r) &gt;&gt; 1; cdq(l, mid); cdq(mid&#43;1, r); sort(a&#43;l, a&#43;mid&#43;1, cmpy); sort(a&#43;mid&#43;1, a&#43;r&#43;1, cmpy); int i = mid &#43; 1, j = l; for(; i &lt;= r; &#43;&#43;i) { for(; a[j].y &lt;= a[i].y &amp;&amp; j &lt;= mid; &#43;&#43;j) T.U(a[j].z, a[j].w); a[i].ans &#43;= T.Q(a[i].z); } for(int k = l; k &lt; j; &#43;&#43;k) T.U(a[k].z, -a[k].w); } int main() { read(_n); read(m); for(int i = 1; i &lt;= _n; &#43;&#43;i) read(b[i].x), read(b[i].y), read(b[i].z); sort(b&#43;1, b&#43;_n&#43;1, cmpx); for(int c = 0, i = 1; i &lt;= _n; &#43;&#43;i) { &#43;&#43;c; if(b[i].x != b[i&#43;1].x || b[i].y != b[i&#43;1].y || b[i].z != b[i&#43;1].z) a[&#43;&#43;n] = b[i], a[n].w = c, c = 0; } cdq(1, n); for(int i = 1; i &lt;= n; &#43;&#43;i) cnt[a[i].ans &#43; a[i].w - 1] &#43;= a[i].w; for(int i = 0; i &lt; _n; &#43;&#43;i) printf(&#34;%d\n&#34;, cnt[i]); } Lucas1 2 3 4 5 6 7 8 int C(int n, int m) { if(m &gt; n) return 0; return 1ll * fac[n] * power(fac[m], P-2) * power(fac[n-m], P-2); } int Lucas(int n, int m) { if(m == 0) return 1; return 1ll * C(n%P, m%P) * Lucas(n/P, m/P) % P; } 二分图1 2 3 4 5 6 7 8 9 10 bool dfs(int u) { for(int v, i = h[u]; ~i; i = e[i].next) { if(vis[v = e[i].to] != tag) { vis[v] = tag; if(!match[v] || dfs(match[v])) { match[v] = u; return 1; } } } return 0; } 莫队二次离线1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 #include &lt;bits/stdc&#43;&#43;.h&gt; using namespace std; const int MAXN = 100050; typedef long long lint; void read(int &amp;x) { char ch; while(ch = getchar(), ch &lt; &#39;!&#39;); x = ch - 48; while(ch = getchar(), ch &gt; &#39;!&#39;) x = (x &lt;&lt; 3) &#43; (x &lt;&lt; 1) &#43; ch - 48; } struct Qry {int l, r, id; lint ans;} q[MAXN]; struct T{int l, r, id;}; int n, m, a[MAXN], siz[MAXN], k, blsz, bl[MAXN], t[MAXN], pref[MAXN]; vector &lt;int&gt; buc; vector &lt;T&gt; v[MAXN]; lint ans[MAXN]; int cmp(Qry a, Qry b) {return bl[a.l] == bl[b.l] ? a.r &lt; b.r : a.l &lt; b.l;} int main() { read(n); read(m); read(k); blsz = sqrt(n); if(k &gt; 14) {for(int i = 1; i &lt;= m; &#43;&#43;i) puts(&#34;0&#34;); return 0;} for(int i = 1; i &lt;= n; &#43;&#43;i) read(a[i]); for(int i = 0; i &lt; 16384; &#43;&#43;i) if((siz[i] = siz[(i&gt;&gt;1)] &#43; (i&amp;1)) == k) buc.push_back(i); for(int i = 1; i &lt;= m; &#43;&#43;i) read(q[i].l), read(q[i].r), q[i].id = i; for(int i = 1; i &lt;= n; &#43;&#43;i) bl[i] = (i-1) / blsz &#43; 1; sort(q&#43;1, q&#43;m&#43;1, cmp); for(int i = 1; i &lt;= n; &#43;&#43;i) { for(int j = 0; j &lt; buc.size(); &#43;&#43;j) &#43;&#43;t[a[i]^buc[j]]; pref[i] = t[a[i&#43;1]]; } for(int L = 1, R = 0, i = 1; i &lt;= m; &#43;&#43;i) { int l = q[i].l, r = q[i].r; if(L &lt; l) v[R].push_back((T) {L, l-1, -i}); while(L &lt; l) {q[i].ans &#43;= pref[L-1]; &#43;&#43;L;} if(L &gt; l) v[R].push_back((T) {l, L-1, i}); while(L &gt; l) {q[i].ans -= pref[L-2]; --L;} if(R &lt; r) v[L-1].push_back((T) {R&#43;1, r, -i}); while(R &lt; r) {q[i].ans &#43;= pref[R]; &#43;&#43;R;} if(R &gt; r) v[L-1].push_back((T) {r&#43;1, R, i}); while(R &gt; r) {q[i].ans -= pref[R-1]; --R;} } memset(t, 0, sizeof t); for(int l, r, id, i = 1; i &lt;= n; &#43;&#43;i) { for(int j = 0; j &lt; buc.size(); &#43;&#43;j) &#43;&#43;t[a[i]^buc[j]]; for(int o = 0; o &lt; v[i].size(); &#43;&#43;o) { l = v[i][o].l; r = v[i][o].r; id = v[i][o].id; for(int j = l, tmp = 0; j &lt;= r; &#43;&#43;j) { tmp = t[a[j]]; if(j &lt;= i &amp;&amp; !k) --tmp; if(id &gt; 0) q[id].ans &#43;= tmp; else q[-id].ans -= tmp; } } } for(int i = 1; i &lt;= m; &#43;&#43;i) q[i].ans &#43;= q[i-1].ans; for(int i = 1; i &lt;= m; &#43;&#43;i) ans[q[i].id] = q[i].ans; for(int i = 1; i &lt;= m; &#43;&#43;i) printf(&#34;%lld\n&#34;, ans[i]); } 莫比乌斯反演1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 void GetMu() { mu[1] = 1; for(int i = 2; i &lt;= 10000000; &#43;&#43;i) { if(!vis[i]) p[&#43;&#43;cnt] = i, mu[i] = -1; for(int j = 1; j &lt;= cnt &amp;&amp; p[j] * i &lt;= 10000000; &#43;&#43;j) { vis[p[j]*i] = 1; if(i % p[j]) mu[p[j]*i] = -mu[i]; } } for(int i = 1; i &lt;= cnt; &#43;&#43;i) for(int j = 1; j * p[i] &lt;= 10000000; &#43;&#43;j) f[j*p[i]] &#43;= mu[j]; for(int i = 1; i &lt;= 10000000; &#43;&#43;i) pref[i] = pref[i-1] &#43; f[i]; } lint calc(int a, int b) { lint res = 0; if(a &gt; b) swap(a, b); for(int l = 1, r = 0; l &lt;= a; l = r &#43; 1) { r = min(a/(a/l), b/(b/l)); res &#43;= (pref[r] - pref[l-1])*1ll*(a/l)*(b/l); } return res; } 树剖1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 void ADD(int u, int l, int r, int k) {t[u] = (t[u] &#43; 1ll*k*(r-l&#43;1)%P) % P; tag[u] = (tag[u] &#43; k) % P;} void PD(int u, int l, int r) {ADD(L(u), l, mid, tag[u]); ADD(R(u), mid&#43;1, r, tag[u]); tag[u] = 0;} void PU(int u) {t[u] = (t[L(u)] &#43; t[R(u)]) % P;} void build(int u, int l, int r) { if(l == r) {t[u] = w[id[l]]; return; } build(L(u), l, mid); build(R(u), mid&#43;1, r); PU(u); } void upd(int u, int l, int r, int tl, int tr, int k) { if(tr &lt; l || tl &gt; r) return; if(tl &lt;= l &amp;&amp; r &lt;= tr) ADD(u, l, r, k); else PD(u, l, r), upd(L(u), l, mid, tl, tr, k), upd(R(u), mid&#43;1, r, tl, tr, k), PU(u); } int qry(int u, int l, int r, int tl, int tr) { if(tr &lt; l || tl &gt; r) return 0; if(tl &lt;= l &amp;&amp; r &lt;= tr) return t[u]; PD(u, l, r); return (qry(L(u), l, mid, tl, tr) &#43; qry(R(u), mid&#43;1, r, tl, tr)) % P; } void dfs1(int u, int p) { fa[u] = p; siz[u] = 1; dep[u] = dep[p] &#43; 1; for(int v, i = h[u]; ~i; i = e[i].next) if((v = e[i].to) != p) { dfs1(v, u); siz[u] &#43;= siz[v]; if(siz[son[u]] &lt; siz[v]) son[u] = v; } } void dfs2(int u, int p) { id[dfn[u] = &#43;&#43;idx] = u; top[u] = p; if(son[u]) dfs2(son[u], p); for(int v, i = h[u]; ~i; i = e[i].next) if((v = e[i].to) != fa[u] &amp;&amp; v != son[u]) dfs2(v, v); } void addpath(int x, int y, int k) { for(; top[x] != top[y]; x = fa[top[x]]) { if(dep[top[x]] &lt; dep[top[y]]) swap(x, y); upd(1, 1, n, dfn[top[x]], dfn[x], k); } if(dep[x] &gt; dep[y]) swap(x, y); upd(1, 1, n, dfn[x], dfn[y], k); } int qrypath(int x, int y) { int res = 0; for(; top[x] != top[y]; x = fa[top[x]]) { if(dep[top[x]] &lt; dep[top[y]]) swap(x, y); res = (res &#43; qry(1, 1, n, dfn[top[x]], dfn[x])) % P; } if(dep[x] &gt; dep[y]) swap(x, y); return (res &#43; qry(1, 1, n, dfn[x], dfn[y])) % P; } void addroot(int x, int k) {upd(1, 1, n, dfn[x], dfn[x] &#43; siz[x] - 1, k); } int qryroot(int x) {return qry(1, 1, n, dfn[x], dfn[x] &#43; siz[x] - 1);} 主席树1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 struct JZM_T {int ch[2], v;} t[MAXN &lt;&lt; 6]; int cnt, rt[MAXN &lt;&lt; 6], o[MAXN], a[MAXN], n, m; void build(int &amp;u, int l, int r) { t[u = &#43;&#43;cnt].v = 0; if(l != r) build(L(u), l, mid), build(R(u), mid&#43;1, r); } void update(int &amp;u, int v, int l, int r, int p, int k) { t[u = &#43;&#43;cnt] = t[v]; t[u].v &#43;= k; if(l != r) p &lt;= mid ? update(L(u), L(v), l, mid, p, k) : update(R(u), R(v), mid&#43;1, r, p, k); } int query(int tl, int tr, int l, int r, int k) { if(l == r) return o[l]; int s = t[L(tr)].v - t[L(tl)].v; return k &lt;= s ? query(L(tl), L(tr), l, mid, k) : query(R(tl), R(tr), mid&#43;1, r, k-s); } int main() { read(n); read(m); for(int i = 1; i &lt;= n; &#43;&#43;i) read(a[i]), o[i] = a[i]; sort(o&#43;1, o&#43;n&#43;1); int _n = unique(o&#43;1, o&#43;n&#43;1)-o-1; build(rt[0], 1, _n); for(int i = 1; i &lt;= n; &#43;&#43;i) update(rt[i], rt[i-1], 1, _n, lower_bound(o&#43;1, o&#43;_n&#43;1, a[i])-o, 1); for(int l, r, k; m--; ) { read(l); read(r); read(k); printf(&#34;%d\n&#34;, query(rt[l-1], rt[r], 1, _n, k)); } } GCD-BlackMagic1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 int gcd(int a, int b) { int g = 1; for(int tmp, i = 0; i &lt; 3; b /= tmp, g *= tmp, &#43;&#43;i) tmp = (k[a][i] &gt; siz) ? (b % k[a][i] == 0 ? k[a][i] : 1) : _gcd[k[a][i]][b%k[a][i]]; return g; } int main() { k[1][0] = k[1][1] = k[1][2] = 1; notp[1] = 1; for(int i = 2; i &lt;= V; &#43;&#43;i) { if(!notp[i]) p[&#43;&#43;cnt] = i, k[i][2] = i, k[i][1] = k[i][0] = 1; for(int j = 1; p[j] * i &lt;= V; &#43;&#43;j) { notp[i * p[j]] = 1; int *t = k[i*p[j]]; t[0] = k[i][0] * p[j]; t[1] = k[i][1]; t[2] = k[i][2]; if(t[1] &lt; t[0]) swap(t[0], t[1]); if(t[2] &lt; t[1]) swap(t[1], t[2]); if(i % p[j] == 0) break; } } for(int i = 1; i &lt;= siz; &#43;&#43;i) _gcd[i][0] = _gcd[0][i] = i; for(int _max = 1; _max &lt;= siz; &#43;&#43;_max) for(int i = 1; i &lt;= _max; &#43;&#43;i) _gcd[i][_max] = _gcd[_max][i] = _gcd[_max % i][i]; FFT1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 struct Complex { double x, y; Complex(double xx = 0, double yy = 0) {x = xx; y = yy;} Complex operator &#43; (Complex &amp;b) const {return Complex(x&#43;b.x, y&#43;b.y);} Complex operator - (Complex &amp;b) const {return Complex(x-b.x, y-b.y);} Complex operator * (Complex &amp;b) const {return Complex(x*b.x-y*b.y, y*b.x&#43;x*b.y);} } a[MAXN], b[MAXN]; int r[MAXN], n, m, l, limit; void FFT (Complex *A, int t) { for(int i = 0; i &lt; limit; &#43;&#43;i) if(i &lt; r[i]) swap(A[i], A[r[i]]); for(int mid = 1; mid &lt; limit; mid &lt;&lt;= 1) { Complex Wn = Complex(cos(Pi/mid), t * sin(Pi/mid)); for(int R = mid&lt;&lt;1, j = 0; j &lt; limit; j &#43;= R) { Complex w = Complex(1, 0); for(int k = 0; k &lt; mid; &#43;&#43;k, w = w * Wn) { Complex x = A[j&#43;k], y = w*A[j&#43;mid&#43;k]; A[j&#43;k] = x&#43;y; A[j&#43;mid&#43;k] = x-y; } } } } int main() { n = read(); m = read(); for(int i = 0; i &lt;= n; &#43;&#43;i) a[i].x = read(); for(int i = 0; i &lt;= m; &#43;&#43;i) b[i].x = read(); for(limit = 1; limit &lt;= n&#43;m; limit &lt;&lt;= 1, &#43;&#43;l); for(int i = 0; i &lt; limit; &#43;&#43;i) r[i] = (r[i&gt;&gt;1]&gt;&gt;1)|((i&amp;1)&lt;&lt;(l-1)); FFT(a, 1); FFT(b, 1); for(int i = 0; i &lt;= limit; &#43;&#43;i) a[i] = a[i]*b[i]; FFT(a, -1); for(int i = 0; i &lt;= n&#43;m; &#43;&#43;i) printf(&#34;%d &#34;, (int)(a[i].x/limit&#43;0.5)); puts(&#34;&#34;); } 多项式1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102 103 104 105 106 107 108 109 110 111 112 113 114 115 116 117 118 119 120 121 122 123 124 125 126 127 128 129 130 131 132 133 134 135 136 137 138 139 140 141 142 143 144 145 146 147 148 149 150 151 152 153 154 155 156 157 158 159 160 161 162 163 164 165 166 167 168 169 170 171 172 173 174 175 176 177 178 179 180 181 182 183 184 185 186 187 #include&lt;bits/stdc&#43;&#43;.h&gt; #define ll long long #define FIO &#34;loj150&#34; using namespace std; const int N=1e5&#43;5,MOD=998244353,P=19,INV2=MOD&#43;1&gt;&gt;1; inline int add(int a,const int &amp;b){if((a&#43;=b)&gt;=MOD)a-=MOD;return a;} inline int sub(int a,const int &amp;b){if((a-=b)&lt;	0)a&#43;=MOD;return a;} inline int mul(const int &amp;a,const int &amp;b){return 1ll*a*b%MOD;} inline void inc(int &amp;a,const int &amp;b=1){a=add(a,b);} inline void dec(int &amp;a,const int &amp;b=1){a=sub(a,b);} inline void pro(int &amp;a,const int &amp;b){a=mul(a,b);} inline int qpow(int a,int b){int c=1;for(;b;b&gt;&gt;=1,pro(a,a))if(b&amp;1)pro(c,a);return c;} int n,k,w[2][1&lt;&lt;P]; inline void pre(){ for(int i=1;i&lt;1&lt;&lt;P;i&lt;&lt;=1){ w[0][i]=w[1][i]=1; int wn1=qpow(3,(MOD-1)/(i&lt;&lt;1)),wn0=qpow(wn1,MOD-2); for(int j=1;j&lt;i;j&#43;&#43;) w[0][i&#43;j]=mul(w[0][i&#43;j-1],wn0),w[1][i&#43;j]=mul(w[1][i&#43;j-1],wn1); } } #define poly vector&lt;int&gt; inline void read(poly &amp;a,const int &amp;n){ a.resize(n); for(int i=0;i&lt;n;i&#43;&#43;)scanf(&#34;%d&#34;,&amp;a[i]); } inline void out(const poly &amp;a){ for(int i=0,n=a.size();i&lt;n;i&#43;&#43;)printf(&#34;%d%c&#34;,a[i],i^n-1?&#39; &#39;:&#39;\n&#39;); } inline void clear(poly &amp;a){ int n=a.size(); while(n&gt;1&amp;&amp;!a[n-1])n--; a.resize(n); } inline poly operator &#43;(poly a,const int &amp;b){inc(a[0],b);return a;} inline poly operator &#43;(const int &amp;b,poly a){inc(a[0],b);return a;} inline poly operator -(poly a,const int &amp;b){dec(a[0],b);return a;} inline poly operator -(const int &amp;b,poly a){dec(a[0],b);return a;} inline poly operator &#43;(poly a,const poly &amp;b){ if(a.size()&lt;b.size())a.resize(b.size()); for(int i=0,n=a.size();i&lt;n;i&#43;&#43;)inc(a[i],b[i]); return a; } inline poly operator -(poly a,const poly &amp;b){ if(a.size()&lt;b.size())a.resize(b.size()); for(int i=0,n=a.size();i&lt;n;i&#43;&#43;)dec(a[i],b[i]); return a; } inline void ntt(int *f,int opt,int l){ poly rev(l); for(int i=0;i&lt;l;i&#43;&#43;){rev[i]=(rev[i&gt;&gt;1]&gt;&gt;1)|((i&amp;1)*(l&gt;&gt;1));if(i&lt;rev[i])swap(f[i],f[rev[i]]);} for(int i=1;i&lt;l;i&lt;&lt;=1) for(int j=0;j&lt;l;j&#43;=i&lt;&lt;1) for(int k=0;k&lt;i;k&#43;&#43;){ int x=f[j&#43;k],y=mul(f[i&#43;j&#43;k],w[opt][i&#43;k]); f[j&#43;k]=add(x,y); f[i&#43;j&#43;k]=sub(x,y); } if(opt)for(int i=0,inv=qpow(l,MOD-2);i&lt;l;i&#43;&#43;)pro(f[i],inv); } inline poly operator *(poly a,poly b){ int n=a.size(),m=b.size(),l=1; while(l&lt;n&#43;m)l&lt;&lt;=1; a.resize(l);b.resize(l); ntt(&amp;a[0],0,l);ntt(&amp;b[0],0,l); for(int i=0;i&lt;l;i&#43;&#43;)pro(a[i],b[i]); ntt(&amp;a[0],1,l); clear(a); return a; } inline poly&amp; operator *=(poly &amp;a,const poly b){return a=a*b;} inline poly operator *(poly a,const int &amp;b){ for(int i=0,n=a.size();i&lt;n;i&#43;&#43;)pro(a[i],b); return a; } inline poly inv(const poly &amp;a,const int &amp;n){ if(n==1)return poly(1,qpow(a[0],MOD-2)); int l=1;while(l&lt;=n&lt;&lt;1)l&lt;&lt;=1; poly b=inv(a,n&#43;1&gt;&gt;1),c(l);b.resize(l); for(int i=0;i&lt;n;i&#43;&#43;)c[i]=a[i]; ntt(&amp;b[0],0,l);ntt(&amp;c[0],0,l); for(int i=0;i&lt;l;i&#43;&#43;)pro(b[i],sub(2,mul(b[i],c[i]))); ntt(&amp;b[0],1,l); b.resize(n); clear(b); return b; } inline poly inv(const poly &amp;a){return inv(a,a.size());} int B; #define pii pair&lt;int,int&gt; inline pii operator *(pii a,pii b){ return pii(add(mul(a.first,b.first),mul(mul(a.second,b.second),B)),add(mul(a.first,b.second),mul(a.second,b.first))); } inline pii qpow(pii a,int b){pii c=pii(1,0);for(;b;b&gt;&gt;=1,a=a*a)if(b&amp;1)c=c*a;return c;} inline int remain(int x){ if(x&lt;=1)return x; int a=mul(mul(rand(),rand()),rand()); while(qpow(B=sub(mul(a,a),x),MOD-1&gt;&gt;1)==1)a=mul(mul(rand(),rand()),rand()); pii A=pii(a,1),ans=qpow(A,MOD&#43;1&gt;&gt;1); return min(ans.first,MOD-ans.first); } inline poly sqrt(const poly &amp;a,const int &amp;n){ if(n==1)return poly(1,remain(a[0])); int l=1;while(l&lt;=n&lt;&lt;1)l&lt;&lt;=1; poly b=sqrt(a,n&#43;1&gt;&gt;1),c(l),d; b.resize(n);d=inv(b)*INV2; b.resize(l);d.resize(l); for(int i=0;i&lt;n;i&#43;&#43;)c[i]=a[i]; ntt(&amp;b[0],0,l);ntt(&amp;c[0],0,l);ntt(&amp;d[0],0,l); for(int i=0;i&lt;l;i&#43;&#43;)b[i]=mul(d[i],add(mul(b[i],b[i]),c[i])); ntt(&amp;b[0],1,l); b.resize(n); clear(b); return b; } inline poly sqrt(const poly &amp;a){return sqrt(a,a.size());} inline poly deri(poly a){ int n=a.size(); if(n==1)return poly(1,0); for(int i=0;i&lt;n;i&#43;&#43;)a[i]=mul(a[i&#43;1],i&#43;1); a.resize(n-1); return a; } inline poly inte(poly a){ int n=a.size(); a.resize(n&#43;1); for(int i=n;i;i--)a[i]=mul(a[i-1],qpow(i,MOD-2)); a[0]=0; return a; } inline poly ln(const poly &amp;a){ int n=a.size(); poly c=inv(a)*deri(a); c.resize(n-1); return inte(c); } inline poly exp(const poly &amp;a,const int &amp;n){ if(n==1)return poly(1,1); poly b=exp(a,n&#43;1&gt;&gt;1),c; b.resize(n);c=ln(b); for(int i=0;i&lt;n;i&#43;&#43;)c[i]=sub(a[i],c[i]); inc(c[0]); b*=c; b.resize(n); return b; } inline poly exp(const poly &amp;a){return exp(a,a.size());} inline poly qpow(poly a,const double &amp;b){return exp(ln(a)*b);} poly a; int main(){ srand(19260817); pre(); scanf(&#34;%d%d&#34;,&amp;n,&amp;k); read(a,1&#43;n); a=deri(qpow(1&#43;ln(2&#43;a-a[0]-exp(inte(inv(sqrt(a))))),k)); a.resize(n); out(a); return 0; } 珂朵莉树1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 //以防我忘了set迭代器怎么写 struct node { int l, r; mutable lint v; node(int L, int R = -1, lint V = 0) : l(L), r(R), v(V) {} bool operator &lt; (const node &amp;o) const { return l &lt; o.l; } }; set &lt;node&gt; s; IT spilit (int pos) { IT it = s.lower_bound(node(pos)); if(it != s.end() &amp;&amp; it-&gt;l == pos) return it; it--; int L = it -&gt; l, R = it -&gt; r; lint V = it-&gt;v; s.erase(it); s.insert(node(L, pos-1, V)); return s.insert(node(pos, R, V)).first; } void add(int l, int r, int val) { IT il = spilit(l), ir = spilit(r&#43;1); for(; il != ir; il-&gt;v &#43;= val, il&#43;&#43;); } void tp(int l, int r, int val = 0) { IT il = spilit(l), ir = spilit(r&#43;1); s.erase(il, ir); s.insert(node(l, r, val)); } ">
  <meta itemprop="name" content="板子 (ver.诗乃)">
  <meta itemprop="description" content="Tarjan&amp;Topo1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 void tarjan(int u) { dfn[u] = low[u] = &#43;&#43;tim; ins[u] = 1; stac[&#43;&#43;top] = u; for(int v, i = h[u]; ~i; i = e[i].next) if(!dfn[(v = e[i].to)]) { tarjan(v); low[u] = min(low[u], low[v]); } else if(ins[v]) low[u] = min(low[u], low[v]); if(low[u] == dfn[u]) { int y; while(y = stac[top--]) { sd[y] = u; ins[y] = 0; if(u == y) break; p[u] &#43;= p[y]; } } } void topo() { queue &lt;int&gt; q; for(int i = 1; i &lt;= n; &#43;&#43;i) if(sd[i] == i &amp;&amp; !in[i]) q.push(i), dis[i] = p[i]; while(!q.empty()) { int u = q.front(); q.pop(); for(int v, i = h[u]; ~i; i = e[i].next) { v = e[i].to; dis[v] = max(dis[v], dis[u] &#43; p[v]); --in[v]; if(!in[v]) q.push(v); } } int ans = 0; for(int i = 1; i &lt;= n; &#43;&#43;i) ans = max(ans, dis[i]); printf(&#34;%d\n&#34;, ans); } ST1 2 3 4 5 6 7 8 9 void ST_Build() { for(int j = 1; j &lt;= 21; &#43;&#43;j) for(int i = 1; i &#43; (1 &lt;&lt; j) - 1 &lt;= n; &#43;&#43;i) st[i][j] = max(st[i][j-1], st[i&#43;(1&lt;&lt;(j-1))][j-1]); } int ST_query(int l, int r) { int k = lg2[r-l&#43;1]; return max(st[l][k], st[r-(1&lt;&lt;k)&#43;1][k]); } ST-BlackMagic1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 struct RMQ { #define L(x) ((x-1)*siz&#43;1) #define R(x) std::min(n, x*siz&#43;1) #define bl(x) ((x-1)/siz&#43;1) const int MAXB = 2050, siz = 50; int prf[MAXN], suf[MAXN], n, st[MAXB][13], lg2[MAXN], a[MAXN]; void init(int *s, int _n, int k) { n = _n; for(int i = 1; i &lt;= n; &#43;&#43;i) a[i] = s[i] % k, st[bl(i)][0] = min(st[bl(i)][0], a[i]); for(int i = 1; i &lt;= bl(n); &#43;&#43;i) { prf[L(i)] = a[L(i)]; suf[R(i)] = a[R(i)]; for(int j = L(i)&#43;1; j &lt;= R(i); &#43;&#43;j) prf[j] = min(prf[j-1], a[j]); for(int j = R(i)-1; j &gt;= L(i); --j) suf[j] = min(suf[j&#43;1], a[j]); } for(int j = 1; j &lt;= 12; &#43;&#43;j) for(int i = 1; i &#43; (1 &lt;&lt; j) - 1 &lt;= bl(n); &#43;&#43;i) st[i][j] = min(st[i][j-1], st[i&#43;(1&lt;&lt;(j-1))][j-1]); } int QST(int l, int r) { if(l &gt; r) return 0; int k = lg2[r-l&#43;1]; return min(st[l][k], st[r-(1&lt;&lt;k)&#43;1][k]); } int query(int l, int r) { if(bl(l) == bl(r)) { int res = 0; for(int i = l; i &lt;= r; &#43;&#43;i) res = max(res, a[i]); return res; } else return min(min(prf[r], suf[l]), QST(bl(l)&#43;1, bl(r)-1)); } } ST; Manacher1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 void Manacher() { int mr = 0, mid; for(int i = 0; i &lt; n; &#43;&#43;i) { p[i] = i &lt; mr ? min(p[(mid &lt;&lt; 1) - i], p[mid] &#43; mid - i) : 1; for(; s[i-p[i]] == s[i&#43;p[i]]; &#43;&#43;p[i]); if(p[i] &#43; i &gt; mr) mr = i &#43; p[i], mid = i; } } int main() { scanf(&#34;%s&#34;, a); _n = strlen(a); s[0] = s[1] = &#39;#&#39;; n = 1; for(int i = 0; i &lt; _n; &#43;&#43;i) s[&#43;&#43;n] = a[i], s[&#43;&#43;n] = &#39;#&#39;; s[&#43;&#43;n] = 0; Manacher(); for(int i = 0; i &lt; n; &#43;&#43;i) ans = max(ans, p[i]); printf(&#34;%d\n&#34;, ans-1); } 线性基1 2 3 4 5 6 7 8 9 10 11 for(int i = 1; i &lt;= n; &#43;&#43;i) { read(a); for(int j = 50; j &gt;= 0; --j) { if((a &gt;&gt; j) &amp; 1) { if(!p[j]) {p[j] = a; break;} a ^= p[j]; } } } for(int i = 50; i &gt;= 0; --i) if(p[i]) ans = max(ans, ans ^ p[i]); 线性逆元1 2 3 inv[1] = 1; for(int i = 2; i &lt;= n; &#43;&#43;i) inv[i] = 1ll * (P - P / i) % P * inv[P % i]	% P; 后缀数组1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 void getSA() { for(int i = 1; i &lt;= n; &#43;&#43;i) &#43;&#43;c[x[i] = s[i]]; for(int i = 1; i &lt;= m; &#43;&#43;i) c[i] &#43;= c[i-1]; for(int i = n; i &gt;= 1; --i) sa[c[x[i]]--] = i; for(int k = 1; k &lt;= n; k &lt;&lt;= 1) { int num = 0; for(int i = n - k &#43; 1; i &lt;= n; &#43;&#43;i) y[&#43;&#43;num] = i; for(int i = 1; i &lt;= n; &#43;&#43;i) if(sa[i] &gt; k) y[&#43;&#43;num] = sa[i] - k; memset(c, 0, sizeof c); for(int i = 1; i &lt;= n; &#43;&#43;i) &#43;&#43;c[x[i]]; for(int i = 1; i &lt;= m; &#43;&#43;i) c[i] &#43;= c[i-1]; for(int i = n; i &gt;= 1; --i) sa[c[x[y[i]]]--] = y[i], y[i] = 0; swap(x, y); x[sa[1]] = 1; num = 0; for(int i = 1; i &lt;= n; &#43;&#43;i) x[sa[i]] = (y[sa[i-1]] == y[sa[i]] &amp;&amp; y[sa[i-1]&#43;k] == y[sa[i]&#43;k]) ? num : &#43;&#43;num; if(num == n) break; m = num; } } 点分治1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 void getroot(int u, int p, int S) { siz[u] = 1, f[u] = 0; for(int v, i = h[u]; ~i; i = e[i].next) if((v = e[i].to) != p &amp;&amp; !vis[v]) getroot(v, u, S), siz[u] &#43;= siz[v], f[u] = max(f[u], siz[v]); f[u] = max(f[u], S - siz[u]); rt = f[u] &lt; f[rt] ? u : rt; } void getdis(int u, int p) { stk[&#43;&#43;top] = dis[u]; for(int v, i = h[u]; ~i; i = e[i].next) if((v = e[i].to) != p &amp;&amp; !vis[v]) dis[v] = dis[u] &#43; e[i].w, getdis(v, u); } void solve(int u, int w, int t) { top = 0, dis[u] = w, getdis(u, 0); for(int i = 1; i &lt;= top; &#43;&#43;i) for(int j = 1; j &lt;= top; &#43;&#43;j) if(i != j) ans[stk[i] &#43; stk[j]] &#43;= t; } void devide(int u) { solve(u, 0, 1); vis[u] = 1; for(int v, i = h[u]; ~i; i = e[i].next) if(!vis[(v = e[i].to)]) { solve(v, e[i].w, -1), rt = 0, f[0] = n; getroot(v, u, siz[u]), devide(rt); } } 线段树1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 #define L(u) (u&lt;&lt;1) #define R(u) (u&lt;&lt;1|1) #define mid ((l&#43;r)&gt;&gt;1) void PU(int u) {t[u] = (t[L(u)] &#43; t[R(u)]) % P;} void ADD(int u, int l, int r, int k) { t[u] &#43;= (r - l &#43; 1) * k % P; t[u] %= P; add[u] = (add[u] &#43; k) % P; } void MUL(int u, int l, int r, int k) { t[u] = t[u] * k % P; add[u] = add[u] * k % P; mul[u] = mul[u] * k % P; } void PD(int u, int l, int r) { MUL(L(u), l, mid, mul[u]); MUL(R(u), mid&#43;1, r, mul[u]); mul[u] = 1; ADD(L(u), l, mid, add[u]); ADD(R(u), mid&#43;1, r, add[u]); add[u] = 0; } void build(int u, int l, int r) { mul[u] = 1; if(l == r) {t[u] = a[l]; return;} build(L(u), l, mid); build(R(u), mid&#43;1, r); PU(u); } void MA(int u, int l, int r, int tl, int tr, int k) { if(tr &lt; l || tl &gt; r) return; if(tl &lt;= l &amp;&amp; r &lt;= tr) {ADD(u, l, r, k); return;} PD(u, l, r); MA(L(u), l, mid, tl, tr, k); MA(R(u), mid&#43;1, r, tl, tr, k); PU(u); } void MM(int u, int l, int r, int tl, int tr, int k) { if(tr &lt; l || tl &gt; r) return; if(tl &lt;= l &amp;&amp; r &lt;= tr) {MUL(u, l, r, k); return;} PD(u, l, r); MM(L(u), l, mid, tl, tr, k); MM(R(u), mid&#43;1, r, tl, tr, k); PU(u); } int Q(int u, int l, int r, int tl, int tr) { if(tr &lt; l || tl &gt; r) return 0; if(tl &lt;= l &amp;&amp; r &lt;= tr) return t[u]; PD(u, l, r); return (Q(L(u), l, mid, tl, tr) &#43; Q(R(u), mid&#43;1, r, tl, tr)) % P; } 三分1 2 3 4 5 while(fabs(r-l) &gt;= eps) { double mid = (l &#43; r) / 2; if(f(mid - eps) &lt; f(mid &#43; eps)) l = mid; else r = mid; } 树状数组1 2 void U(int x, int k) {for(; x &lt;= n; t[x] &#43;= k, x &#43;= x&amp;-x);} int Q(int x) {int w = 0; for(; x; w &#43;= t[x], x -= x&amp;-x); return w;} 高斯消元1 2 3 4 5 6 7 8 9 10 11 12 13 for(int i = 1; i &lt;= n; &#43;&#43;i) { int p = i; for(int j = i &#43; 1; j &lt;= n; &#43;&#43;j) if(fabs(a[j][i]) &gt; fabs(a[p][i])) p = j; if(a[p][i] == 0) {puts(&#34;No Solution&#34;); return 0;} for(int j = 1; j &lt;= n&#43;1; &#43;&#43;j) swap(a[i][j], a[p][j]); for(int j = 1; j &lt;= n; &#43;&#43;j) { if(i == j) continue; double t = a[j][i] / a[i][i]; for(int k = i; k &lt;= n&#43;1; &#43;&#43;k) a[j][k] -= a[i][k] * t; } } for(int i = 1; i &lt;= n; &#43;&#43;i) printf(&#34;%.2lf\n&#34;, a[i][n&#43;1] / a[i][i]); 最小生成树&amp;并查集1 2 3 4 5 6 7 8 9 10 11 12 int findfa(int x) {return x == fa[x] ? x : fa[x] = findfa(fa[x]);} int main() { for(int i = 1; i &lt;= n; &#43;&#43;i) fa[i] = i; sort(e&#43;1, e&#43;m&#43;1); for(int i = 1; i &lt;= m; &#43;&#43;i) { int x = findfa(e[i].u), y = findfa(e[i].v); if(x == y) continue; ans &#43;= e[i].w; &#43;&#43;cnt; if(cnt == n-1) break; fa[x] = y; } } DINIC1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 bool bfs() { memset(d, -1, sizeof d); queue &lt;int&gt; q; q.push(s); d[s] = 0; while(!q.empty()) { int u = q.front(); q.pop(); for(int v, i = h[u]; ~i; i = e[i].next) if(d[v = e[i].to] == -1 &amp;&amp; e[i].w &gt; 0) d[v] = d[u] &#43; 1, q.push(v); } return d[t] != -1; } int dfs(int u, int f) { int r = 0; if(u == t) return f; for(int v, i = h[u]; ~i &amp;&amp; r &lt; f; i = e[i].next) if(d[(v = e[i].to)] == d[u] &#43; 1 &amp;&amp; e[i].w &gt; 0) { int x = dfs(v, min(e[i].w, f-r)); e[i].w -= x; e[i^1].w &#43;= x; r &#43;= x; } if(!r) d[u] = -1; return r; } int dinic() { int x, ans = 0; while(bfs()) while(x = dfs(s, 1e9)) ans &#43;= x; return ans; } 线性筛1 2 3 4 5 6 7 for(int i = 2; i &lt;= n; &#43;&#43;i) { if(!notp[i]) p[&#43;&#43;cntp] = i; for(int j = 1; 1ll*i*p[j] &lt;= n &amp;&amp; j &lt;= cntp; &#43;&#43;j) { notp[i*p[j]] = 1; if(i % p[j] == 0) break; } } 左偏树1 2 3 4 5 6 7 8 9 10 11 12 13 14 int F(int x) {return x == fa[x] ? x : fa[x] = F(fa[x]);} int Merge(int x, int y) { if(x*y == 0) return x&#43;y; if(v[x] &gt; v[y] || (v[x] == v[y] &amp;&amp; x &gt; y)) swap(x, y); R(x) = Merge(R(x), y); fa[R(x)] = fa[L(x)] = x; if(dis[R(x)] &gt; dis[L(x)]) swap(L(x), R(x)); dis[x] = dis[R(x)] &#43; 1; return x; } int Top(int x) {return del[x] ? -1 : v[x];} void Pop(int x) { if(del[x]) return; del[x] = 1; fa[L(x)] = L(x); fa[R(x)] = R(x); fa[x] = Merge(L(x), R(x)); } LCT1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 bool nroot(int x) {return ch[fa[x]][0] == x || ch[fa[x]][1] == x;} void pushup(int x) {sumx[x] = sumx[ch[x][1]] ^ sumx[ch[x][0]] ^ val[x];} void pushr(int x) {swap(ch[x][1], ch[x][0]); rot[x] ^= 1;} void pushdown(int x) {if(rot[x]) {if(ch[x][0]) pushr(ch[x][0]); if(ch[x][1]) pushr(ch[x][1]); rot[x] = 0;}} void rotate(int x) { int y = fa[x], z = fa[y], k = (x == ch[y][1]); if(nroot(y)) ch[z][(y == ch[z][1])] = x; fa[x] = z; ch[y][k] = ch[x][k^1]; if(ch[x][k^1]) fa[ch[x][k^1]] = y; ch[x][k^1] = y; fa[y] = x; pushup(y); } void splay(int x) { int y = x, z = 0; st[&#43;&#43;z] = y; while(nroot(y)) st[&#43;&#43;z] = y = fa[y]; while(z) pushdown(st[z--]); for(int y; nroot(x); rotate(x)) if(nroot(y = fa[x])) rotate((y == ch[fa[y]][0]) ^ (x == ch[y][0]) ? x : y); pushup(x); } void access(int x) {for(int y = 0; x; x = fa[y = x]) splay(x), ch[x][1] = y, pushup(x);} void makeroot(int x) {access(x); splay(x); pushr(x);} int findroot(int x) {access(x); splay(x); for(; ch[x][0]; x = ch[x][0]) pushdown(x); splay(x); return x;} void spilit(int x, int y) {makeroot(x); access(y); splay(y);} void link(int x, int y) {makeroot(x); if(findroot(y) != x) fa[x] = y;} void cut(int x, int y) {makeroot(x); if(findroot(y) == x &amp;&amp; fa[y] == x &amp;&amp; !ch[y][0]) {fa[y] = ch[x][1] = 0; pushup(x);}} KMP1 2 3 4 5 6 7 8 9 for(int i = 2, j = 0; i &lt;= n; &#43;&#43;i) { while(j &amp;&amp; s[i] != s[j&#43;1]) j = nxt[j]; if(s[j&#43;1] == s[i]) &#43;&#43;j; nxt[i] = j; } for(int i = 1, j = 0; i &lt;= m; &#43;&#43;i) { while(j &gt; 0 &amp;&amp; t[i] != s[j&#43;1]) j = nxt[j]; if(s[j&#43;1] == t[i]) &#43;&#43;j; if(j == n) printf(&#34;%d\n&#34;, i-n&#43;1); } SAM1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 struct SoumAsuMire { int ch[MAXN][26], fa[MAXN], last, cnt, len[MAXN]; void insert(int c) { int p = last, np = &#43;&#43;cnt; last = np; len[np] = len[p] &#43; 1; for(; p &amp;&amp; !ch[p][c]; ch[p][c] = np, p = fa[p]); if(!p) fa[np] = 1; else { int q = ch[p][c]; if(len[q] == len[p] &#43; 1) fa[np] = q; else { int nq = &#43;&#43;cnt; len[nq] = len[p] &#43; 1; memcpy(ch[nq], ch[q], sizeof ch[q]); fa[nq] = fa[q]; fa[q] = fa[np] = nq; for(; p &amp;&amp; ch[p][c] == q; ch[p][c] = nq, p = fa[p]); } } } void build(char *s) { int n = strlen(s&#43;1); last = 1; for(int i = 1; i &lt;= n; &#43;&#43;i) insert(s[i] - &#39;a&#39;); } int getans() { int ans = 0; for(int i = 2; i &lt;= cnt; &#43;&#43;i) ans &#43;= len[i] - len[fa[i]]; return ans; } } SAM; LCA(ST)1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 void dfsRMQ(int u, int p) { st[&#43;&#43;idx][0] = u; dfn[u] = idx; dep[u] = dep[p] &#43; 1; for(int v, i = h[u]; ~i; i = e[i].next) if((v = e[i].to) != p) dfsRMQ(v, u), st[&#43;&#43;idx][0] = u; } void LCAinit() { for(int i = 2; i &lt;= (n &lt;&lt; 1); &#43;&#43;i) lg2[i] = lg2[i&gt;&gt;1] &#43; 1; dep[1] = 1; dfsRMQ(rt, 0); for(int j = 1; j &lt; 20; &#43;&#43;j) for(int i = 1; i &#43; (1 &lt;&lt; j) &lt;= (n &lt;&lt; 1); &#43;&#43;i) st[i][j] = Min(st[i][j-1], st[i&#43;(1&lt;&lt;(j-1))][j-1]); } int LCA(int x, int y) { x = dfn[x]; y = dfn[y]; if(x &gt; y) swap(x, y); int k = lg2[y-x&#43;1]; return Min(st[x][k], st[y-(1&lt;&lt;k)&#43;1][k]); } mcmf1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 bool SPFA() { memset(d, 63, sizeof d); memset(vis, 0, sizeof vis); memset(flow, 63, sizeof flow); queue &lt;int&gt; q; q.push(s); d[s] = 0; vis[s] = 1; while(!q.empty()) { int u = q.front(); q.pop(); vis[u] = 0; for(int v, i = h[u]; ~i; i = e[i].next) if(d[v = e[i].to] &gt; d[u] &#43; e[i].c &amp;&amp; e[i].f) { d[v] = d[u] &#43; e[i].c; pos[v] = i; fa[v] = u; flow[v] = min(flow[u], e[i].f); if(!vis[v]) vis[v] = 1, q.push(v); } } return flow[s] != flow[t]; } void mcmf() { while(SPFA()) { mc &#43;= flow[t]; mf &#43;= flow[t] * d[t]; for(int u = t; u != s; u = fa[u]) e[pos[u]].f -= flow[t], e[pos[u]^1].f &#43;= flow[t]; } } AC自动机1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 #include &lt;bits/stdc&#43;&#43;.h&gt; using namespace std; const int S = 2000050, T = 200050; struct Edge {int to, next;} e[T]; char s[S]; int n, h[T], cnt, ch[T][26], fail[T], match[T], siz[T], tot = 1, en; queue &lt;int&gt; q; void addedge(int u, int v) {e[en] = (Edge) {v, h[u]}; h[u] = en&#43;&#43;;} void dfs(int u) { for(int v, i = h[u]; ~i; i = e[i].next) dfs(v = e[i].to), siz[u] &#43;= siz[v]; } int main() { scanf(&#34;%d&#34;, &amp;n); memset(h, -1, sizeof h); for(int i = 1; i &lt;= n; &#43;&#43;i) { scanf(&#34;%s&#34;, s); int u = 1, j; for(u = 1, j = 0; s[j]; &#43;&#43;j) { int c = s[j] - &#39;a&#39;; if(!ch[u][c]) ch[u][c] = &#43;&#43;tot; u = ch[u][c]; } match[i] = u; } for(int i = 0; i &lt; 26; &#43;&#43;i) ch[0][i] = 1; q.push(1); while(!q.empty()) { int u = q.front(); q.pop(); for(int i = 0; i &lt; 26; &#43;&#43;i) if(ch[u][i]) { fail[ch[u][i]] = ch[fail[u]][i]; q.push(ch[u][i]); } else ch[u][i] = ch[fail[u]][i]; } scanf(&#34;%s&#34;, s); for(int u = 1, i = 0; s[i]; &#43;&#43;i) &#43;&#43;siz[u = ch[u][s[i]-&#39;a&#39;]]; for(int i = 2; i &lt;= tot; &#43;&#43;i) addedge(fail[i], i); dfs(1); for(int i = 1; i &lt;= n; &#43;&#43;i) printf(&#34;%d\n&#34;, siz[match[i]]); puts(&#34;&#34;); } dijkstra1 2 3 4 5 6 7 8 9 10 11 12 13 void dijkstra() { memset(d, 0x3f, sizeof d); d[s] = 0; q.push((D) {s, 0}); while(!q.empty()) { int u = q.top().u; q.pop(); if(vis[u]) continue; vis[u] = 1; for(int v, i = h[u]; ~i; i = e[i].next) if(d[v = e[i].to] &gt; d[u] &#43; e[i].w) { d[v] = d[u] &#43; e[i].w; if(!vis[v]) q.push((D) {v, d[v]}); } } } 树哈希1 2 3 4 5 6 7 8 ull Hash(int u, int p) { ull q[MAXN], ans = X; int top = 0; for(int i = h[u]; ~i; i = e[i].next) if(e[i].to != p) q[&#43;&#43;top] = Hash(e[i].to, u); sort(q&#43;1, q&#43;top&#43;1); for(int i = 1; i &lt;= top; &#43;&#43;i) ans = ans * P &#43; q[i]; return ans * P &#43; X &#43; 1; } CDQ分治1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 struct BITS { int t[MAXN]; void U(int x, int k) {for(; x &lt;= m; t[x] &#43;= k, x &#43;= x&amp;-x);} int Q(int x) {int res = 0; for(; x; res &#43;= t[x], x -= x&amp;-x); return res;} } T; void cdq(int l, int r) { if(l == r) return; int mid = (l &#43; r) &gt;&gt; 1; cdq(l, mid); cdq(mid&#43;1, r); sort(a&#43;l, a&#43;mid&#43;1, cmpy); sort(a&#43;mid&#43;1, a&#43;r&#43;1, cmpy); int i = mid &#43; 1, j = l; for(; i &lt;= r; &#43;&#43;i) { for(; a[j].y &lt;= a[i].y &amp;&amp; j &lt;= mid; &#43;&#43;j) T.U(a[j].z, a[j].w); a[i].ans &#43;= T.Q(a[i].z); } for(int k = l; k &lt; j; &#43;&#43;k) T.U(a[k].z, -a[k].w); } int main() { read(_n); read(m); for(int i = 1; i &lt;= _n; &#43;&#43;i) read(b[i].x), read(b[i].y), read(b[i].z); sort(b&#43;1, b&#43;_n&#43;1, cmpx); for(int c = 0, i = 1; i &lt;= _n; &#43;&#43;i) { &#43;&#43;c; if(b[i].x != b[i&#43;1].x || b[i].y != b[i&#43;1].y || b[i].z != b[i&#43;1].z) a[&#43;&#43;n] = b[i], a[n].w = c, c = 0; } cdq(1, n); for(int i = 1; i &lt;= n; &#43;&#43;i) cnt[a[i].ans &#43; a[i].w - 1] &#43;= a[i].w; for(int i = 0; i &lt; _n; &#43;&#43;i) printf(&#34;%d\n&#34;, cnt[i]); } Lucas1 2 3 4 5 6 7 8 int C(int n, int m) { if(m &gt; n) return 0; return 1ll * fac[n] * power(fac[m], P-2) * power(fac[n-m], P-2); } int Lucas(int n, int m) { if(m == 0) return 1; return 1ll * C(n%P, m%P) * Lucas(n/P, m/P) % P; } 二分图1 2 3 4 5 6 7 8 9 10 bool dfs(int u) { for(int v, i = h[u]; ~i; i = e[i].next) { if(vis[v = e[i].to] != tag) { vis[v] = tag; if(!match[v] || dfs(match[v])) { match[v] = u; return 1; } } } return 0; } 莫队二次离线1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 #include &lt;bits/stdc&#43;&#43;.h&gt; using namespace std; const int MAXN = 100050; typedef long long lint; void read(int &amp;x) { char ch; while(ch = getchar(), ch &lt; &#39;!&#39;); x = ch - 48; while(ch = getchar(), ch &gt; &#39;!&#39;) x = (x &lt;&lt; 3) &#43; (x &lt;&lt; 1) &#43; ch - 48; } struct Qry {int l, r, id; lint ans;} q[MAXN]; struct T{int l, r, id;}; int n, m, a[MAXN], siz[MAXN], k, blsz, bl[MAXN], t[MAXN], pref[MAXN]; vector &lt;int&gt; buc; vector &lt;T&gt; v[MAXN]; lint ans[MAXN]; int cmp(Qry a, Qry b) {return bl[a.l] == bl[b.l] ? a.r &lt; b.r : a.l &lt; b.l;} int main() { read(n); read(m); read(k); blsz = sqrt(n); if(k &gt; 14) {for(int i = 1; i &lt;= m; &#43;&#43;i) puts(&#34;0&#34;); return 0;} for(int i = 1; i &lt;= n; &#43;&#43;i) read(a[i]); for(int i = 0; i &lt; 16384; &#43;&#43;i) if((siz[i] = siz[(i&gt;&gt;1)] &#43; (i&amp;1)) == k) buc.push_back(i); for(int i = 1; i &lt;= m; &#43;&#43;i) read(q[i].l), read(q[i].r), q[i].id = i; for(int i = 1; i &lt;= n; &#43;&#43;i) bl[i] = (i-1) / blsz &#43; 1; sort(q&#43;1, q&#43;m&#43;1, cmp); for(int i = 1; i &lt;= n; &#43;&#43;i) { for(int j = 0; j &lt; buc.size(); &#43;&#43;j) &#43;&#43;t[a[i]^buc[j]]; pref[i] = t[a[i&#43;1]]; } for(int L = 1, R = 0, i = 1; i &lt;= m; &#43;&#43;i) { int l = q[i].l, r = q[i].r; if(L &lt; l) v[R].push_back((T) {L, l-1, -i}); while(L &lt; l) {q[i].ans &#43;= pref[L-1]; &#43;&#43;L;} if(L &gt; l) v[R].push_back((T) {l, L-1, i}); while(L &gt; l) {q[i].ans -= pref[L-2]; --L;} if(R &lt; r) v[L-1].push_back((T) {R&#43;1, r, -i}); while(R &lt; r) {q[i].ans &#43;= pref[R]; &#43;&#43;R;} if(R &gt; r) v[L-1].push_back((T) {r&#43;1, R, i}); while(R &gt; r) {q[i].ans -= pref[R-1]; --R;} } memset(t, 0, sizeof t); for(int l, r, id, i = 1; i &lt;= n; &#43;&#43;i) { for(int j = 0; j &lt; buc.size(); &#43;&#43;j) &#43;&#43;t[a[i]^buc[j]]; for(int o = 0; o &lt; v[i].size(); &#43;&#43;o) { l = v[i][o].l; r = v[i][o].r; id = v[i][o].id; for(int j = l, tmp = 0; j &lt;= r; &#43;&#43;j) { tmp = t[a[j]]; if(j &lt;= i &amp;&amp; !k) --tmp; if(id &gt; 0) q[id].ans &#43;= tmp; else q[-id].ans -= tmp; } } } for(int i = 1; i &lt;= m; &#43;&#43;i) q[i].ans &#43;= q[i-1].ans; for(int i = 1; i &lt;= m; &#43;&#43;i) ans[q[i].id] = q[i].ans; for(int i = 1; i &lt;= m; &#43;&#43;i) printf(&#34;%lld\n&#34;, ans[i]); } 莫比乌斯反演1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 void GetMu() { mu[1] = 1; for(int i = 2; i &lt;= 10000000; &#43;&#43;i) { if(!vis[i]) p[&#43;&#43;cnt] = i, mu[i] = -1; for(int j = 1; j &lt;= cnt &amp;&amp; p[j] * i &lt;= 10000000; &#43;&#43;j) { vis[p[j]*i] = 1; if(i % p[j]) mu[p[j]*i] = -mu[i]; } } for(int i = 1; i &lt;= cnt; &#43;&#43;i) for(int j = 1; j * p[i] &lt;= 10000000; &#43;&#43;j) f[j*p[i]] &#43;= mu[j]; for(int i = 1; i &lt;= 10000000; &#43;&#43;i) pref[i] = pref[i-1] &#43; f[i]; } lint calc(int a, int b) { lint res = 0; if(a &gt; b) swap(a, b); for(int l = 1, r = 0; l &lt;= a; l = r &#43; 1) { r = min(a/(a/l), b/(b/l)); res &#43;= (pref[r] - pref[l-1])*1ll*(a/l)*(b/l); } return res; } 树剖1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 void ADD(int u, int l, int r, int k) {t[u] = (t[u] &#43; 1ll*k*(r-l&#43;1)%P) % P; tag[u] = (tag[u] &#43; k) % P;} void PD(int u, int l, int r) {ADD(L(u), l, mid, tag[u]); ADD(R(u), mid&#43;1, r, tag[u]); tag[u] = 0;} void PU(int u) {t[u] = (t[L(u)] &#43; t[R(u)]) % P;} void build(int u, int l, int r) { if(l == r) {t[u] = w[id[l]]; return; } build(L(u), l, mid); build(R(u), mid&#43;1, r); PU(u); } void upd(int u, int l, int r, int tl, int tr, int k) { if(tr &lt; l || tl &gt; r) return; if(tl &lt;= l &amp;&amp; r &lt;= tr) ADD(u, l, r, k); else PD(u, l, r), upd(L(u), l, mid, tl, tr, k), upd(R(u), mid&#43;1, r, tl, tr, k), PU(u); } int qry(int u, int l, int r, int tl, int tr) { if(tr &lt; l || tl &gt; r) return 0; if(tl &lt;= l &amp;&amp; r &lt;= tr) return t[u]; PD(u, l, r); return (qry(L(u), l, mid, tl, tr) &#43; qry(R(u), mid&#43;1, r, tl, tr)) % P; } void dfs1(int u, int p) { fa[u] = p; siz[u] = 1; dep[u] = dep[p] &#43; 1; for(int v, i = h[u]; ~i; i = e[i].next) if((v = e[i].to) != p) { dfs1(v, u); siz[u] &#43;= siz[v]; if(siz[son[u]] &lt; siz[v]) son[u] = v; } } void dfs2(int u, int p) { id[dfn[u] = &#43;&#43;idx] = u; top[u] = p; if(son[u]) dfs2(son[u], p); for(int v, i = h[u]; ~i; i = e[i].next) if((v = e[i].to) != fa[u] &amp;&amp; v != son[u]) dfs2(v, v); } void addpath(int x, int y, int k) { for(; top[x] != top[y]; x = fa[top[x]]) { if(dep[top[x]] &lt; dep[top[y]]) swap(x, y); upd(1, 1, n, dfn[top[x]], dfn[x], k); } if(dep[x] &gt; dep[y]) swap(x, y); upd(1, 1, n, dfn[x], dfn[y], k); } int qrypath(int x, int y) { int res = 0; for(; top[x] != top[y]; x = fa[top[x]]) { if(dep[top[x]] &lt; dep[top[y]]) swap(x, y); res = (res &#43; qry(1, 1, n, dfn[top[x]], dfn[x])) % P; } if(dep[x] &gt; dep[y]) swap(x, y); return (res &#43; qry(1, 1, n, dfn[x], dfn[y])) % P; } void addroot(int x, int k) {upd(1, 1, n, dfn[x], dfn[x] &#43; siz[x] - 1, k); } int qryroot(int x) {return qry(1, 1, n, dfn[x], dfn[x] &#43; siz[x] - 1);} 主席树1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 struct JZM_T {int ch[2], v;} t[MAXN &lt;&lt; 6]; int cnt, rt[MAXN &lt;&lt; 6], o[MAXN], a[MAXN], n, m; void build(int &amp;u, int l, int r) { t[u = &#43;&#43;cnt].v = 0; if(l != r) build(L(u), l, mid), build(R(u), mid&#43;1, r); } void update(int &amp;u, int v, int l, int r, int p, int k) { t[u = &#43;&#43;cnt] = t[v]; t[u].v &#43;= k; if(l != r) p &lt;= mid ? update(L(u), L(v), l, mid, p, k) : update(R(u), R(v), mid&#43;1, r, p, k); } int query(int tl, int tr, int l, int r, int k) { if(l == r) return o[l]; int s = t[L(tr)].v - t[L(tl)].v; return k &lt;= s ? query(L(tl), L(tr), l, mid, k) : query(R(tl), R(tr), mid&#43;1, r, k-s); } int main() { read(n); read(m); for(int i = 1; i &lt;= n; &#43;&#43;i) read(a[i]), o[i] = a[i]; sort(o&#43;1, o&#43;n&#43;1); int _n = unique(o&#43;1, o&#43;n&#43;1)-o-1; build(rt[0], 1, _n); for(int i = 1; i &lt;= n; &#43;&#43;i) update(rt[i], rt[i-1], 1, _n, lower_bound(o&#43;1, o&#43;_n&#43;1, a[i])-o, 1); for(int l, r, k; m--; ) { read(l); read(r); read(k); printf(&#34;%d\n&#34;, query(rt[l-1], rt[r], 1, _n, k)); } } GCD-BlackMagic1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 int gcd(int a, int b) { int g = 1; for(int tmp, i = 0; i &lt; 3; b /= tmp, g *= tmp, &#43;&#43;i) tmp = (k[a][i] &gt; siz) ? (b % k[a][i] == 0 ? k[a][i] : 1) : _gcd[k[a][i]][b%k[a][i]]; return g; } int main() { k[1][0] = k[1][1] = k[1][2] = 1; notp[1] = 1; for(int i = 2; i &lt;= V; &#43;&#43;i) { if(!notp[i]) p[&#43;&#43;cnt] = i, k[i][2] = i, k[i][1] = k[i][0] = 1; for(int j = 1; p[j] * i &lt;= V; &#43;&#43;j) { notp[i * p[j]] = 1; int *t = k[i*p[j]]; t[0] = k[i][0] * p[j]; t[1] = k[i][1]; t[2] = k[i][2]; if(t[1] &lt; t[0]) swap(t[0], t[1]); if(t[2] &lt; t[1]) swap(t[1], t[2]); if(i % p[j] == 0) break; } } for(int i = 1; i &lt;= siz; &#43;&#43;i) _gcd[i][0] = _gcd[0][i] = i; for(int _max = 1; _max &lt;= siz; &#43;&#43;_max) for(int i = 1; i &lt;= _max; &#43;&#43;i) _gcd[i][_max] = _gcd[_max][i] = _gcd[_max % i][i]; FFT1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 struct Complex { double x, y; Complex(double xx = 0, double yy = 0) {x = xx; y = yy;} Complex operator &#43; (Complex &amp;b) const {return Complex(x&#43;b.x, y&#43;b.y);} Complex operator - (Complex &amp;b) const {return Complex(x-b.x, y-b.y);} Complex operator * (Complex &amp;b) const {return Complex(x*b.x-y*b.y, y*b.x&#43;x*b.y);} } a[MAXN], b[MAXN]; int r[MAXN], n, m, l, limit; void FFT (Complex *A, int t) { for(int i = 0; i &lt; limit; &#43;&#43;i) if(i &lt; r[i]) swap(A[i], A[r[i]]); for(int mid = 1; mid &lt; limit; mid &lt;&lt;= 1) { Complex Wn = Complex(cos(Pi/mid), t * sin(Pi/mid)); for(int R = mid&lt;&lt;1, j = 0; j &lt; limit; j &#43;= R) { Complex w = Complex(1, 0); for(int k = 0; k &lt; mid; &#43;&#43;k, w = w * Wn) { Complex x = A[j&#43;k], y = w*A[j&#43;mid&#43;k]; A[j&#43;k] = x&#43;y; A[j&#43;mid&#43;k] = x-y; } } } } int main() { n = read(); m = read(); for(int i = 0; i &lt;= n; &#43;&#43;i) a[i].x = read(); for(int i = 0; i &lt;= m; &#43;&#43;i) b[i].x = read(); for(limit = 1; limit &lt;= n&#43;m; limit &lt;&lt;= 1, &#43;&#43;l); for(int i = 0; i &lt; limit; &#43;&#43;i) r[i] = (r[i&gt;&gt;1]&gt;&gt;1)|((i&amp;1)&lt;&lt;(l-1)); FFT(a, 1); FFT(b, 1); for(int i = 0; i &lt;= limit; &#43;&#43;i) a[i] = a[i]*b[i]; FFT(a, -1); for(int i = 0; i &lt;= n&#43;m; &#43;&#43;i) printf(&#34;%d &#34;, (int)(a[i].x/limit&#43;0.5)); puts(&#34;&#34;); } 多项式1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102 103 104 105 106 107 108 109 110 111 112 113 114 115 116 117 118 119 120 121 122 123 124 125 126 127 128 129 130 131 132 133 134 135 136 137 138 139 140 141 142 143 144 145 146 147 148 149 150 151 152 153 154 155 156 157 158 159 160 161 162 163 164 165 166 167 168 169 170 171 172 173 174 175 176 177 178 179 180 181 182 183 184 185 186 187 #include&lt;bits/stdc&#43;&#43;.h&gt; #define ll long long #define FIO &#34;loj150&#34; using namespace std; const int N=1e5&#43;5,MOD=998244353,P=19,INV2=MOD&#43;1&gt;&gt;1; inline int add(int a,const int &amp;b){if((a&#43;=b)&gt;=MOD)a-=MOD;return a;} inline int sub(int a,const int &amp;b){if((a-=b)&lt;	0)a&#43;=MOD;return a;} inline int mul(const int &amp;a,const int &amp;b){return 1ll*a*b%MOD;} inline void inc(int &amp;a,const int &amp;b=1){a=add(a,b);} inline void dec(int &amp;a,const int &amp;b=1){a=sub(a,b);} inline void pro(int &amp;a,const int &amp;b){a=mul(a,b);} inline int qpow(int a,int b){int c=1;for(;b;b&gt;&gt;=1,pro(a,a))if(b&amp;1)pro(c,a);return c;} int n,k,w[2][1&lt;&lt;P]; inline void pre(){ for(int i=1;i&lt;1&lt;&lt;P;i&lt;&lt;=1){ w[0][i]=w[1][i]=1; int wn1=qpow(3,(MOD-1)/(i&lt;&lt;1)),wn0=qpow(wn1,MOD-2); for(int j=1;j&lt;i;j&#43;&#43;) w[0][i&#43;j]=mul(w[0][i&#43;j-1],wn0),w[1][i&#43;j]=mul(w[1][i&#43;j-1],wn1); } } #define poly vector&lt;int&gt; inline void read(poly &amp;a,const int &amp;n){ a.resize(n); for(int i=0;i&lt;n;i&#43;&#43;)scanf(&#34;%d&#34;,&amp;a[i]); } inline void out(const poly &amp;a){ for(int i=0,n=a.size();i&lt;n;i&#43;&#43;)printf(&#34;%d%c&#34;,a[i],i^n-1?&#39; &#39;:&#39;\n&#39;); } inline void clear(poly &amp;a){ int n=a.size(); while(n&gt;1&amp;&amp;!a[n-1])n--; a.resize(n); } inline poly operator &#43;(poly a,const int &amp;b){inc(a[0],b);return a;} inline poly operator &#43;(const int &amp;b,poly a){inc(a[0],b);return a;} inline poly operator -(poly a,const int &amp;b){dec(a[0],b);return a;} inline poly operator -(const int &amp;b,poly a){dec(a[0],b);return a;} inline poly operator &#43;(poly a,const poly &amp;b){ if(a.size()&lt;b.size())a.resize(b.size()); for(int i=0,n=a.size();i&lt;n;i&#43;&#43;)inc(a[i],b[i]); return a; } inline poly operator -(poly a,const poly &amp;b){ if(a.size()&lt;b.size())a.resize(b.size()); for(int i=0,n=a.size();i&lt;n;i&#43;&#43;)dec(a[i],b[i]); return a; } inline void ntt(int *f,int opt,int l){ poly rev(l); for(int i=0;i&lt;l;i&#43;&#43;){rev[i]=(rev[i&gt;&gt;1]&gt;&gt;1)|((i&amp;1)*(l&gt;&gt;1));if(i&lt;rev[i])swap(f[i],f[rev[i]]);} for(int i=1;i&lt;l;i&lt;&lt;=1) for(int j=0;j&lt;l;j&#43;=i&lt;&lt;1) for(int k=0;k&lt;i;k&#43;&#43;){ int x=f[j&#43;k],y=mul(f[i&#43;j&#43;k],w[opt][i&#43;k]); f[j&#43;k]=add(x,y); f[i&#43;j&#43;k]=sub(x,y); } if(opt)for(int i=0,inv=qpow(l,MOD-2);i&lt;l;i&#43;&#43;)pro(f[i],inv); } inline poly operator *(poly a,poly b){ int n=a.size(),m=b.size(),l=1; while(l&lt;n&#43;m)l&lt;&lt;=1; a.resize(l);b.resize(l); ntt(&amp;a[0],0,l);ntt(&amp;b[0],0,l); for(int i=0;i&lt;l;i&#43;&#43;)pro(a[i],b[i]); ntt(&amp;a[0],1,l); clear(a); return a; } inline poly&amp; operator *=(poly &amp;a,const poly b){return a=a*b;} inline poly operator *(poly a,const int &amp;b){ for(int i=0,n=a.size();i&lt;n;i&#43;&#43;)pro(a[i],b); return a; } inline poly inv(const poly &amp;a,const int &amp;n){ if(n==1)return poly(1,qpow(a[0],MOD-2)); int l=1;while(l&lt;=n&lt;&lt;1)l&lt;&lt;=1; poly b=inv(a,n&#43;1&gt;&gt;1),c(l);b.resize(l); for(int i=0;i&lt;n;i&#43;&#43;)c[i]=a[i]; ntt(&amp;b[0],0,l);ntt(&amp;c[0],0,l); for(int i=0;i&lt;l;i&#43;&#43;)pro(b[i],sub(2,mul(b[i],c[i]))); ntt(&amp;b[0],1,l); b.resize(n); clear(b); return b; } inline poly inv(const poly &amp;a){return inv(a,a.size());} int B; #define pii pair&lt;int,int&gt; inline pii operator *(pii a,pii b){ return pii(add(mul(a.first,b.first),mul(mul(a.second,b.second),B)),add(mul(a.first,b.second),mul(a.second,b.first))); } inline pii qpow(pii a,int b){pii c=pii(1,0);for(;b;b&gt;&gt;=1,a=a*a)if(b&amp;1)c=c*a;return c;} inline int remain(int x){ if(x&lt;=1)return x; int a=mul(mul(rand(),rand()),rand()); while(qpow(B=sub(mul(a,a),x),MOD-1&gt;&gt;1)==1)a=mul(mul(rand(),rand()),rand()); pii A=pii(a,1),ans=qpow(A,MOD&#43;1&gt;&gt;1); return min(ans.first,MOD-ans.first); } inline poly sqrt(const poly &amp;a,const int &amp;n){ if(n==1)return poly(1,remain(a[0])); int l=1;while(l&lt;=n&lt;&lt;1)l&lt;&lt;=1; poly b=sqrt(a,n&#43;1&gt;&gt;1),c(l),d; b.resize(n);d=inv(b)*INV2; b.resize(l);d.resize(l); for(int i=0;i&lt;n;i&#43;&#43;)c[i]=a[i]; ntt(&amp;b[0],0,l);ntt(&amp;c[0],0,l);ntt(&amp;d[0],0,l); for(int i=0;i&lt;l;i&#43;&#43;)b[i]=mul(d[i],add(mul(b[i],b[i]),c[i])); ntt(&amp;b[0],1,l); b.resize(n); clear(b); return b; } inline poly sqrt(const poly &amp;a){return sqrt(a,a.size());} inline poly deri(poly a){ int n=a.size(); if(n==1)return poly(1,0); for(int i=0;i&lt;n;i&#43;&#43;)a[i]=mul(a[i&#43;1],i&#43;1); a.resize(n-1); return a; } inline poly inte(poly a){ int n=a.size(); a.resize(n&#43;1); for(int i=n;i;i--)a[i]=mul(a[i-1],qpow(i,MOD-2)); a[0]=0; return a; } inline poly ln(const poly &amp;a){ int n=a.size(); poly c=inv(a)*deri(a); c.resize(n-1); return inte(c); } inline poly exp(const poly &amp;a,const int &amp;n){ if(n==1)return poly(1,1); poly b=exp(a,n&#43;1&gt;&gt;1),c; b.resize(n);c=ln(b); for(int i=0;i&lt;n;i&#43;&#43;)c[i]=sub(a[i],c[i]); inc(c[0]); b*=c; b.resize(n); return b; } inline poly exp(const poly &amp;a){return exp(a,a.size());} inline poly qpow(poly a,const double &amp;b){return exp(ln(a)*b);} poly a; int main(){ srand(19260817); pre(); scanf(&#34;%d%d&#34;,&amp;n,&amp;k); read(a,1&#43;n); a=deri(qpow(1&#43;ln(2&#43;a-a[0]-exp(inte(inv(sqrt(a))))),k)); a.resize(n); out(a); return 0; } 珂朵莉树1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 //以防我忘了set迭代器怎么写 struct node { int l, r; mutable lint v; node(int L, int R = -1, lint V = 0) : l(L), r(R), v(V) {} bool operator &lt; (const node &amp;o) const { return l &lt; o.l; } }; set &lt;node&gt; s; IT spilit (int pos) { IT it = s.lower_bound(node(pos)); if(it != s.end() &amp;&amp; it-&gt;l == pos) return it; it--; int L = it -&gt; l, R = it -&gt; r; lint V = it-&gt;v; s.erase(it); s.insert(node(L, pos-1, V)); return s.insert(node(pos, R, V)).first; } void add(int l, int r, int val) { IT il = spilit(l), ir = spilit(r&#43;1); for(; il != ir; il-&gt;v &#43;= val, il&#43;&#43;); } void tp(int l, int r, int val = 0) { IT il = spilit(l), ir = spilit(r&#43;1); s.erase(il, ir); s.insert(node(l, r, val)); }">
  <meta itemprop="datePublished" content="2022-03-09T18:26:20+08:00">
  <meta itemprop="dateModified" content="2022-03-09T18:26:20+08:00">
  <meta itemprop="wordCount" content="5759">
  <meta itemprop="image" content="https://www.sh1no.icu/avr.png"><meta property="og:url" content="https://www.sh1no.icu/posts/templates/">
  <meta property="og:site_name" content="Shino Channel">
  <meta property="og:title" content="板子 (ver.诗乃)">
  <meta property="og:description" content="Tarjan&amp;Topo1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 void tarjan(int u) { dfn[u] = low[u] = &#43;&#43;tim; ins[u] = 1; stac[&#43;&#43;top] = u; for(int v, i = h[u]; ~i; i = e[i].next) if(!dfn[(v = e[i].to)]) { tarjan(v); low[u] = min(low[u], low[v]); } else if(ins[v]) low[u] = min(low[u], low[v]); if(low[u] == dfn[u]) { int y; while(y = stac[top--]) { sd[y] = u; ins[y] = 0; if(u == y) break; p[u] &#43;= p[y]; } } } void topo() { queue &lt;int&gt; q; for(int i = 1; i &lt;= n; &#43;&#43;i) if(sd[i] == i &amp;&amp; !in[i]) q.push(i), dis[i] = p[i]; while(!q.empty()) { int u = q.front(); q.pop(); for(int v, i = h[u]; ~i; i = e[i].next) { v = e[i].to; dis[v] = max(dis[v], dis[u] &#43; p[v]); --in[v]; if(!in[v]) q.push(v); } } int ans = 0; for(int i = 1; i &lt;= n; &#43;&#43;i) ans = max(ans, dis[i]); printf(&#34;%d\n&#34;, ans); } ST1 2 3 4 5 6 7 8 9 void ST_Build() { for(int j = 1; j &lt;= 21; &#43;&#43;j) for(int i = 1; i &#43; (1 &lt;&lt; j) - 1 &lt;= n; &#43;&#43;i) st[i][j] = max(st[i][j-1], st[i&#43;(1&lt;&lt;(j-1))][j-1]); } int ST_query(int l, int r) { int k = lg2[r-l&#43;1]; return max(st[l][k], st[r-(1&lt;&lt;k)&#43;1][k]); } ST-BlackMagic1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 struct RMQ { #define L(x) ((x-1)*siz&#43;1) #define R(x) std::min(n, x*siz&#43;1) #define bl(x) ((x-1)/siz&#43;1) const int MAXB = 2050, siz = 50; int prf[MAXN], suf[MAXN], n, st[MAXB][13], lg2[MAXN], a[MAXN]; void init(int *s, int _n, int k) { n = _n; for(int i = 1; i &lt;= n; &#43;&#43;i) a[i] = s[i] % k, st[bl(i)][0] = min(st[bl(i)][0], a[i]); for(int i = 1; i &lt;= bl(n); &#43;&#43;i) { prf[L(i)] = a[L(i)]; suf[R(i)] = a[R(i)]; for(int j = L(i)&#43;1; j &lt;= R(i); &#43;&#43;j) prf[j] = min(prf[j-1], a[j]); for(int j = R(i)-1; j &gt;= L(i); --j) suf[j] = min(suf[j&#43;1], a[j]); } for(int j = 1; j &lt;= 12; &#43;&#43;j) for(int i = 1; i &#43; (1 &lt;&lt; j) - 1 &lt;= bl(n); &#43;&#43;i) st[i][j] = min(st[i][j-1], st[i&#43;(1&lt;&lt;(j-1))][j-1]); } int QST(int l, int r) { if(l &gt; r) return 0; int k = lg2[r-l&#43;1]; return min(st[l][k], st[r-(1&lt;&lt;k)&#43;1][k]); } int query(int l, int r) { if(bl(l) == bl(r)) { int res = 0; for(int i = l; i &lt;= r; &#43;&#43;i) res = max(res, a[i]); return res; } else return min(min(prf[r], suf[l]), QST(bl(l)&#43;1, bl(r)-1)); } } ST; Manacher1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 void Manacher() { int mr = 0, mid; for(int i = 0; i &lt; n; &#43;&#43;i) { p[i] = i &lt; mr ? min(p[(mid &lt;&lt; 1) - i], p[mid] &#43; mid - i) : 1; for(; s[i-p[i]] == s[i&#43;p[i]]; &#43;&#43;p[i]); if(p[i] &#43; i &gt; mr) mr = i &#43; p[i], mid = i; } } int main() { scanf(&#34;%s&#34;, a); _n = strlen(a); s[0] = s[1] = &#39;#&#39;; n = 1; for(int i = 0; i &lt; _n; &#43;&#43;i) s[&#43;&#43;n] = a[i], s[&#43;&#43;n] = &#39;#&#39;; s[&#43;&#43;n] = 0; Manacher(); for(int i = 0; i &lt; n; &#43;&#43;i) ans = max(ans, p[i]); printf(&#34;%d\n&#34;, ans-1); } 线性基1 2 3 4 5 6 7 8 9 10 11 for(int i = 1; i &lt;= n; &#43;&#43;i) { read(a); for(int j = 50; j &gt;= 0; --j) { if((a &gt;&gt; j) &amp; 1) { if(!p[j]) {p[j] = a; break;} a ^= p[j]; } } } for(int i = 50; i &gt;= 0; --i) if(p[i]) ans = max(ans, ans ^ p[i]); 线性逆元1 2 3 inv[1] = 1; for(int i = 2; i &lt;= n; &#43;&#43;i) inv[i] = 1ll * (P - P / i) % P * inv[P % i]	% P; 后缀数组1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 void getSA() { for(int i = 1; i &lt;= n; &#43;&#43;i) &#43;&#43;c[x[i] = s[i]]; for(int i = 1; i &lt;= m; &#43;&#43;i) c[i] &#43;= c[i-1]; for(int i = n; i &gt;= 1; --i) sa[c[x[i]]--] = i; for(int k = 1; k &lt;= n; k &lt;&lt;= 1) { int num = 0; for(int i = n - k &#43; 1; i &lt;= n; &#43;&#43;i) y[&#43;&#43;num] = i; for(int i = 1; i &lt;= n; &#43;&#43;i) if(sa[i] &gt; k) y[&#43;&#43;num] = sa[i] - k; memset(c, 0, sizeof c); for(int i = 1; i &lt;= n; &#43;&#43;i) &#43;&#43;c[x[i]]; for(int i = 1; i &lt;= m; &#43;&#43;i) c[i] &#43;= c[i-1]; for(int i = n; i &gt;= 1; --i) sa[c[x[y[i]]]--] = y[i], y[i] = 0; swap(x, y); x[sa[1]] = 1; num = 0; for(int i = 1; i &lt;= n; &#43;&#43;i) x[sa[i]] = (y[sa[i-1]] == y[sa[i]] &amp;&amp; y[sa[i-1]&#43;k] == y[sa[i]&#43;k]) ? num : &#43;&#43;num; if(num == n) break; m = num; } } 点分治1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 void getroot(int u, int p, int S) { siz[u] = 1, f[u] = 0; for(int v, i = h[u]; ~i; i = e[i].next) if((v = e[i].to) != p &amp;&amp; !vis[v]) getroot(v, u, S), siz[u] &#43;= siz[v], f[u] = max(f[u], siz[v]); f[u] = max(f[u], S - siz[u]); rt = f[u] &lt; f[rt] ? u : rt; } void getdis(int u, int p) { stk[&#43;&#43;top] = dis[u]; for(int v, i = h[u]; ~i; i = e[i].next) if((v = e[i].to) != p &amp;&amp; !vis[v]) dis[v] = dis[u] &#43; e[i].w, getdis(v, u); } void solve(int u, int w, int t) { top = 0, dis[u] = w, getdis(u, 0); for(int i = 1; i &lt;= top; &#43;&#43;i) for(int j = 1; j &lt;= top; &#43;&#43;j) if(i != j) ans[stk[i] &#43; stk[j]] &#43;= t; } void devide(int u) { solve(u, 0, 1); vis[u] = 1; for(int v, i = h[u]; ~i; i = e[i].next) if(!vis[(v = e[i].to)]) { solve(v, e[i].w, -1), rt = 0, f[0] = n; getroot(v, u, siz[u]), devide(rt); } } 线段树1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 #define L(u) (u&lt;&lt;1) #define R(u) (u&lt;&lt;1|1) #define mid ((l&#43;r)&gt;&gt;1) void PU(int u) {t[u] = (t[L(u)] &#43; t[R(u)]) % P;} void ADD(int u, int l, int r, int k) { t[u] &#43;= (r - l &#43; 1) * k % P; t[u] %= P; add[u] = (add[u] &#43; k) % P; } void MUL(int u, int l, int r, int k) { t[u] = t[u] * k % P; add[u] = add[u] * k % P; mul[u] = mul[u] * k % P; } void PD(int u, int l, int r) { MUL(L(u), l, mid, mul[u]); MUL(R(u), mid&#43;1, r, mul[u]); mul[u] = 1; ADD(L(u), l, mid, add[u]); ADD(R(u), mid&#43;1, r, add[u]); add[u] = 0; } void build(int u, int l, int r) { mul[u] = 1; if(l == r) {t[u] = a[l]; return;} build(L(u), l, mid); build(R(u), mid&#43;1, r); PU(u); } void MA(int u, int l, int r, int tl, int tr, int k) { if(tr &lt; l || tl &gt; r) return; if(tl &lt;= l &amp;&amp; r &lt;= tr) {ADD(u, l, r, k); return;} PD(u, l, r); MA(L(u), l, mid, tl, tr, k); MA(R(u), mid&#43;1, r, tl, tr, k); PU(u); } void MM(int u, int l, int r, int tl, int tr, int k) { if(tr &lt; l || tl &gt; r) return; if(tl &lt;= l &amp;&amp; r &lt;= tr) {MUL(u, l, r, k); return;} PD(u, l, r); MM(L(u), l, mid, tl, tr, k); MM(R(u), mid&#43;1, r, tl, tr, k); PU(u); } int Q(int u, int l, int r, int tl, int tr) { if(tr &lt; l || tl &gt; r) return 0; if(tl &lt;= l &amp;&amp; r &lt;= tr) return t[u]; PD(u, l, r); return (Q(L(u), l, mid, tl, tr) &#43; Q(R(u), mid&#43;1, r, tl, tr)) % P; } 三分1 2 3 4 5 while(fabs(r-l) &gt;= eps) { double mid = (l &#43; r) / 2; if(f(mid - eps) &lt; f(mid &#43; eps)) l = mid; else r = mid; } 树状数组1 2 void U(int x, int k) {for(; x &lt;= n; t[x] &#43;= k, x &#43;= x&amp;-x);} int Q(int x) {int w = 0; for(; x; w &#43;= t[x], x -= x&amp;-x); return w;} 高斯消元1 2 3 4 5 6 7 8 9 10 11 12 13 for(int i = 1; i &lt;= n; &#43;&#43;i) { int p = i; for(int j = i &#43; 1; j &lt;= n; &#43;&#43;j) if(fabs(a[j][i]) &gt; fabs(a[p][i])) p = j; if(a[p][i] == 0) {puts(&#34;No Solution&#34;); return 0;} for(int j = 1; j &lt;= n&#43;1; &#43;&#43;j) swap(a[i][j], a[p][j]); for(int j = 1; j &lt;= n; &#43;&#43;j) { if(i == j) continue; double t = a[j][i] / a[i][i]; for(int k = i; k &lt;= n&#43;1; &#43;&#43;k) a[j][k] -= a[i][k] * t; } } for(int i = 1; i &lt;= n; &#43;&#43;i) printf(&#34;%.2lf\n&#34;, a[i][n&#43;1] / a[i][i]); 最小生成树&amp;并查集1 2 3 4 5 6 7 8 9 10 11 12 int findfa(int x) {return x == fa[x] ? x : fa[x] = findfa(fa[x]);} int main() { for(int i = 1; i &lt;= n; &#43;&#43;i) fa[i] = i; sort(e&#43;1, e&#43;m&#43;1); for(int i = 1; i &lt;= m; &#43;&#43;i) { int x = findfa(e[i].u), y = findfa(e[i].v); if(x == y) continue; ans &#43;= e[i].w; &#43;&#43;cnt; if(cnt == n-1) break; fa[x] = y; } } DINIC1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 bool bfs() { memset(d, -1, sizeof d); queue &lt;int&gt; q; q.push(s); d[s] = 0; while(!q.empty()) { int u = q.front(); q.pop(); for(int v, i = h[u]; ~i; i = e[i].next) if(d[v = e[i].to] == -1 &amp;&amp; e[i].w &gt; 0) d[v] = d[u] &#43; 1, q.push(v); } return d[t] != -1; } int dfs(int u, int f) { int r = 0; if(u == t) return f; for(int v, i = h[u]; ~i &amp;&amp; r &lt; f; i = e[i].next) if(d[(v = e[i].to)] == d[u] &#43; 1 &amp;&amp; e[i].w &gt; 0) { int x = dfs(v, min(e[i].w, f-r)); e[i].w -= x; e[i^1].w &#43;= x; r &#43;= x; } if(!r) d[u] = -1; return r; } int dinic() { int x, ans = 0; while(bfs()) while(x = dfs(s, 1e9)) ans &#43;= x; return ans; } 线性筛1 2 3 4 5 6 7 for(int i = 2; i &lt;= n; &#43;&#43;i) { if(!notp[i]) p[&#43;&#43;cntp] = i; for(int j = 1; 1ll*i*p[j] &lt;= n &amp;&amp; j &lt;= cntp; &#43;&#43;j) { notp[i*p[j]] = 1; if(i % p[j] == 0) break; } } 左偏树1 2 3 4 5 6 7 8 9 10 11 12 13 14 int F(int x) {return x == fa[x] ? x : fa[x] = F(fa[x]);} int Merge(int x, int y) { if(x*y == 0) return x&#43;y; if(v[x] &gt; v[y] || (v[x] == v[y] &amp;&amp; x &gt; y)) swap(x, y); R(x) = Merge(R(x), y); fa[R(x)] = fa[L(x)] = x; if(dis[R(x)] &gt; dis[L(x)]) swap(L(x), R(x)); dis[x] = dis[R(x)] &#43; 1; return x; } int Top(int x) {return del[x] ? -1 : v[x];} void Pop(int x) { if(del[x]) return; del[x] = 1; fa[L(x)] = L(x); fa[R(x)] = R(x); fa[x] = Merge(L(x), R(x)); } LCT1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 bool nroot(int x) {return ch[fa[x]][0] == x || ch[fa[x]][1] == x;} void pushup(int x) {sumx[x] = sumx[ch[x][1]] ^ sumx[ch[x][0]] ^ val[x];} void pushr(int x) {swap(ch[x][1], ch[x][0]); rot[x] ^= 1;} void pushdown(int x) {if(rot[x]) {if(ch[x][0]) pushr(ch[x][0]); if(ch[x][1]) pushr(ch[x][1]); rot[x] = 0;}} void rotate(int x) { int y = fa[x], z = fa[y], k = (x == ch[y][1]); if(nroot(y)) ch[z][(y == ch[z][1])] = x; fa[x] = z; ch[y][k] = ch[x][k^1]; if(ch[x][k^1]) fa[ch[x][k^1]] = y; ch[x][k^1] = y; fa[y] = x; pushup(y); } void splay(int x) { int y = x, z = 0; st[&#43;&#43;z] = y; while(nroot(y)) st[&#43;&#43;z] = y = fa[y]; while(z) pushdown(st[z--]); for(int y; nroot(x); rotate(x)) if(nroot(y = fa[x])) rotate((y == ch[fa[y]][0]) ^ (x == ch[y][0]) ? x : y); pushup(x); } void access(int x) {for(int y = 0; x; x = fa[y = x]) splay(x), ch[x][1] = y, pushup(x);} void makeroot(int x) {access(x); splay(x); pushr(x);} int findroot(int x) {access(x); splay(x); for(; ch[x][0]; x = ch[x][0]) pushdown(x); splay(x); return x;} void spilit(int x, int y) {makeroot(x); access(y); splay(y);} void link(int x, int y) {makeroot(x); if(findroot(y) != x) fa[x] = y;} void cut(int x, int y) {makeroot(x); if(findroot(y) == x &amp;&amp; fa[y] == x &amp;&amp; !ch[y][0]) {fa[y] = ch[x][1] = 0; pushup(x);}} KMP1 2 3 4 5 6 7 8 9 for(int i = 2, j = 0; i &lt;= n; &#43;&#43;i) { while(j &amp;&amp; s[i] != s[j&#43;1]) j = nxt[j]; if(s[j&#43;1] == s[i]) &#43;&#43;j; nxt[i] = j; } for(int i = 1, j = 0; i &lt;= m; &#43;&#43;i) { while(j &gt; 0 &amp;&amp; t[i] != s[j&#43;1]) j = nxt[j]; if(s[j&#43;1] == t[i]) &#43;&#43;j; if(j == n) printf(&#34;%d\n&#34;, i-n&#43;1); } SAM1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 struct SoumAsuMire { int ch[MAXN][26], fa[MAXN], last, cnt, len[MAXN]; void insert(int c) { int p = last, np = &#43;&#43;cnt; last = np; len[np] = len[p] &#43; 1; for(; p &amp;&amp; !ch[p][c]; ch[p][c] = np, p = fa[p]); if(!p) fa[np] = 1; else { int q = ch[p][c]; if(len[q] == len[p] &#43; 1) fa[np] = q; else { int nq = &#43;&#43;cnt; len[nq] = len[p] &#43; 1; memcpy(ch[nq], ch[q], sizeof ch[q]); fa[nq] = fa[q]; fa[q] = fa[np] = nq; for(; p &amp;&amp; ch[p][c] == q; ch[p][c] = nq, p = fa[p]); } } } void build(char *s) { int n = strlen(s&#43;1); last = 1; for(int i = 1; i &lt;= n; &#43;&#43;i) insert(s[i] - &#39;a&#39;); } int getans() { int ans = 0; for(int i = 2; i &lt;= cnt; &#43;&#43;i) ans &#43;= len[i] - len[fa[i]]; return ans; } } SAM; LCA(ST)1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 void dfsRMQ(int u, int p) { st[&#43;&#43;idx][0] = u; dfn[u] = idx; dep[u] = dep[p] &#43; 1; for(int v, i = h[u]; ~i; i = e[i].next) if((v = e[i].to) != p) dfsRMQ(v, u), st[&#43;&#43;idx][0] = u; } void LCAinit() { for(int i = 2; i &lt;= (n &lt;&lt; 1); &#43;&#43;i) lg2[i] = lg2[i&gt;&gt;1] &#43; 1; dep[1] = 1; dfsRMQ(rt, 0); for(int j = 1; j &lt; 20; &#43;&#43;j) for(int i = 1; i &#43; (1 &lt;&lt; j) &lt;= (n &lt;&lt; 1); &#43;&#43;i) st[i][j] = Min(st[i][j-1], st[i&#43;(1&lt;&lt;(j-1))][j-1]); } int LCA(int x, int y) { x = dfn[x]; y = dfn[y]; if(x &gt; y) swap(x, y); int k = lg2[y-x&#43;1]; return Min(st[x][k], st[y-(1&lt;&lt;k)&#43;1][k]); } mcmf1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 bool SPFA() { memset(d, 63, sizeof d); memset(vis, 0, sizeof vis); memset(flow, 63, sizeof flow); queue &lt;int&gt; q; q.push(s); d[s] = 0; vis[s] = 1; while(!q.empty()) { int u = q.front(); q.pop(); vis[u] = 0; for(int v, i = h[u]; ~i; i = e[i].next) if(d[v = e[i].to] &gt; d[u] &#43; e[i].c &amp;&amp; e[i].f) { d[v] = d[u] &#43; e[i].c; pos[v] = i; fa[v] = u; flow[v] = min(flow[u], e[i].f); if(!vis[v]) vis[v] = 1, q.push(v); } } return flow[s] != flow[t]; } void mcmf() { while(SPFA()) { mc &#43;= flow[t]; mf &#43;= flow[t] * d[t]; for(int u = t; u != s; u = fa[u]) e[pos[u]].f -= flow[t], e[pos[u]^1].f &#43;= flow[t]; } } AC自动机1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 #include &lt;bits/stdc&#43;&#43;.h&gt; using namespace std; const int S = 2000050, T = 200050; struct Edge {int to, next;} e[T]; char s[S]; int n, h[T], cnt, ch[T][26], fail[T], match[T], siz[T], tot = 1, en; queue &lt;int&gt; q; void addedge(int u, int v) {e[en] = (Edge) {v, h[u]}; h[u] = en&#43;&#43;;} void dfs(int u) { for(int v, i = h[u]; ~i; i = e[i].next) dfs(v = e[i].to), siz[u] &#43;= siz[v]; } int main() { scanf(&#34;%d&#34;, &amp;n); memset(h, -1, sizeof h); for(int i = 1; i &lt;= n; &#43;&#43;i) { scanf(&#34;%s&#34;, s); int u = 1, j; for(u = 1, j = 0; s[j]; &#43;&#43;j) { int c = s[j] - &#39;a&#39;; if(!ch[u][c]) ch[u][c] = &#43;&#43;tot; u = ch[u][c]; } match[i] = u; } for(int i = 0; i &lt; 26; &#43;&#43;i) ch[0][i] = 1; q.push(1); while(!q.empty()) { int u = q.front(); q.pop(); for(int i = 0; i &lt; 26; &#43;&#43;i) if(ch[u][i]) { fail[ch[u][i]] = ch[fail[u]][i]; q.push(ch[u][i]); } else ch[u][i] = ch[fail[u]][i]; } scanf(&#34;%s&#34;, s); for(int u = 1, i = 0; s[i]; &#43;&#43;i) &#43;&#43;siz[u = ch[u][s[i]-&#39;a&#39;]]; for(int i = 2; i &lt;= tot; &#43;&#43;i) addedge(fail[i], i); dfs(1); for(int i = 1; i &lt;= n; &#43;&#43;i) printf(&#34;%d\n&#34;, siz[match[i]]); puts(&#34;&#34;); } dijkstra1 2 3 4 5 6 7 8 9 10 11 12 13 void dijkstra() { memset(d, 0x3f, sizeof d); d[s] = 0; q.push((D) {s, 0}); while(!q.empty()) { int u = q.top().u; q.pop(); if(vis[u]) continue; vis[u] = 1; for(int v, i = h[u]; ~i; i = e[i].next) if(d[v = e[i].to] &gt; d[u] &#43; e[i].w) { d[v] = d[u] &#43; e[i].w; if(!vis[v]) q.push((D) {v, d[v]}); } } } 树哈希1 2 3 4 5 6 7 8 ull Hash(int u, int p) { ull q[MAXN], ans = X; int top = 0; for(int i = h[u]; ~i; i = e[i].next) if(e[i].to != p) q[&#43;&#43;top] = Hash(e[i].to, u); sort(q&#43;1, q&#43;top&#43;1); for(int i = 1; i &lt;= top; &#43;&#43;i) ans = ans * P &#43; q[i]; return ans * P &#43; X &#43; 1; } CDQ分治1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 struct BITS { int t[MAXN]; void U(int x, int k) {for(; x &lt;= m; t[x] &#43;= k, x &#43;= x&amp;-x);} int Q(int x) {int res = 0; for(; x; res &#43;= t[x], x -= x&amp;-x); return res;} } T; void cdq(int l, int r) { if(l == r) return; int mid = (l &#43; r) &gt;&gt; 1; cdq(l, mid); cdq(mid&#43;1, r); sort(a&#43;l, a&#43;mid&#43;1, cmpy); sort(a&#43;mid&#43;1, a&#43;r&#43;1, cmpy); int i = mid &#43; 1, j = l; for(; i &lt;= r; &#43;&#43;i) { for(; a[j].y &lt;= a[i].y &amp;&amp; j &lt;= mid; &#43;&#43;j) T.U(a[j].z, a[j].w); a[i].ans &#43;= T.Q(a[i].z); } for(int k = l; k &lt; j; &#43;&#43;k) T.U(a[k].z, -a[k].w); } int main() { read(_n); read(m); for(int i = 1; i &lt;= _n; &#43;&#43;i) read(b[i].x), read(b[i].y), read(b[i].z); sort(b&#43;1, b&#43;_n&#43;1, cmpx); for(int c = 0, i = 1; i &lt;= _n; &#43;&#43;i) { &#43;&#43;c; if(b[i].x != b[i&#43;1].x || b[i].y != b[i&#43;1].y || b[i].z != b[i&#43;1].z) a[&#43;&#43;n] = b[i], a[n].w = c, c = 0; } cdq(1, n); for(int i = 1; i &lt;= n; &#43;&#43;i) cnt[a[i].ans &#43; a[i].w - 1] &#43;= a[i].w; for(int i = 0; i &lt; _n; &#43;&#43;i) printf(&#34;%d\n&#34;, cnt[i]); } Lucas1 2 3 4 5 6 7 8 int C(int n, int m) { if(m &gt; n) return 0; return 1ll * fac[n] * power(fac[m], P-2) * power(fac[n-m], P-2); } int Lucas(int n, int m) { if(m == 0) return 1; return 1ll * C(n%P, m%P) * Lucas(n/P, m/P) % P; } 二分图1 2 3 4 5 6 7 8 9 10 bool dfs(int u) { for(int v, i = h[u]; ~i; i = e[i].next) { if(vis[v = e[i].to] != tag) { vis[v] = tag; if(!match[v] || dfs(match[v])) { match[v] = u; return 1; } } } return 0; } 莫队二次离线1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 #include &lt;bits/stdc&#43;&#43;.h&gt; using namespace std; const int MAXN = 100050; typedef long long lint; void read(int &amp;x) { char ch; while(ch = getchar(), ch &lt; &#39;!&#39;); x = ch - 48; while(ch = getchar(), ch &gt; &#39;!&#39;) x = (x &lt;&lt; 3) &#43; (x &lt;&lt; 1) &#43; ch - 48; } struct Qry {int l, r, id; lint ans;} q[MAXN]; struct T{int l, r, id;}; int n, m, a[MAXN], siz[MAXN], k, blsz, bl[MAXN], t[MAXN], pref[MAXN]; vector &lt;int&gt; buc; vector &lt;T&gt; v[MAXN]; lint ans[MAXN]; int cmp(Qry a, Qry b) {return bl[a.l] == bl[b.l] ? a.r &lt; b.r : a.l &lt; b.l;} int main() { read(n); read(m); read(k); blsz = sqrt(n); if(k &gt; 14) {for(int i = 1; i &lt;= m; &#43;&#43;i) puts(&#34;0&#34;); return 0;} for(int i = 1; i &lt;= n; &#43;&#43;i) read(a[i]); for(int i = 0; i &lt; 16384; &#43;&#43;i) if((siz[i] = siz[(i&gt;&gt;1)] &#43; (i&amp;1)) == k) buc.push_back(i); for(int i = 1; i &lt;= m; &#43;&#43;i) read(q[i].l), read(q[i].r), q[i].id = i; for(int i = 1; i &lt;= n; &#43;&#43;i) bl[i] = (i-1) / blsz &#43; 1; sort(q&#43;1, q&#43;m&#43;1, cmp); for(int i = 1; i &lt;= n; &#43;&#43;i) { for(int j = 0; j &lt; buc.size(); &#43;&#43;j) &#43;&#43;t[a[i]^buc[j]]; pref[i] = t[a[i&#43;1]]; } for(int L = 1, R = 0, i = 1; i &lt;= m; &#43;&#43;i) { int l = q[i].l, r = q[i].r; if(L &lt; l) v[R].push_back((T) {L, l-1, -i}); while(L &lt; l) {q[i].ans &#43;= pref[L-1]; &#43;&#43;L;} if(L &gt; l) v[R].push_back((T) {l, L-1, i}); while(L &gt; l) {q[i].ans -= pref[L-2]; --L;} if(R &lt; r) v[L-1].push_back((T) {R&#43;1, r, -i}); while(R &lt; r) {q[i].ans &#43;= pref[R]; &#43;&#43;R;} if(R &gt; r) v[L-1].push_back((T) {r&#43;1, R, i}); while(R &gt; r) {q[i].ans -= pref[R-1]; --R;} } memset(t, 0, sizeof t); for(int l, r, id, i = 1; i &lt;= n; &#43;&#43;i) { for(int j = 0; j &lt; buc.size(); &#43;&#43;j) &#43;&#43;t[a[i]^buc[j]]; for(int o = 0; o &lt; v[i].size(); &#43;&#43;o) { l = v[i][o].l; r = v[i][o].r; id = v[i][o].id; for(int j = l, tmp = 0; j &lt;= r; &#43;&#43;j) { tmp = t[a[j]]; if(j &lt;= i &amp;&amp; !k) --tmp; if(id &gt; 0) q[id].ans &#43;= tmp; else q[-id].ans -= tmp; } } } for(int i = 1; i &lt;= m; &#43;&#43;i) q[i].ans &#43;= q[i-1].ans; for(int i = 1; i &lt;= m; &#43;&#43;i) ans[q[i].id] = q[i].ans; for(int i = 1; i &lt;= m; &#43;&#43;i) printf(&#34;%lld\n&#34;, ans[i]); } 莫比乌斯反演1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 void GetMu() { mu[1] = 1; for(int i = 2; i &lt;= 10000000; &#43;&#43;i) { if(!vis[i]) p[&#43;&#43;cnt] = i, mu[i] = -1; for(int j = 1; j &lt;= cnt &amp;&amp; p[j] * i &lt;= 10000000; &#43;&#43;j) { vis[p[j]*i] = 1; if(i % p[j]) mu[p[j]*i] = -mu[i]; } } for(int i = 1; i &lt;= cnt; &#43;&#43;i) for(int j = 1; j * p[i] &lt;= 10000000; &#43;&#43;j) f[j*p[i]] &#43;= mu[j]; for(int i = 1; i &lt;= 10000000; &#43;&#43;i) pref[i] = pref[i-1] &#43; f[i]; } lint calc(int a, int b) { lint res = 0; if(a &gt; b) swap(a, b); for(int l = 1, r = 0; l &lt;= a; l = r &#43; 1) { r = min(a/(a/l), b/(b/l)); res &#43;= (pref[r] - pref[l-1])*1ll*(a/l)*(b/l); } return res; } 树剖1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 void ADD(int u, int l, int r, int k) {t[u] = (t[u] &#43; 1ll*k*(r-l&#43;1)%P) % P; tag[u] = (tag[u] &#43; k) % P;} void PD(int u, int l, int r) {ADD(L(u), l, mid, tag[u]); ADD(R(u), mid&#43;1, r, tag[u]); tag[u] = 0;} void PU(int u) {t[u] = (t[L(u)] &#43; t[R(u)]) % P;} void build(int u, int l, int r) { if(l == r) {t[u] = w[id[l]]; return; } build(L(u), l, mid); build(R(u), mid&#43;1, r); PU(u); } void upd(int u, int l, int r, int tl, int tr, int k) { if(tr &lt; l || tl &gt; r) return; if(tl &lt;= l &amp;&amp; r &lt;= tr) ADD(u, l, r, k); else PD(u, l, r), upd(L(u), l, mid, tl, tr, k), upd(R(u), mid&#43;1, r, tl, tr, k), PU(u); } int qry(int u, int l, int r, int tl, int tr) { if(tr &lt; l || tl &gt; r) return 0; if(tl &lt;= l &amp;&amp; r &lt;= tr) return t[u]; PD(u, l, r); return (qry(L(u), l, mid, tl, tr) &#43; qry(R(u), mid&#43;1, r, tl, tr)) % P; } void dfs1(int u, int p) { fa[u] = p; siz[u] = 1; dep[u] = dep[p] &#43; 1; for(int v, i = h[u]; ~i; i = e[i].next) if((v = e[i].to) != p) { dfs1(v, u); siz[u] &#43;= siz[v]; if(siz[son[u]] &lt; siz[v]) son[u] = v; } } void dfs2(int u, int p) { id[dfn[u] = &#43;&#43;idx] = u; top[u] = p; if(son[u]) dfs2(son[u], p); for(int v, i = h[u]; ~i; i = e[i].next) if((v = e[i].to) != fa[u] &amp;&amp; v != son[u]) dfs2(v, v); } void addpath(int x, int y, int k) { for(; top[x] != top[y]; x = fa[top[x]]) { if(dep[top[x]] &lt; dep[top[y]]) swap(x, y); upd(1, 1, n, dfn[top[x]], dfn[x], k); } if(dep[x] &gt; dep[y]) swap(x, y); upd(1, 1, n, dfn[x], dfn[y], k); } int qrypath(int x, int y) { int res = 0; for(; top[x] != top[y]; x = fa[top[x]]) { if(dep[top[x]] &lt; dep[top[y]]) swap(x, y); res = (res &#43; qry(1, 1, n, dfn[top[x]], dfn[x])) % P; } if(dep[x] &gt; dep[y]) swap(x, y); return (res &#43; qry(1, 1, n, dfn[x], dfn[y])) % P; } void addroot(int x, int k) {upd(1, 1, n, dfn[x], dfn[x] &#43; siz[x] - 1, k); } int qryroot(int x) {return qry(1, 1, n, dfn[x], dfn[x] &#43; siz[x] - 1);} 主席树1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 struct JZM_T {int ch[2], v;} t[MAXN &lt;&lt; 6]; int cnt, rt[MAXN &lt;&lt; 6], o[MAXN], a[MAXN], n, m; void build(int &amp;u, int l, int r) { t[u = &#43;&#43;cnt].v = 0; if(l != r) build(L(u), l, mid), build(R(u), mid&#43;1, r); } void update(int &amp;u, int v, int l, int r, int p, int k) { t[u = &#43;&#43;cnt] = t[v]; t[u].v &#43;= k; if(l != r) p &lt;= mid ? update(L(u), L(v), l, mid, p, k) : update(R(u), R(v), mid&#43;1, r, p, k); } int query(int tl, int tr, int l, int r, int k) { if(l == r) return o[l]; int s = t[L(tr)].v - t[L(tl)].v; return k &lt;= s ? query(L(tl), L(tr), l, mid, k) : query(R(tl), R(tr), mid&#43;1, r, k-s); } int main() { read(n); read(m); for(int i = 1; i &lt;= n; &#43;&#43;i) read(a[i]), o[i] = a[i]; sort(o&#43;1, o&#43;n&#43;1); int _n = unique(o&#43;1, o&#43;n&#43;1)-o-1; build(rt[0], 1, _n); for(int i = 1; i &lt;= n; &#43;&#43;i) update(rt[i], rt[i-1], 1, _n, lower_bound(o&#43;1, o&#43;_n&#43;1, a[i])-o, 1); for(int l, r, k; m--; ) { read(l); read(r); read(k); printf(&#34;%d\n&#34;, query(rt[l-1], rt[r], 1, _n, k)); } } GCD-BlackMagic1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 int gcd(int a, int b) { int g = 1; for(int tmp, i = 0; i &lt; 3; b /= tmp, g *= tmp, &#43;&#43;i) tmp = (k[a][i] &gt; siz) ? (b % k[a][i] == 0 ? k[a][i] : 1) : _gcd[k[a][i]][b%k[a][i]]; return g; } int main() { k[1][0] = k[1][1] = k[1][2] = 1; notp[1] = 1; for(int i = 2; i &lt;= V; &#43;&#43;i) { if(!notp[i]) p[&#43;&#43;cnt] = i, k[i][2] = i, k[i][1] = k[i][0] = 1; for(int j = 1; p[j] * i &lt;= V; &#43;&#43;j) { notp[i * p[j]] = 1; int *t = k[i*p[j]]; t[0] = k[i][0] * p[j]; t[1] = k[i][1]; t[2] = k[i][2]; if(t[1] &lt; t[0]) swap(t[0], t[1]); if(t[2] &lt; t[1]) swap(t[1], t[2]); if(i % p[j] == 0) break; } } for(int i = 1; i &lt;= siz; &#43;&#43;i) _gcd[i][0] = _gcd[0][i] = i; for(int _max = 1; _max &lt;= siz; &#43;&#43;_max) for(int i = 1; i &lt;= _max; &#43;&#43;i) _gcd[i][_max] = _gcd[_max][i] = _gcd[_max % i][i]; FFT1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 struct Complex { double x, y; Complex(double xx = 0, double yy = 0) {x = xx; y = yy;} Complex operator &#43; (Complex &amp;b) const {return Complex(x&#43;b.x, y&#43;b.y);} Complex operator - (Complex &amp;b) const {return Complex(x-b.x, y-b.y);} Complex operator * (Complex &amp;b) const {return Complex(x*b.x-y*b.y, y*b.x&#43;x*b.y);} } a[MAXN], b[MAXN]; int r[MAXN], n, m, l, limit; void FFT (Complex *A, int t) { for(int i = 0; i &lt; limit; &#43;&#43;i) if(i &lt; r[i]) swap(A[i], A[r[i]]); for(int mid = 1; mid &lt; limit; mid &lt;&lt;= 1) { Complex Wn = Complex(cos(Pi/mid), t * sin(Pi/mid)); for(int R = mid&lt;&lt;1, j = 0; j &lt; limit; j &#43;= R) { Complex w = Complex(1, 0); for(int k = 0; k &lt; mid; &#43;&#43;k, w = w * Wn) { Complex x = A[j&#43;k], y = w*A[j&#43;mid&#43;k]; A[j&#43;k] = x&#43;y; A[j&#43;mid&#43;k] = x-y; } } } } int main() { n = read(); m = read(); for(int i = 0; i &lt;= n; &#43;&#43;i) a[i].x = read(); for(int i = 0; i &lt;= m; &#43;&#43;i) b[i].x = read(); for(limit = 1; limit &lt;= n&#43;m; limit &lt;&lt;= 1, &#43;&#43;l); for(int i = 0; i &lt; limit; &#43;&#43;i) r[i] = (r[i&gt;&gt;1]&gt;&gt;1)|((i&amp;1)&lt;&lt;(l-1)); FFT(a, 1); FFT(b, 1); for(int i = 0; i &lt;= limit; &#43;&#43;i) a[i] = a[i]*b[i]; FFT(a, -1); for(int i = 0; i &lt;= n&#43;m; &#43;&#43;i) printf(&#34;%d &#34;, (int)(a[i].x/limit&#43;0.5)); puts(&#34;&#34;); } 多项式1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102 103 104 105 106 107 108 109 110 111 112 113 114 115 116 117 118 119 120 121 122 123 124 125 126 127 128 129 130 131 132 133 134 135 136 137 138 139 140 141 142 143 144 145 146 147 148 149 150 151 152 153 154 155 156 157 158 159 160 161 162 163 164 165 166 167 168 169 170 171 172 173 174 175 176 177 178 179 180 181 182 183 184 185 186 187 #include&lt;bits/stdc&#43;&#43;.h&gt; #define ll long long #define FIO &#34;loj150&#34; using namespace std; const int N=1e5&#43;5,MOD=998244353,P=19,INV2=MOD&#43;1&gt;&gt;1; inline int add(int a,const int &amp;b){if((a&#43;=b)&gt;=MOD)a-=MOD;return a;} inline int sub(int a,const int &amp;b){if((a-=b)&lt;	0)a&#43;=MOD;return a;} inline int mul(const int &amp;a,const int &amp;b){return 1ll*a*b%MOD;} inline void inc(int &amp;a,const int &amp;b=1){a=add(a,b);} inline void dec(int &amp;a,const int &amp;b=1){a=sub(a,b);} inline void pro(int &amp;a,const int &amp;b){a=mul(a,b);} inline int qpow(int a,int b){int c=1;for(;b;b&gt;&gt;=1,pro(a,a))if(b&amp;1)pro(c,a);return c;} int n,k,w[2][1&lt;&lt;P]; inline void pre(){ for(int i=1;i&lt;1&lt;&lt;P;i&lt;&lt;=1){ w[0][i]=w[1][i]=1; int wn1=qpow(3,(MOD-1)/(i&lt;&lt;1)),wn0=qpow(wn1,MOD-2); for(int j=1;j&lt;i;j&#43;&#43;) w[0][i&#43;j]=mul(w[0][i&#43;j-1],wn0),w[1][i&#43;j]=mul(w[1][i&#43;j-1],wn1); } } #define poly vector&lt;int&gt; inline void read(poly &amp;a,const int &amp;n){ a.resize(n); for(int i=0;i&lt;n;i&#43;&#43;)scanf(&#34;%d&#34;,&amp;a[i]); } inline void out(const poly &amp;a){ for(int i=0,n=a.size();i&lt;n;i&#43;&#43;)printf(&#34;%d%c&#34;,a[i],i^n-1?&#39; &#39;:&#39;\n&#39;); } inline void clear(poly &amp;a){ int n=a.size(); while(n&gt;1&amp;&amp;!a[n-1])n--; a.resize(n); } inline poly operator &#43;(poly a,const int &amp;b){inc(a[0],b);return a;} inline poly operator &#43;(const int &amp;b,poly a){inc(a[0],b);return a;} inline poly operator -(poly a,const int &amp;b){dec(a[0],b);return a;} inline poly operator -(const int &amp;b,poly a){dec(a[0],b);return a;} inline poly operator &#43;(poly a,const poly &amp;b){ if(a.size()&lt;b.size())a.resize(b.size()); for(int i=0,n=a.size();i&lt;n;i&#43;&#43;)inc(a[i],b[i]); return a; } inline poly operator -(poly a,const poly &amp;b){ if(a.size()&lt;b.size())a.resize(b.size()); for(int i=0,n=a.size();i&lt;n;i&#43;&#43;)dec(a[i],b[i]); return a; } inline void ntt(int *f,int opt,int l){ poly rev(l); for(int i=0;i&lt;l;i&#43;&#43;){rev[i]=(rev[i&gt;&gt;1]&gt;&gt;1)|((i&amp;1)*(l&gt;&gt;1));if(i&lt;rev[i])swap(f[i],f[rev[i]]);} for(int i=1;i&lt;l;i&lt;&lt;=1) for(int j=0;j&lt;l;j&#43;=i&lt;&lt;1) for(int k=0;k&lt;i;k&#43;&#43;){ int x=f[j&#43;k],y=mul(f[i&#43;j&#43;k],w[opt][i&#43;k]); f[j&#43;k]=add(x,y); f[i&#43;j&#43;k]=sub(x,y); } if(opt)for(int i=0,inv=qpow(l,MOD-2);i&lt;l;i&#43;&#43;)pro(f[i],inv); } inline poly operator *(poly a,poly b){ int n=a.size(),m=b.size(),l=1; while(l&lt;n&#43;m)l&lt;&lt;=1; a.resize(l);b.resize(l); ntt(&amp;a[0],0,l);ntt(&amp;b[0],0,l); for(int i=0;i&lt;l;i&#43;&#43;)pro(a[i],b[i]); ntt(&amp;a[0],1,l); clear(a); return a; } inline poly&amp; operator *=(poly &amp;a,const poly b){return a=a*b;} inline poly operator *(poly a,const int &amp;b){ for(int i=0,n=a.size();i&lt;n;i&#43;&#43;)pro(a[i],b); return a; } inline poly inv(const poly &amp;a,const int &amp;n){ if(n==1)return poly(1,qpow(a[0],MOD-2)); int l=1;while(l&lt;=n&lt;&lt;1)l&lt;&lt;=1; poly b=inv(a,n&#43;1&gt;&gt;1),c(l);b.resize(l); for(int i=0;i&lt;n;i&#43;&#43;)c[i]=a[i]; ntt(&amp;b[0],0,l);ntt(&amp;c[0],0,l); for(int i=0;i&lt;l;i&#43;&#43;)pro(b[i],sub(2,mul(b[i],c[i]))); ntt(&amp;b[0],1,l); b.resize(n); clear(b); return b; } inline poly inv(const poly &amp;a){return inv(a,a.size());} int B; #define pii pair&lt;int,int&gt; inline pii operator *(pii a,pii b){ return pii(add(mul(a.first,b.first),mul(mul(a.second,b.second),B)),add(mul(a.first,b.second),mul(a.second,b.first))); } inline pii qpow(pii a,int b){pii c=pii(1,0);for(;b;b&gt;&gt;=1,a=a*a)if(b&amp;1)c=c*a;return c;} inline int remain(int x){ if(x&lt;=1)return x; int a=mul(mul(rand(),rand()),rand()); while(qpow(B=sub(mul(a,a),x),MOD-1&gt;&gt;1)==1)a=mul(mul(rand(),rand()),rand()); pii A=pii(a,1),ans=qpow(A,MOD&#43;1&gt;&gt;1); return min(ans.first,MOD-ans.first); } inline poly sqrt(const poly &amp;a,const int &amp;n){ if(n==1)return poly(1,remain(a[0])); int l=1;while(l&lt;=n&lt;&lt;1)l&lt;&lt;=1; poly b=sqrt(a,n&#43;1&gt;&gt;1),c(l),d; b.resize(n);d=inv(b)*INV2; b.resize(l);d.resize(l); for(int i=0;i&lt;n;i&#43;&#43;)c[i]=a[i]; ntt(&amp;b[0],0,l);ntt(&amp;c[0],0,l);ntt(&amp;d[0],0,l); for(int i=0;i&lt;l;i&#43;&#43;)b[i]=mul(d[i],add(mul(b[i],b[i]),c[i])); ntt(&amp;b[0],1,l); b.resize(n); clear(b); return b; } inline poly sqrt(const poly &amp;a){return sqrt(a,a.size());} inline poly deri(poly a){ int n=a.size(); if(n==1)return poly(1,0); for(int i=0;i&lt;n;i&#43;&#43;)a[i]=mul(a[i&#43;1],i&#43;1); a.resize(n-1); return a; } inline poly inte(poly a){ int n=a.size(); a.resize(n&#43;1); for(int i=n;i;i--)a[i]=mul(a[i-1],qpow(i,MOD-2)); a[0]=0; return a; } inline poly ln(const poly &amp;a){ int n=a.size(); poly c=inv(a)*deri(a); c.resize(n-1); return inte(c); } inline poly exp(const poly &amp;a,const int &amp;n){ if(n==1)return poly(1,1); poly b=exp(a,n&#43;1&gt;&gt;1),c; b.resize(n);c=ln(b); for(int i=0;i&lt;n;i&#43;&#43;)c[i]=sub(a[i],c[i]); inc(c[0]); b*=c; b.resize(n); return b; } inline poly exp(const poly &amp;a){return exp(a,a.size());} inline poly qpow(poly a,const double &amp;b){return exp(ln(a)*b);} poly a; int main(){ srand(19260817); pre(); scanf(&#34;%d%d&#34;,&amp;n,&amp;k); read(a,1&#43;n); a=deri(qpow(1&#43;ln(2&#43;a-a[0]-exp(inte(inv(sqrt(a))))),k)); a.resize(n); out(a); return 0; } 珂朵莉树1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 //以防我忘了set迭代器怎么写 struct node { int l, r; mutable lint v; node(int L, int R = -1, lint V = 0) : l(L), r(R), v(V) {} bool operator &lt; (const node &amp;o) const { return l &lt; o.l; } }; set &lt;node&gt; s; IT spilit (int pos) { IT it = s.lower_bound(node(pos)); if(it != s.end() &amp;&amp; it-&gt;l == pos) return it; it--; int L = it -&gt; l, R = it -&gt; r; lint V = it-&gt;v; s.erase(it); s.insert(node(L, pos-1, V)); return s.insert(node(pos, R, V)).first; } void add(int l, int r, int val) { IT il = spilit(l), ir = spilit(r&#43;1); for(; il != ir; il-&gt;v &#43;= val, il&#43;&#43;); } void tp(int l, int r, int val = 0) { IT il = spilit(l), ir = spilit(r&#43;1); s.erase(il, ir); s.insert(node(l, r, val)); }">
  <meta property="og:locale" content="zh_CN">
  <meta property="og:type" content="article">
    <meta property="article:section" content="posts">
    <meta property="article:published_time" content="2022-03-09T18:26:20+08:00">
    <meta property="article:modified_time" content="2022-03-09T18:26:20+08:00">
    <meta property="og:image" content="https://www.sh1no.icu/avr.png">

  <meta name="twitter:card" content="summary_large_image">
  <meta name="twitter:image" content="https://www.sh1no.icu/avr.png">
  <meta name="twitter:title" content="板子 (ver.诗乃)">
  <meta name="twitter:description" content="Tarjan&amp;Topo1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 void tarjan(int u) { dfn[u] = low[u] = &#43;&#43;tim; ins[u] = 1; stac[&#43;&#43;top] = u; for(int v, i = h[u]; ~i; i = e[i].next) if(!dfn[(v = e[i].to)]) { tarjan(v); low[u] = min(low[u], low[v]); } else if(ins[v]) low[u] = min(low[u], low[v]); if(low[u] == dfn[u]) { int y; while(y = stac[top--]) { sd[y] = u; ins[y] = 0; if(u == y) break; p[u] &#43;= p[y]; } } } void topo() { queue &lt;int&gt; q; for(int i = 1; i &lt;= n; &#43;&#43;i) if(sd[i] == i &amp;&amp; !in[i]) q.push(i), dis[i] = p[i]; while(!q.empty()) { int u = q.front(); q.pop(); for(int v, i = h[u]; ~i; i = e[i].next) { v = e[i].to; dis[v] = max(dis[v], dis[u] &#43; p[v]); --in[v]; if(!in[v]) q.push(v); } } int ans = 0; for(int i = 1; i &lt;= n; &#43;&#43;i) ans = max(ans, dis[i]); printf(&#34;%d\n&#34;, ans); } ST1 2 3 4 5 6 7 8 9 void ST_Build() { for(int j = 1; j &lt;= 21; &#43;&#43;j) for(int i = 1; i &#43; (1 &lt;&lt; j) - 1 &lt;= n; &#43;&#43;i) st[i][j] = max(st[i][j-1], st[i&#43;(1&lt;&lt;(j-1))][j-1]); } int ST_query(int l, int r) { int k = lg2[r-l&#43;1]; return max(st[l][k], st[r-(1&lt;&lt;k)&#43;1][k]); } ST-BlackMagic1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 struct RMQ { #define L(x) ((x-1)*siz&#43;1) #define R(x) std::min(n, x*siz&#43;1) #define bl(x) ((x-1)/siz&#43;1) const int MAXB = 2050, siz = 50; int prf[MAXN], suf[MAXN], n, st[MAXB][13], lg2[MAXN], a[MAXN]; void init(int *s, int _n, int k) { n = _n; for(int i = 1; i &lt;= n; &#43;&#43;i) a[i] = s[i] % k, st[bl(i)][0] = min(st[bl(i)][0], a[i]); for(int i = 1; i &lt;= bl(n); &#43;&#43;i) { prf[L(i)] = a[L(i)]; suf[R(i)] = a[R(i)]; for(int j = L(i)&#43;1; j &lt;= R(i); &#43;&#43;j) prf[j] = min(prf[j-1], a[j]); for(int j = R(i)-1; j &gt;= L(i); --j) suf[j] = min(suf[j&#43;1], a[j]); } for(int j = 1; j &lt;= 12; &#43;&#43;j) for(int i = 1; i &#43; (1 &lt;&lt; j) - 1 &lt;= bl(n); &#43;&#43;i) st[i][j] = min(st[i][j-1], st[i&#43;(1&lt;&lt;(j-1))][j-1]); } int QST(int l, int r) { if(l &gt; r) return 0; int k = lg2[r-l&#43;1]; return min(st[l][k], st[r-(1&lt;&lt;k)&#43;1][k]); } int query(int l, int r) { if(bl(l) == bl(r)) { int res = 0; for(int i = l; i &lt;= r; &#43;&#43;i) res = max(res, a[i]); return res; } else return min(min(prf[r], suf[l]), QST(bl(l)&#43;1, bl(r)-1)); } } ST; Manacher1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 void Manacher() { int mr = 0, mid; for(int i = 0; i &lt; n; &#43;&#43;i) { p[i] = i &lt; mr ? min(p[(mid &lt;&lt; 1) - i], p[mid] &#43; mid - i) : 1; for(; s[i-p[i]] == s[i&#43;p[i]]; &#43;&#43;p[i]); if(p[i] &#43; i &gt; mr) mr = i &#43; p[i], mid = i; } } int main() { scanf(&#34;%s&#34;, a); _n = strlen(a); s[0] = s[1] = &#39;#&#39;; n = 1; for(int i = 0; i &lt; _n; &#43;&#43;i) s[&#43;&#43;n] = a[i], s[&#43;&#43;n] = &#39;#&#39;; s[&#43;&#43;n] = 0; Manacher(); for(int i = 0; i &lt; n; &#43;&#43;i) ans = max(ans, p[i]); printf(&#34;%d\n&#34;, ans-1); } 线性基1 2 3 4 5 6 7 8 9 10 11 for(int i = 1; i &lt;= n; &#43;&#43;i) { read(a); for(int j = 50; j &gt;= 0; --j) { if((a &gt;&gt; j) &amp; 1) { if(!p[j]) {p[j] = a; break;} a ^= p[j]; } } } for(int i = 50; i &gt;= 0; --i) if(p[i]) ans = max(ans, ans ^ p[i]); 线性逆元1 2 3 inv[1] = 1; for(int i = 2; i &lt;= n; &#43;&#43;i) inv[i] = 1ll * (P - P / i) % P * inv[P % i]	% P; 后缀数组1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 void getSA() { for(int i = 1; i &lt;= n; &#43;&#43;i) &#43;&#43;c[x[i] = s[i]]; for(int i = 1; i &lt;= m; &#43;&#43;i) c[i] &#43;= c[i-1]; for(int i = n; i &gt;= 1; --i) sa[c[x[i]]--] = i; for(int k = 1; k &lt;= n; k &lt;&lt;= 1) { int num = 0; for(int i = n - k &#43; 1; i &lt;= n; &#43;&#43;i) y[&#43;&#43;num] = i; for(int i = 1; i &lt;= n; &#43;&#43;i) if(sa[i] &gt; k) y[&#43;&#43;num] = sa[i] - k; memset(c, 0, sizeof c); for(int i = 1; i &lt;= n; &#43;&#43;i) &#43;&#43;c[x[i]]; for(int i = 1; i &lt;= m; &#43;&#43;i) c[i] &#43;= c[i-1]; for(int i = n; i &gt;= 1; --i) sa[c[x[y[i]]]--] = y[i], y[i] = 0; swap(x, y); x[sa[1]] = 1; num = 0; for(int i = 1; i &lt;= n; &#43;&#43;i) x[sa[i]] = (y[sa[i-1]] == y[sa[i]] &amp;&amp; y[sa[i-1]&#43;k] == y[sa[i]&#43;k]) ? num : &#43;&#43;num; if(num == n) break; m = num; } } 点分治1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 void getroot(int u, int p, int S) { siz[u] = 1, f[u] = 0; for(int v, i = h[u]; ~i; i = e[i].next) if((v = e[i].to) != p &amp;&amp; !vis[v]) getroot(v, u, S), siz[u] &#43;= siz[v], f[u] = max(f[u], siz[v]); f[u] = max(f[u], S - siz[u]); rt = f[u] &lt; f[rt] ? u : rt; } void getdis(int u, int p) { stk[&#43;&#43;top] = dis[u]; for(int v, i = h[u]; ~i; i = e[i].next) if((v = e[i].to) != p &amp;&amp; !vis[v]) dis[v] = dis[u] &#43; e[i].w, getdis(v, u); } void solve(int u, int w, int t) { top = 0, dis[u] = w, getdis(u, 0); for(int i = 1; i &lt;= top; &#43;&#43;i) for(int j = 1; j &lt;= top; &#43;&#43;j) if(i != j) ans[stk[i] &#43; stk[j]] &#43;= t; } void devide(int u) { solve(u, 0, 1); vis[u] = 1; for(int v, i = h[u]; ~i; i = e[i].next) if(!vis[(v = e[i].to)]) { solve(v, e[i].w, -1), rt = 0, f[0] = n; getroot(v, u, siz[u]), devide(rt); } } 线段树1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 #define L(u) (u&lt;&lt;1) #define R(u) (u&lt;&lt;1|1) #define mid ((l&#43;r)&gt;&gt;1) void PU(int u) {t[u] = (t[L(u)] &#43; t[R(u)]) % P;} void ADD(int u, int l, int r, int k) { t[u] &#43;= (r - l &#43; 1) * k % P; t[u] %= P; add[u] = (add[u] &#43; k) % P; } void MUL(int u, int l, int r, int k) { t[u] = t[u] * k % P; add[u] = add[u] * k % P; mul[u] = mul[u] * k % P; } void PD(int u, int l, int r) { MUL(L(u), l, mid, mul[u]); MUL(R(u), mid&#43;1, r, mul[u]); mul[u] = 1; ADD(L(u), l, mid, add[u]); ADD(R(u), mid&#43;1, r, add[u]); add[u] = 0; } void build(int u, int l, int r) { mul[u] = 1; if(l == r) {t[u] = a[l]; return;} build(L(u), l, mid); build(R(u), mid&#43;1, r); PU(u); } void MA(int u, int l, int r, int tl, int tr, int k) { if(tr &lt; l || tl &gt; r) return; if(tl &lt;= l &amp;&amp; r &lt;= tr) {ADD(u, l, r, k); return;} PD(u, l, r); MA(L(u), l, mid, tl, tr, k); MA(R(u), mid&#43;1, r, tl, tr, k); PU(u); } void MM(int u, int l, int r, int tl, int tr, int k) { if(tr &lt; l || tl &gt; r) return; if(tl &lt;= l &amp;&amp; r &lt;= tr) {MUL(u, l, r, k); return;} PD(u, l, r); MM(L(u), l, mid, tl, tr, k); MM(R(u), mid&#43;1, r, tl, tr, k); PU(u); } int Q(int u, int l, int r, int tl, int tr) { if(tr &lt; l || tl &gt; r) return 0; if(tl &lt;= l &amp;&amp; r &lt;= tr) return t[u]; PD(u, l, r); return (Q(L(u), l, mid, tl, tr) &#43; Q(R(u), mid&#43;1, r, tl, tr)) % P; } 三分1 2 3 4 5 while(fabs(r-l) &gt;= eps) { double mid = (l &#43; r) / 2; if(f(mid - eps) &lt; f(mid &#43; eps)) l = mid; else r = mid; } 树状数组1 2 void U(int x, int k) {for(; x &lt;= n; t[x] &#43;= k, x &#43;= x&amp;-x);} int Q(int x) {int w = 0; for(; x; w &#43;= t[x], x -= x&amp;-x); return w;} 高斯消元1 2 3 4 5 6 7 8 9 10 11 12 13 for(int i = 1; i &lt;= n; &#43;&#43;i) { int p = i; for(int j = i &#43; 1; j &lt;= n; &#43;&#43;j) if(fabs(a[j][i]) &gt; fabs(a[p][i])) p = j; if(a[p][i] == 0) {puts(&#34;No Solution&#34;); return 0;} for(int j = 1; j &lt;= n&#43;1; &#43;&#43;j) swap(a[i][j], a[p][j]); for(int j = 1; j &lt;= n; &#43;&#43;j) { if(i == j) continue; double t = a[j][i] / a[i][i]; for(int k = i; k &lt;= n&#43;1; &#43;&#43;k) a[j][k] -= a[i][k] * t; } } for(int i = 1; i &lt;= n; &#43;&#43;i) printf(&#34;%.2lf\n&#34;, a[i][n&#43;1] / a[i][i]); 最小生成树&amp;并查集1 2 3 4 5 6 7 8 9 10 11 12 int findfa(int x) {return x == fa[x] ? x : fa[x] = findfa(fa[x]);} int main() { for(int i = 1; i &lt;= n; &#43;&#43;i) fa[i] = i; sort(e&#43;1, e&#43;m&#43;1); for(int i = 1; i &lt;= m; &#43;&#43;i) { int x = findfa(e[i].u), y = findfa(e[i].v); if(x == y) continue; ans &#43;= e[i].w; &#43;&#43;cnt; if(cnt == n-1) break; fa[x] = y; } } DINIC1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 bool bfs() { memset(d, -1, sizeof d); queue &lt;int&gt; q; q.push(s); d[s] = 0; while(!q.empty()) { int u = q.front(); q.pop(); for(int v, i = h[u]; ~i; i = e[i].next) if(d[v = e[i].to] == -1 &amp;&amp; e[i].w &gt; 0) d[v] = d[u] &#43; 1, q.push(v); } return d[t] != -1; } int dfs(int u, int f) { int r = 0; if(u == t) return f; for(int v, i = h[u]; ~i &amp;&amp; r &lt; f; i = e[i].next) if(d[(v = e[i].to)] == d[u] &#43; 1 &amp;&amp; e[i].w &gt; 0) { int x = dfs(v, min(e[i].w, f-r)); e[i].w -= x; e[i^1].w &#43;= x; r &#43;= x; } if(!r) d[u] = -1; return r; } int dinic() { int x, ans = 0; while(bfs()) while(x = dfs(s, 1e9)) ans &#43;= x; return ans; } 线性筛1 2 3 4 5 6 7 for(int i = 2; i &lt;= n; &#43;&#43;i) { if(!notp[i]) p[&#43;&#43;cntp] = i; for(int j = 1; 1ll*i*p[j] &lt;= n &amp;&amp; j &lt;= cntp; &#43;&#43;j) { notp[i*p[j]] = 1; if(i % p[j] == 0) break; } } 左偏树1 2 3 4 5 6 7 8 9 10 11 12 13 14 int F(int x) {return x == fa[x] ? x : fa[x] = F(fa[x]);} int Merge(int x, int y) { if(x*y == 0) return x&#43;y; if(v[x] &gt; v[y] || (v[x] == v[y] &amp;&amp; x &gt; y)) swap(x, y); R(x) = Merge(R(x), y); fa[R(x)] = fa[L(x)] = x; if(dis[R(x)] &gt; dis[L(x)]) swap(L(x), R(x)); dis[x] = dis[R(x)] &#43; 1; return x; } int Top(int x) {return del[x] ? -1 : v[x];} void Pop(int x) { if(del[x]) return; del[x] = 1; fa[L(x)] = L(x); fa[R(x)] = R(x); fa[x] = Merge(L(x), R(x)); } LCT1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 bool nroot(int x) {return ch[fa[x]][0] == x || ch[fa[x]][1] == x;} void pushup(int x) {sumx[x] = sumx[ch[x][1]] ^ sumx[ch[x][0]] ^ val[x];} void pushr(int x) {swap(ch[x][1], ch[x][0]); rot[x] ^= 1;} void pushdown(int x) {if(rot[x]) {if(ch[x][0]) pushr(ch[x][0]); if(ch[x][1]) pushr(ch[x][1]); rot[x] = 0;}} void rotate(int x) { int y = fa[x], z = fa[y], k = (x == ch[y][1]); if(nroot(y)) ch[z][(y == ch[z][1])] = x; fa[x] = z; ch[y][k] = ch[x][k^1]; if(ch[x][k^1]) fa[ch[x][k^1]] = y; ch[x][k^1] = y; fa[y] = x; pushup(y); } void splay(int x) { int y = x, z = 0; st[&#43;&#43;z] = y; while(nroot(y)) st[&#43;&#43;z] = y = fa[y]; while(z) pushdown(st[z--]); for(int y; nroot(x); rotate(x)) if(nroot(y = fa[x])) rotate((y == ch[fa[y]][0]) ^ (x == ch[y][0]) ? x : y); pushup(x); } void access(int x) {for(int y = 0; x; x = fa[y = x]) splay(x), ch[x][1] = y, pushup(x);} void makeroot(int x) {access(x); splay(x); pushr(x);} int findroot(int x) {access(x); splay(x); for(; ch[x][0]; x = ch[x][0]) pushdown(x); splay(x); return x;} void spilit(int x, int y) {makeroot(x); access(y); splay(y);} void link(int x, int y) {makeroot(x); if(findroot(y) != x) fa[x] = y;} void cut(int x, int y) {makeroot(x); if(findroot(y) == x &amp;&amp; fa[y] == x &amp;&amp; !ch[y][0]) {fa[y] = ch[x][1] = 0; pushup(x);}} KMP1 2 3 4 5 6 7 8 9 for(int i = 2, j = 0; i &lt;= n; &#43;&#43;i) { while(j &amp;&amp; s[i] != s[j&#43;1]) j = nxt[j]; if(s[j&#43;1] == s[i]) &#43;&#43;j; nxt[i] = j; } for(int i = 1, j = 0; i &lt;= m; &#43;&#43;i) { while(j &gt; 0 &amp;&amp; t[i] != s[j&#43;1]) j = nxt[j]; if(s[j&#43;1] == t[i]) &#43;&#43;j; if(j == n) printf(&#34;%d\n&#34;, i-n&#43;1); } SAM1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 struct SoumAsuMire { int ch[MAXN][26], fa[MAXN], last, cnt, len[MAXN]; void insert(int c) { int p = last, np = &#43;&#43;cnt; last = np; len[np] = len[p] &#43; 1; for(; p &amp;&amp; !ch[p][c]; ch[p][c] = np, p = fa[p]); if(!p) fa[np] = 1; else { int q = ch[p][c]; if(len[q] == len[p] &#43; 1) fa[np] = q; else { int nq = &#43;&#43;cnt; len[nq] = len[p] &#43; 1; memcpy(ch[nq], ch[q], sizeof ch[q]); fa[nq] = fa[q]; fa[q] = fa[np] = nq; for(; p &amp;&amp; ch[p][c] == q; ch[p][c] = nq, p = fa[p]); } } } void build(char *s) { int n = strlen(s&#43;1); last = 1; for(int i = 1; i &lt;= n; &#43;&#43;i) insert(s[i] - &#39;a&#39;); } int getans() { int ans = 0; for(int i = 2; i &lt;= cnt; &#43;&#43;i) ans &#43;= len[i] - len[fa[i]]; return ans; } } SAM; LCA(ST)1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 void dfsRMQ(int u, int p) { st[&#43;&#43;idx][0] = u; dfn[u] = idx; dep[u] = dep[p] &#43; 1; for(int v, i = h[u]; ~i; i = e[i].next) if((v = e[i].to) != p) dfsRMQ(v, u), st[&#43;&#43;idx][0] = u; } void LCAinit() { for(int i = 2; i &lt;= (n &lt;&lt; 1); &#43;&#43;i) lg2[i] = lg2[i&gt;&gt;1] &#43; 1; dep[1] = 1; dfsRMQ(rt, 0); for(int j = 1; j &lt; 20; &#43;&#43;j) for(int i = 1; i &#43; (1 &lt;&lt; j) &lt;= (n &lt;&lt; 1); &#43;&#43;i) st[i][j] = Min(st[i][j-1], st[i&#43;(1&lt;&lt;(j-1))][j-1]); } int LCA(int x, int y) { x = dfn[x]; y = dfn[y]; if(x &gt; y) swap(x, y); int k = lg2[y-x&#43;1]; return Min(st[x][k], st[y-(1&lt;&lt;k)&#43;1][k]); } mcmf1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 bool SPFA() { memset(d, 63, sizeof d); memset(vis, 0, sizeof vis); memset(flow, 63, sizeof flow); queue &lt;int&gt; q; q.push(s); d[s] = 0; vis[s] = 1; while(!q.empty()) { int u = q.front(); q.pop(); vis[u] = 0; for(int v, i = h[u]; ~i; i = e[i].next) if(d[v = e[i].to] &gt; d[u] &#43; e[i].c &amp;&amp; e[i].f) { d[v] = d[u] &#43; e[i].c; pos[v] = i; fa[v] = u; flow[v] = min(flow[u], e[i].f); if(!vis[v]) vis[v] = 1, q.push(v); } } return flow[s] != flow[t]; } void mcmf() { while(SPFA()) { mc &#43;= flow[t]; mf &#43;= flow[t] * d[t]; for(int u = t; u != s; u = fa[u]) e[pos[u]].f -= flow[t], e[pos[u]^1].f &#43;= flow[t]; } } AC自动机1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 #include &lt;bits/stdc&#43;&#43;.h&gt; using namespace std; const int S = 2000050, T = 200050; struct Edge {int to, next;} e[T]; char s[S]; int n, h[T], cnt, ch[T][26], fail[T], match[T], siz[T], tot = 1, en; queue &lt;int&gt; q; void addedge(int u, int v) {e[en] = (Edge) {v, h[u]}; h[u] = en&#43;&#43;;} void dfs(int u) { for(int v, i = h[u]; ~i; i = e[i].next) dfs(v = e[i].to), siz[u] &#43;= siz[v]; } int main() { scanf(&#34;%d&#34;, &amp;n); memset(h, -1, sizeof h); for(int i = 1; i &lt;= n; &#43;&#43;i) { scanf(&#34;%s&#34;, s); int u = 1, j; for(u = 1, j = 0; s[j]; &#43;&#43;j) { int c = s[j] - &#39;a&#39;; if(!ch[u][c]) ch[u][c] = &#43;&#43;tot; u = ch[u][c]; } match[i] = u; } for(int i = 0; i &lt; 26; &#43;&#43;i) ch[0][i] = 1; q.push(1); while(!q.empty()) { int u = q.front(); q.pop(); for(int i = 0; i &lt; 26; &#43;&#43;i) if(ch[u][i]) { fail[ch[u][i]] = ch[fail[u]][i]; q.push(ch[u][i]); } else ch[u][i] = ch[fail[u]][i]; } scanf(&#34;%s&#34;, s); for(int u = 1, i = 0; s[i]; &#43;&#43;i) &#43;&#43;siz[u = ch[u][s[i]-&#39;a&#39;]]; for(int i = 2; i &lt;= tot; &#43;&#43;i) addedge(fail[i], i); dfs(1); for(int i = 1; i &lt;= n; &#43;&#43;i) printf(&#34;%d\n&#34;, siz[match[i]]); puts(&#34;&#34;); } dijkstra1 2 3 4 5 6 7 8 9 10 11 12 13 void dijkstra() { memset(d, 0x3f, sizeof d); d[s] = 0; q.push((D) {s, 0}); while(!q.empty()) { int u = q.top().u; q.pop(); if(vis[u]) continue; vis[u] = 1; for(int v, i = h[u]; ~i; i = e[i].next) if(d[v = e[i].to] &gt; d[u] &#43; e[i].w) { d[v] = d[u] &#43; e[i].w; if(!vis[v]) q.push((D) {v, d[v]}); } } } 树哈希1 2 3 4 5 6 7 8 ull Hash(int u, int p) { ull q[MAXN], ans = X; int top = 0; for(int i = h[u]; ~i; i = e[i].next) if(e[i].to != p) q[&#43;&#43;top] = Hash(e[i].to, u); sort(q&#43;1, q&#43;top&#43;1); for(int i = 1; i &lt;= top; &#43;&#43;i) ans = ans * P &#43; q[i]; return ans * P &#43; X &#43; 1; } CDQ分治1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 struct BITS { int t[MAXN]; void U(int x, int k) {for(; x &lt;= m; t[x] &#43;= k, x &#43;= x&amp;-x);} int Q(int x) {int res = 0; for(; x; res &#43;= t[x], x -= x&amp;-x); return res;} } T; void cdq(int l, int r) { if(l == r) return; int mid = (l &#43; r) &gt;&gt; 1; cdq(l, mid); cdq(mid&#43;1, r); sort(a&#43;l, a&#43;mid&#43;1, cmpy); sort(a&#43;mid&#43;1, a&#43;r&#43;1, cmpy); int i = mid &#43; 1, j = l; for(; i &lt;= r; &#43;&#43;i) { for(; a[j].y &lt;= a[i].y &amp;&amp; j &lt;= mid; &#43;&#43;j) T.U(a[j].z, a[j].w); a[i].ans &#43;= T.Q(a[i].z); } for(int k = l; k &lt; j; &#43;&#43;k) T.U(a[k].z, -a[k].w); } int main() { read(_n); read(m); for(int i = 1; i &lt;= _n; &#43;&#43;i) read(b[i].x), read(b[i].y), read(b[i].z); sort(b&#43;1, b&#43;_n&#43;1, cmpx); for(int c = 0, i = 1; i &lt;= _n; &#43;&#43;i) { &#43;&#43;c; if(b[i].x != b[i&#43;1].x || b[i].y != b[i&#43;1].y || b[i].z != b[i&#43;1].z) a[&#43;&#43;n] = b[i], a[n].w = c, c = 0; } cdq(1, n); for(int i = 1; i &lt;= n; &#43;&#43;i) cnt[a[i].ans &#43; a[i].w - 1] &#43;= a[i].w; for(int i = 0; i &lt; _n; &#43;&#43;i) printf(&#34;%d\n&#34;, cnt[i]); } Lucas1 2 3 4 5 6 7 8 int C(int n, int m) { if(m &gt; n) return 0; return 1ll * fac[n] * power(fac[m], P-2) * power(fac[n-m], P-2); } int Lucas(int n, int m) { if(m == 0) return 1; return 1ll * C(n%P, m%P) * Lucas(n/P, m/P) % P; } 二分图1 2 3 4 5 6 7 8 9 10 bool dfs(int u) { for(int v, i = h[u]; ~i; i = e[i].next) { if(vis[v = e[i].to] != tag) { vis[v] = tag; if(!match[v] || dfs(match[v])) { match[v] = u; return 1; } } } return 0; } 莫队二次离线1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 #include &lt;bits/stdc&#43;&#43;.h&gt; using namespace std; const int MAXN = 100050; typedef long long lint; void read(int &amp;x) { char ch; while(ch = getchar(), ch &lt; &#39;!&#39;); x = ch - 48; while(ch = getchar(), ch &gt; &#39;!&#39;) x = (x &lt;&lt; 3) &#43; (x &lt;&lt; 1) &#43; ch - 48; } struct Qry {int l, r, id; lint ans;} q[MAXN]; struct T{int l, r, id;}; int n, m, a[MAXN], siz[MAXN], k, blsz, bl[MAXN], t[MAXN], pref[MAXN]; vector &lt;int&gt; buc; vector &lt;T&gt; v[MAXN]; lint ans[MAXN]; int cmp(Qry a, Qry b) {return bl[a.l] == bl[b.l] ? a.r &lt; b.r : a.l &lt; b.l;} int main() { read(n); read(m); read(k); blsz = sqrt(n); if(k &gt; 14) {for(int i = 1; i &lt;= m; &#43;&#43;i) puts(&#34;0&#34;); return 0;} for(int i = 1; i &lt;= n; &#43;&#43;i) read(a[i]); for(int i = 0; i &lt; 16384; &#43;&#43;i) if((siz[i] = siz[(i&gt;&gt;1)] &#43; (i&amp;1)) == k) buc.push_back(i); for(int i = 1; i &lt;= m; &#43;&#43;i) read(q[i].l), read(q[i].r), q[i].id = i; for(int i = 1; i &lt;= n; &#43;&#43;i) bl[i] = (i-1) / blsz &#43; 1; sort(q&#43;1, q&#43;m&#43;1, cmp); for(int i = 1; i &lt;= n; &#43;&#43;i) { for(int j = 0; j &lt; buc.size(); &#43;&#43;j) &#43;&#43;t[a[i]^buc[j]]; pref[i] = t[a[i&#43;1]]; } for(int L = 1, R = 0, i = 1; i &lt;= m; &#43;&#43;i) { int l = q[i].l, r = q[i].r; if(L &lt; l) v[R].push_back((T) {L, l-1, -i}); while(L &lt; l) {q[i].ans &#43;= pref[L-1]; &#43;&#43;L;} if(L &gt; l) v[R].push_back((T) {l, L-1, i}); while(L &gt; l) {q[i].ans -= pref[L-2]; --L;} if(R &lt; r) v[L-1].push_back((T) {R&#43;1, r, -i}); while(R &lt; r) {q[i].ans &#43;= pref[R]; &#43;&#43;R;} if(R &gt; r) v[L-1].push_back((T) {r&#43;1, R, i}); while(R &gt; r) {q[i].ans -= pref[R-1]; --R;} } memset(t, 0, sizeof t); for(int l, r, id, i = 1; i &lt;= n; &#43;&#43;i) { for(int j = 0; j &lt; buc.size(); &#43;&#43;j) &#43;&#43;t[a[i]^buc[j]]; for(int o = 0; o &lt; v[i].size(); &#43;&#43;o) { l = v[i][o].l; r = v[i][o].r; id = v[i][o].id; for(int j = l, tmp = 0; j &lt;= r; &#43;&#43;j) { tmp = t[a[j]]; if(j &lt;= i &amp;&amp; !k) --tmp; if(id &gt; 0) q[id].ans &#43;= tmp; else q[-id].ans -= tmp; } } } for(int i = 1; i &lt;= m; &#43;&#43;i) q[i].ans &#43;= q[i-1].ans; for(int i = 1; i &lt;= m; &#43;&#43;i) ans[q[i].id] = q[i].ans; for(int i = 1; i &lt;= m; &#43;&#43;i) printf(&#34;%lld\n&#34;, ans[i]); } 莫比乌斯反演1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 void GetMu() { mu[1] = 1; for(int i = 2; i &lt;= 10000000; &#43;&#43;i) { if(!vis[i]) p[&#43;&#43;cnt] = i, mu[i] = -1; for(int j = 1; j &lt;= cnt &amp;&amp; p[j] * i &lt;= 10000000; &#43;&#43;j) { vis[p[j]*i] = 1; if(i % p[j]) mu[p[j]*i] = -mu[i]; } } for(int i = 1; i &lt;= cnt; &#43;&#43;i) for(int j = 1; j * p[i] &lt;= 10000000; &#43;&#43;j) f[j*p[i]] &#43;= mu[j]; for(int i = 1; i &lt;= 10000000; &#43;&#43;i) pref[i] = pref[i-1] &#43; f[i]; } lint calc(int a, int b) { lint res = 0; if(a &gt; b) swap(a, b); for(int l = 1, r = 0; l &lt;= a; l = r &#43; 1) { r = min(a/(a/l), b/(b/l)); res &#43;= (pref[r] - pref[l-1])*1ll*(a/l)*(b/l); } return res; } 树剖1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 void ADD(int u, int l, int r, int k) {t[u] = (t[u] &#43; 1ll*k*(r-l&#43;1)%P) % P; tag[u] = (tag[u] &#43; k) % P;} void PD(int u, int l, int r) {ADD(L(u), l, mid, tag[u]); ADD(R(u), mid&#43;1, r, tag[u]); tag[u] = 0;} void PU(int u) {t[u] = (t[L(u)] &#43; t[R(u)]) % P;} void build(int u, int l, int r) { if(l == r) {t[u] = w[id[l]]; return; } build(L(u), l, mid); build(R(u), mid&#43;1, r); PU(u); } void upd(int u, int l, int r, int tl, int tr, int k) { if(tr &lt; l || tl &gt; r) return; if(tl &lt;= l &amp;&amp; r &lt;= tr) ADD(u, l, r, k); else PD(u, l, r), upd(L(u), l, mid, tl, tr, k), upd(R(u), mid&#43;1, r, tl, tr, k), PU(u); } int qry(int u, int l, int r, int tl, int tr) { if(tr &lt; l || tl &gt; r) return 0; if(tl &lt;= l &amp;&amp; r &lt;= tr) return t[u]; PD(u, l, r); return (qry(L(u), l, mid, tl, tr) &#43; qry(R(u), mid&#43;1, r, tl, tr)) % P; } void dfs1(int u, int p) { fa[u] = p; siz[u] = 1; dep[u] = dep[p] &#43; 1; for(int v, i = h[u]; ~i; i = e[i].next) if((v = e[i].to) != p) { dfs1(v, u); siz[u] &#43;= siz[v]; if(siz[son[u]] &lt; siz[v]) son[u] = v; } } void dfs2(int u, int p) { id[dfn[u] = &#43;&#43;idx] = u; top[u] = p; if(son[u]) dfs2(son[u], p); for(int v, i = h[u]; ~i; i = e[i].next) if((v = e[i].to) != fa[u] &amp;&amp; v != son[u]) dfs2(v, v); } void addpath(int x, int y, int k) { for(; top[x] != top[y]; x = fa[top[x]]) { if(dep[top[x]] &lt; dep[top[y]]) swap(x, y); upd(1, 1, n, dfn[top[x]], dfn[x], k); } if(dep[x] &gt; dep[y]) swap(x, y); upd(1, 1, n, dfn[x], dfn[y], k); } int qrypath(int x, int y) { int res = 0; for(; top[x] != top[y]; x = fa[top[x]]) { if(dep[top[x]] &lt; dep[top[y]]) swap(x, y); res = (res &#43; qry(1, 1, n, dfn[top[x]], dfn[x])) % P; } if(dep[x] &gt; dep[y]) swap(x, y); return (res &#43; qry(1, 1, n, dfn[x], dfn[y])) % P; } void addroot(int x, int k) {upd(1, 1, n, dfn[x], dfn[x] &#43; siz[x] - 1, k); } int qryroot(int x) {return qry(1, 1, n, dfn[x], dfn[x] &#43; siz[x] - 1);} 主席树1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 struct JZM_T {int ch[2], v;} t[MAXN &lt;&lt; 6]; int cnt, rt[MAXN &lt;&lt; 6], o[MAXN], a[MAXN], n, m; void build(int &amp;u, int l, int r) { t[u = &#43;&#43;cnt].v = 0; if(l != r) build(L(u), l, mid), build(R(u), mid&#43;1, r); } void update(int &amp;u, int v, int l, int r, int p, int k) { t[u = &#43;&#43;cnt] = t[v]; t[u].v &#43;= k; if(l != r) p &lt;= mid ? update(L(u), L(v), l, mid, p, k) : update(R(u), R(v), mid&#43;1, r, p, k); } int query(int tl, int tr, int l, int r, int k) { if(l == r) return o[l]; int s = t[L(tr)].v - t[L(tl)].v; return k &lt;= s ? query(L(tl), L(tr), l, mid, k) : query(R(tl), R(tr), mid&#43;1, r, k-s); } int main() { read(n); read(m); for(int i = 1; i &lt;= n; &#43;&#43;i) read(a[i]), o[i] = a[i]; sort(o&#43;1, o&#43;n&#43;1); int _n = unique(o&#43;1, o&#43;n&#43;1)-o-1; build(rt[0], 1, _n); for(int i = 1; i &lt;= n; &#43;&#43;i) update(rt[i], rt[i-1], 1, _n, lower_bound(o&#43;1, o&#43;_n&#43;1, a[i])-o, 1); for(int l, r, k; m--; ) { read(l); read(r); read(k); printf(&#34;%d\n&#34;, query(rt[l-1], rt[r], 1, _n, k)); } } GCD-BlackMagic1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 int gcd(int a, int b) { int g = 1; for(int tmp, i = 0; i &lt; 3; b /= tmp, g *= tmp, &#43;&#43;i) tmp = (k[a][i] &gt; siz) ? (b % k[a][i] == 0 ? k[a][i] : 1) : _gcd[k[a][i]][b%k[a][i]]; return g; } int main() { k[1][0] = k[1][1] = k[1][2] = 1; notp[1] = 1; for(int i = 2; i &lt;= V; &#43;&#43;i) { if(!notp[i]) p[&#43;&#43;cnt] = i, k[i][2] = i, k[i][1] = k[i][0] = 1; for(int j = 1; p[j] * i &lt;= V; &#43;&#43;j) { notp[i * p[j]] = 1; int *t = k[i*p[j]]; t[0] = k[i][0] * p[j]; t[1] = k[i][1]; t[2] = k[i][2]; if(t[1] &lt; t[0]) swap(t[0], t[1]); if(t[2] &lt; t[1]) swap(t[1], t[2]); if(i % p[j] == 0) break; } } for(int i = 1; i &lt;= siz; &#43;&#43;i) _gcd[i][0] = _gcd[0][i] = i; for(int _max = 1; _max &lt;= siz; &#43;&#43;_max) for(int i = 1; i &lt;= _max; &#43;&#43;i) _gcd[i][_max] = _gcd[_max][i] = _gcd[_max % i][i]; FFT1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 struct Complex { double x, y; Complex(double xx = 0, double yy = 0) {x = xx; y = yy;} Complex operator &#43; (Complex &amp;b) const {return Complex(x&#43;b.x, y&#43;b.y);} Complex operator - (Complex &amp;b) const {return Complex(x-b.x, y-b.y);} Complex operator * (Complex &amp;b) const {return Complex(x*b.x-y*b.y, y*b.x&#43;x*b.y);} } a[MAXN], b[MAXN]; int r[MAXN], n, m, l, limit; void FFT (Complex *A, int t) { for(int i = 0; i &lt; limit; &#43;&#43;i) if(i &lt; r[i]) swap(A[i], A[r[i]]); for(int mid = 1; mid &lt; limit; mid &lt;&lt;= 1) { Complex Wn = Complex(cos(Pi/mid), t * sin(Pi/mid)); for(int R = mid&lt;&lt;1, j = 0; j &lt; limit; j &#43;= R) { Complex w = Complex(1, 0); for(int k = 0; k &lt; mid; &#43;&#43;k, w = w * Wn) { Complex x = A[j&#43;k], y = w*A[j&#43;mid&#43;k]; A[j&#43;k] = x&#43;y; A[j&#43;mid&#43;k] = x-y; } } } } int main() { n = read(); m = read(); for(int i = 0; i &lt;= n; &#43;&#43;i) a[i].x = read(); for(int i = 0; i &lt;= m; &#43;&#43;i) b[i].x = read(); for(limit = 1; limit &lt;= n&#43;m; limit &lt;&lt;= 1, &#43;&#43;l); for(int i = 0; i &lt; limit; &#43;&#43;i) r[i] = (r[i&gt;&gt;1]&gt;&gt;1)|((i&amp;1)&lt;&lt;(l-1)); FFT(a, 1); FFT(b, 1); for(int i = 0; i &lt;= limit; &#43;&#43;i) a[i] = a[i]*b[i]; FFT(a, -1); for(int i = 0; i &lt;= n&#43;m; &#43;&#43;i) printf(&#34;%d &#34;, (int)(a[i].x/limit&#43;0.5)); puts(&#34;&#34;); } 多项式1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102 103 104 105 106 107 108 109 110 111 112 113 114 115 116 117 118 119 120 121 122 123 124 125 126 127 128 129 130 131 132 133 134 135 136 137 138 139 140 141 142 143 144 145 146 147 148 149 150 151 152 153 154 155 156 157 158 159 160 161 162 163 164 165 166 167 168 169 170 171 172 173 174 175 176 177 178 179 180 181 182 183 184 185 186 187 #include&lt;bits/stdc&#43;&#43;.h&gt; #define ll long long #define FIO &#34;loj150&#34; using namespace std; const int N=1e5&#43;5,MOD=998244353,P=19,INV2=MOD&#43;1&gt;&gt;1; inline int add(int a,const int &amp;b){if((a&#43;=b)&gt;=MOD)a-=MOD;return a;} inline int sub(int a,const int &amp;b){if((a-=b)&lt;	0)a&#43;=MOD;return a;} inline int mul(const int &amp;a,const int &amp;b){return 1ll*a*b%MOD;} inline void inc(int &amp;a,const int &amp;b=1){a=add(a,b);} inline void dec(int &amp;a,const int &amp;b=1){a=sub(a,b);} inline void pro(int &amp;a,const int &amp;b){a=mul(a,b);} inline int qpow(int a,int b){int c=1;for(;b;b&gt;&gt;=1,pro(a,a))if(b&amp;1)pro(c,a);return c;} int n,k,w[2][1&lt;&lt;P]; inline void pre(){ for(int i=1;i&lt;1&lt;&lt;P;i&lt;&lt;=1){ w[0][i]=w[1][i]=1; int wn1=qpow(3,(MOD-1)/(i&lt;&lt;1)),wn0=qpow(wn1,MOD-2); for(int j=1;j&lt;i;j&#43;&#43;) w[0][i&#43;j]=mul(w[0][i&#43;j-1],wn0),w[1][i&#43;j]=mul(w[1][i&#43;j-1],wn1); } } #define poly vector&lt;int&gt; inline void read(poly &amp;a,const int &amp;n){ a.resize(n); for(int i=0;i&lt;n;i&#43;&#43;)scanf(&#34;%d&#34;,&amp;a[i]); } inline void out(const poly &amp;a){ for(int i=0,n=a.size();i&lt;n;i&#43;&#43;)printf(&#34;%d%c&#34;,a[i],i^n-1?&#39; &#39;:&#39;\n&#39;); } inline void clear(poly &amp;a){ int n=a.size(); while(n&gt;1&amp;&amp;!a[n-1])n--; a.resize(n); } inline poly operator &#43;(poly a,const int &amp;b){inc(a[0],b);return a;} inline poly operator &#43;(const int &amp;b,poly a){inc(a[0],b);return a;} inline poly operator -(poly a,const int &amp;b){dec(a[0],b);return a;} inline poly operator -(const int &amp;b,poly a){dec(a[0],b);return a;} inline poly operator &#43;(poly a,const poly &amp;b){ if(a.size()&lt;b.size())a.resize(b.size()); for(int i=0,n=a.size();i&lt;n;i&#43;&#43;)inc(a[i],b[i]); return a; } inline poly operator -(poly a,const poly &amp;b){ if(a.size()&lt;b.size())a.resize(b.size()); for(int i=0,n=a.size();i&lt;n;i&#43;&#43;)dec(a[i],b[i]); return a; } inline void ntt(int *f,int opt,int l){ poly rev(l); for(int i=0;i&lt;l;i&#43;&#43;){rev[i]=(rev[i&gt;&gt;1]&gt;&gt;1)|((i&amp;1)*(l&gt;&gt;1));if(i&lt;rev[i])swap(f[i],f[rev[i]]);} for(int i=1;i&lt;l;i&lt;&lt;=1) for(int j=0;j&lt;l;j&#43;=i&lt;&lt;1) for(int k=0;k&lt;i;k&#43;&#43;){ int x=f[j&#43;k],y=mul(f[i&#43;j&#43;k],w[opt][i&#43;k]); f[j&#43;k]=add(x,y); f[i&#43;j&#43;k]=sub(x,y); } if(opt)for(int i=0,inv=qpow(l,MOD-2);i&lt;l;i&#43;&#43;)pro(f[i],inv); } inline poly operator *(poly a,poly b){ int n=a.size(),m=b.size(),l=1; while(l&lt;n&#43;m)l&lt;&lt;=1; a.resize(l);b.resize(l); ntt(&amp;a[0],0,l);ntt(&amp;b[0],0,l); for(int i=0;i&lt;l;i&#43;&#43;)pro(a[i],b[i]); ntt(&amp;a[0],1,l); clear(a); return a; } inline poly&amp; operator *=(poly &amp;a,const poly b){return a=a*b;} inline poly operator *(poly a,const int &amp;b){ for(int i=0,n=a.size();i&lt;n;i&#43;&#43;)pro(a[i],b); return a; } inline poly inv(const poly &amp;a,const int &amp;n){ if(n==1)return poly(1,qpow(a[0],MOD-2)); int l=1;while(l&lt;=n&lt;&lt;1)l&lt;&lt;=1; poly b=inv(a,n&#43;1&gt;&gt;1),c(l);b.resize(l); for(int i=0;i&lt;n;i&#43;&#43;)c[i]=a[i]; ntt(&amp;b[0],0,l);ntt(&amp;c[0],0,l); for(int i=0;i&lt;l;i&#43;&#43;)pro(b[i],sub(2,mul(b[i],c[i]))); ntt(&amp;b[0],1,l); b.resize(n); clear(b); return b; } inline poly inv(const poly &amp;a){return inv(a,a.size());} int B; #define pii pair&lt;int,int&gt; inline pii operator *(pii a,pii b){ return pii(add(mul(a.first,b.first),mul(mul(a.second,b.second),B)),add(mul(a.first,b.second),mul(a.second,b.first))); } inline pii qpow(pii a,int b){pii c=pii(1,0);for(;b;b&gt;&gt;=1,a=a*a)if(b&amp;1)c=c*a;return c;} inline int remain(int x){ if(x&lt;=1)return x; int a=mul(mul(rand(),rand()),rand()); while(qpow(B=sub(mul(a,a),x),MOD-1&gt;&gt;1)==1)a=mul(mul(rand(),rand()),rand()); pii A=pii(a,1),ans=qpow(A,MOD&#43;1&gt;&gt;1); return min(ans.first,MOD-ans.first); } inline poly sqrt(const poly &amp;a,const int &amp;n){ if(n==1)return poly(1,remain(a[0])); int l=1;while(l&lt;=n&lt;&lt;1)l&lt;&lt;=1; poly b=sqrt(a,n&#43;1&gt;&gt;1),c(l),d; b.resize(n);d=inv(b)*INV2; b.resize(l);d.resize(l); for(int i=0;i&lt;n;i&#43;&#43;)c[i]=a[i]; ntt(&amp;b[0],0,l);ntt(&amp;c[0],0,l);ntt(&amp;d[0],0,l); for(int i=0;i&lt;l;i&#43;&#43;)b[i]=mul(d[i],add(mul(b[i],b[i]),c[i])); ntt(&amp;b[0],1,l); b.resize(n); clear(b); return b; } inline poly sqrt(const poly &amp;a){return sqrt(a,a.size());} inline poly deri(poly a){ int n=a.size(); if(n==1)return poly(1,0); for(int i=0;i&lt;n;i&#43;&#43;)a[i]=mul(a[i&#43;1],i&#43;1); a.resize(n-1); return a; } inline poly inte(poly a){ int n=a.size(); a.resize(n&#43;1); for(int i=n;i;i--)a[i]=mul(a[i-1],qpow(i,MOD-2)); a[0]=0; return a; } inline poly ln(const poly &amp;a){ int n=a.size(); poly c=inv(a)*deri(a); c.resize(n-1); return inte(c); } inline poly exp(const poly &amp;a,const int &amp;n){ if(n==1)return poly(1,1); poly b=exp(a,n&#43;1&gt;&gt;1),c; b.resize(n);c=ln(b); for(int i=0;i&lt;n;i&#43;&#43;)c[i]=sub(a[i],c[i]); inc(c[0]); b*=c; b.resize(n); return b; } inline poly exp(const poly &amp;a){return exp(a,a.size());} inline poly qpow(poly a,const double &amp;b){return exp(ln(a)*b);} poly a; int main(){ srand(19260817); pre(); scanf(&#34;%d%d&#34;,&amp;n,&amp;k); read(a,1&#43;n); a=deri(qpow(1&#43;ln(2&#43;a-a[0]-exp(inte(inv(sqrt(a))))),k)); a.resize(n); out(a); return 0; } 珂朵莉树1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 //以防我忘了set迭代器怎么写 struct node { int l, r; mutable lint v; node(int L, int R = -1, lint V = 0) : l(L), r(R), v(V) {} bool operator &lt; (const node &amp;o) const { return l &lt; o.l; } }; set &lt;node&gt; s; IT spilit (int pos) { IT it = s.lower_bound(node(pos)); if(it != s.end() &amp;&amp; it-&gt;l == pos) return it; it--; int L = it -&gt; l, R = it -&gt; r; lint V = it-&gt;v; s.erase(it); s.insert(node(L, pos-1, V)); return s.insert(node(pos, R, V)).first; } void add(int l, int r, int val) { IT il = spilit(l), ir = spilit(r&#43;1); for(; il != ir; il-&gt;v &#43;= val, il&#43;&#43;); } void tp(int l, int r, int val = 0) { IT il = spilit(l), ir = spilit(r&#43;1); s.erase(il, ir); s.insert(node(l, r, val)); }">
      <meta name="twitter:site" content="@ShinoLeah">
<meta name="twitter:creator" content="@ShinoLeah" /><meta name="application-name" content="Shino Channel">
<meta name="apple-mobile-web-app-title" content="Shino Channel"><meta name="theme-color" data-light="#f8f8f8" data-dark="#252627" content="#f8f8f8"><meta name="msapplication-TileColor" content="#da532c"><link rel="shortcut icon" type="image/x-icon" href="/favicon.ico" />
    <link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png"><link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png"><link rel="mask-icon" href="/safari-pinned-tab.svg" color="#5bbad5"><link rel="manifest" href="/site.webmanifest"><link rel="canonical" type="text/html" href="https://www.sh1no.icu/posts/templates/" title="板子 (ver.诗乃) - Shino Channel" /><link rel="prev" type="text/html" href="https://www.sh1no.icu/posts/d3ctf2022/" title="D3CTF2022wp-BadW3ter &amp; d3bug" /><link rel="next" type="text/html" href="https://www.sh1no.icu/posts/go-auth/" title="使用Go&#43;Gin&#43;Redis实现一个简单的登录注册系统" /><link rel="alternate" type="text/markdown" href="https://www.sh1no.icu/posts/templates/index.md" title="板子 (ver.诗乃) - Shino Channel"><link rel="stylesheet" href="/css/style.min.css"><link rel="preload" href="/lib/fontawesome-free/all.min.css" as="style" onload="this.removeAttribute('onload');this.rel='stylesheet'">
    <noscript><link rel="stylesheet" href="/lib/fontawesome-free/all.min.css"></noscript><link rel="preload" href="/lib/animate/animate.min.css" as="style" onload="this.removeAttribute('onload');this.rel='stylesheet'">
    <noscript><link rel="stylesheet" href="/lib/animate/animate.min.css"></noscript><script type="application/ld+json">
  {
    "@context": "http://schema.org",
    "@type": "BlogPosting",
    "headline": "板子 (ver.诗乃)",
    "inLanguage": "zh-CN",
    "mainEntityOfPage": {
      "@type": "WebPage",
      "@id": "https:\/\/www.sh1no.icu\/posts\/templates\/"
    },"genre": "posts","wordcount":  5759 ,
    "url": "https:\/\/www.sh1no.icu\/posts\/templates\/","datePublished": "2022-03-09T18:26:20+08:00","dateModified": "2022-03-09T18:26:20+08:00","publisher": {
      "@type": "Organization",
      "name": ""},"author": {
        "@type": "Person",
        "name": "Shino"
      },"description": ""
  }
  </script><script src="/js/head/color-scheme.min.js"></script></head>
  <body data-header-desktop="sticky" data-header-mobile="auto"><div class="wrapper" data-page-style="normal"><header class="desktop animate__faster" id="header-desktop">
  <div class="header-wrapper">
    <div class="header-title">
      <a href="/" title="Shino Channel"><span class="header-title-text">Shino</span></a><span class="header-subtitle"></span></div>
    <nav>
      <ul class="menu"><li class="menu-item">
              <a class="menu-link" href="https://www.youtube.com/@anoofficialchannel" rel="noopener noreferrer" target="_blank"></a></li><li class="menu-item">
              <a class="menu-link" href="https://www.nu1l.com/" title="Nu1L" rel="noopener noreferrer" target="_blank"><i class="fa-solid fa-paperclip fa-fw fa-sm" aria-hidden="true"></i> Nu1L</a></li><li class="menu-item">
              <a class="menu-link" href="https://cnss.io/" title="CNSS" rel="noopener noreferrer" target="_blank"><i class="fa-solid fa-paperclip fa-fw fa-sm" aria-hidden="true"></i> CNSS</a></li><li class="menu-item">
              <a class="menu-link" href="/posts/friends/" title="About"><i class="fa-solid fa-user-group fa-fw fa-sm" aria-hidden="true"></i> About</a></li><li class="menu-item delimiter"></li><li class="menu-item search" id="search-desktop">
            <input type="text" placeholder="Search..." id="search-input-desktop">
            <a href="javascript:void(0);" class="search-button search-toggle" id="search-toggle-desktop" title="Search">
              <i class="fa-solid fa-search fa-fw" aria-hidden="true"></i>
            </a>
            <a href="javascript:void(0);" class="search-button search-clear" id="search-clear-desktop" title="Clear">
              <i class="fa-solid fa-times-circle fa-fw" aria-hidden="true"></i>
            </a>
            <span class="search-button search-loading" id="search-loading-desktop">
              <i class="fa-solid fa-spinner fa-fw fa-spin" aria-hidden="true"></i>
            </span>
          </li><li class="menu-item theme-switch" title="Switch Theme">
          <i class="fa-solid fa-adjust fa-fw" aria-hidden="true"></i>
        </li></ul>
    </nav>
  </div>
</header><header class="mobile animate__faster" id="header-mobile">
  <div class="header-container">
    <div class="header-wrapper">
      <div class="header-title">
        <a href="/" title="Shino Channel"><span class="header-title-text">Shino</span></a><span class="header-subtitle"></span></div>
      <div class="menu-toggle" id="menu-toggle-mobile">
        <span></span><span></span><span></span>
      </div>
    </div>
    <nav>
      <ul class="menu" id="menu-mobile"><li class="search-wrapper">
            <div class="search mobile" id="search-mobile">
              <input type="text" placeholder="Search..." id="search-input-mobile">
              <a href="javascript:void(0);" class="search-button search-toggle" id="search-toggle-mobile" title="Search">
                <i class="fa-solid fa-search fa-fw" aria-hidden="true"></i>
              </a>
              <a href="javascript:void(0);" class="search-button search-clear" id="search-clear-mobile" title="Clear">
                <i class="fa-solid fa-times-circle fa-fw" aria-hidden="true"></i>
              </a>
              <span class="search-button search-loading" id="search-loading-mobile">
                <i class="fa-solid fa-spinner fa-fw fa-spin" aria-hidden="true"></i>
              </span>
            </div>
            <a href="javascript:void(0);" class="search-cancel" id="search-cancel-mobile">
              Cancel
            </a>
          </li><li class="menu-item"><a class="menu-link" href="https://www.youtube.com/@anoofficialchannel" rel="noopener noreferrer" target="_blank"></a></li><li class="menu-item"><a class="menu-link" href="https://www.nu1l.com/" title="Nu1L" rel="noopener noreferrer" target="_blank"><i class="fa-solid fa-paperclip fa-fw fa-sm" aria-hidden="true"></i> Nu1L</a></li><li class="menu-item"><a class="menu-link" href="https://cnss.io/" title="CNSS" rel="noopener noreferrer" target="_blank"><i class="fa-solid fa-paperclip fa-fw fa-sm" aria-hidden="true"></i> CNSS</a></li><li class="menu-item"><a class="menu-link" href="/posts/friends/" title="About"><i class="fa-solid fa-user-group fa-fw fa-sm" aria-hidden="true"></i> About</a></li><li class="menu-item menu-system">
          <span class="menu-system-item theme-switch" title="Switch Theme"><i class="fa-solid fa-adjust fa-fw" aria-hidden="true"></i></span></li>
      </ul>
    </nav>
  </div>
</header><div class="search-dropdown desktop">
    <div id="search-dropdown-desktop"></div>
  </div>
  <div class="search-dropdown mobile">
    <div id="search-dropdown-mobile"></div>
  </div><main class="container"><aside class="aside-collection animate__animated animate__fadeIn animate__faster" aria-label="Collections"></aside>

  <article class="page single">
    <div class="header"><h1 class="single-title animate__animated animate__flipInX"><span>板子 (Ver.诗乃)</span>
      </h1></div><div class="post-meta">
      <div class="post-meta-line"><span class="post-author"><span class="author"><img loading="lazy" src="/avr.png" alt="Shino" data-title="Shino" width="20" height="20" class="avatar" style="background: url(/images/loading.min.svg) no-repeat center;" onload="this.title=this.dataset.title;for(const i of ['style', 'data-title','onerror','onload']){this.removeAttribute(i);}this.dataset.lazyloaded='';" onerror="this.title=this.dataset.title;for(const i of ['style', 'data-title','onerror','onload']){this.removeAttribute(i);}"/>&nbsp;Shino</span></span></div><div class="post-meta-line"><span title="published on 2022-03-09 18:26:20"><i class="fa-solid fa-calendar-days fa-fw me-1" aria-hidden="true"></i><time datetime="2022-03-09">2022-03-09</time></span>&nbsp;<span title="5759 words"><i class="fa-solid fa-pencil-alt fa-fw me-1" aria-hidden="true"></i>About 5800 words</span>&nbsp;<span><i class="fa-regular fa-clock fa-fw me-1" aria-hidden="true"></i>28 minutes</span>&nbsp;</div>
    </div><div class="details toc" id="toc-static" data-kept="false">
        <div class="details-summary toc-title">
          <span>Contents</span>
          <span><i class="details-icon fa-solid fa-angle-right" aria-hidden="true"></i></span>
        </div>
        <div class="details-content toc-content" id="toc-content-static"><nav id="TableOfContents">
  <ul>
    <li><a href="#tarjantopo">Tarjan&amp;Topo</a></li>
    <li><a href="#st">ST</a></li>
    <li><a href="#st-blackmagic">ST-BlackMagic</a></li>
    <li><a href="#manacher">Manacher</a></li>
    <li><a href="#线性基">线性基</a></li>
    <li><a href="#线性逆元">线性逆元</a></li>
    <li><a href="#后缀数组">后缀数组</a></li>
    <li><a href="#点分治">点分治</a></li>
    <li><a href="#线段树">线段树</a></li>
    <li><a href="#三分">三分</a></li>
    <li><a href="#树状数组">树状数组</a></li>
    <li><a href="#高斯消元">高斯消元</a></li>
    <li><a href="#最小生成树并查集">最小生成树&amp;并查集</a></li>
    <li><a href="#dinic">DINIC</a></li>
    <li><a href="#线性筛">线性筛</a></li>
    <li><a href="#左偏树">左偏树</a></li>
    <li><a href="#lct">LCT</a></li>
    <li><a href="#kmp">KMP</a></li>
    <li><a href="#sam">SAM</a></li>
    <li><a href="#lcast">LCA(ST)</a></li>
    <li><a href="#mcmf">mcmf</a></li>
    <li><a href="#ac自动机">AC自动机</a></li>
    <li><a href="#dijkstra">dijkstra</a></li>
    <li><a href="#树哈希">树哈希</a></li>
    <li><a href="#cdq分治">CDQ分治</a></li>
    <li><a href="#lucas">Lucas</a></li>
    <li><a href="#二分图">二分图</a></li>
    <li><a href="#莫队二次离线">莫队二次离线</a></li>
    <li><a href="#莫比乌斯反演">莫比乌斯反演</a></li>
    <li><a href="#树剖">树剖</a></li>
    <li><a href="#主席树">主席树</a></li>
    <li><a href="#gcd-blackmagic">GCD-BlackMagic</a></li>
    <li><a href="#fft">FFT</a></li>
    <li><a href="#多项式">多项式</a></li>
    <li><a href="#珂朵莉树">珂朵莉树</a></li>
  </ul>
</nav></div>
      </div><div class="content" id="content"><h2 id="tarjantopo" class="heading-element"><span>Tarjan&amp;Topo</span>
  <a href="#tarjantopo" class="heading-mark">
    <svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg>
  </a>
</h2><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-C++" data-lang="C++"><span class="line"><span class="cl"><span class="kt">void</span> <span class="nf">tarjan</span><span class="p">(</span><span class="kt">int</span> <span class="n">u</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">	<span class="n">dfn</span><span class="p">[</span><span class="n">u</span><span class="p">]</span> <span class="o">=</span> <span class="n">low</span><span class="p">[</span><span class="n">u</span><span class="p">]</span> <span class="o">=</span> <span class="o">++</span><span class="n">tim</span><span class="p">;</span> <span class="n">ins</span><span class="p">[</span><span class="n">u</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span> <span class="n">stac</span><span class="p">[</span><span class="o">++</span><span class="n">top</span><span class="p">]</span> <span class="o">=</span> <span class="n">u</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">	<span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">v</span><span class="p">,</span> <span class="n">i</span> <span class="o">=</span> <span class="n">h</span><span class="p">[</span><span class="n">u</span><span class="p">];</span> <span class="o">~</span><span class="n">i</span><span class="p">;</span> <span class="n">i</span> <span class="o">=</span> <span class="n">e</span><span class="p">[</span><span class="n">i</span><span class="p">].</span><span class="n">next</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">		<span class="k">if</span><span class="p">(</span><span class="o">!</span><span class="n">dfn</span><span class="p">[(</span><span class="n">v</span> <span class="o">=</span> <span class="n">e</span><span class="p">[</span><span class="n">i</span><span class="p">].</span><span class="n">to</span><span class="p">)])</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">			<span class="n">tarjan</span><span class="p">(</span><span class="n">v</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">			<span class="n">low</span><span class="p">[</span><span class="n">u</span><span class="p">]</span> <span class="o">=</span> <span class="n">min</span><span class="p">(</span><span class="n">low</span><span class="p">[</span><span class="n">u</span><span class="p">],</span> <span class="n">low</span><span class="p">[</span><span class="n">v</span><span class="p">]);</span>
</span></span><span class="line"><span class="cl">		<span class="p">}</span> <span class="k">else</span> <span class="k">if</span><span class="p">(</span><span class="n">ins</span><span class="p">[</span><span class="n">v</span><span class="p">])</span> <span class="n">low</span><span class="p">[</span><span class="n">u</span><span class="p">]</span> <span class="o">=</span> <span class="n">min</span><span class="p">(</span><span class="n">low</span><span class="p">[</span><span class="n">u</span><span class="p">],</span> <span class="n">low</span><span class="p">[</span><span class="n">v</span><span class="p">]);</span>
</span></span><span class="line"><span class="cl">	<span class="k">if</span><span class="p">(</span><span class="n">low</span><span class="p">[</span><span class="n">u</span><span class="p">]</span> <span class="o">==</span> <span class="n">dfn</span><span class="p">[</span><span class="n">u</span><span class="p">])</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">		<span class="kt">int</span> <span class="n">y</span><span class="p">;</span> <span class="k">while</span><span class="p">(</span><span class="n">y</span> <span class="o">=</span> <span class="n">stac</span><span class="p">[</span><span class="n">top</span><span class="o">--</span><span class="p">])</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="n">sd</span><span class="p">[</span><span class="n">y</span><span class="p">]</span> <span class="o">=</span> <span class="n">u</span><span class="p">;</span> <span class="n">ins</span><span class="p">[</span><span class="n">y</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="k">if</span><span class="p">(</span><span class="n">u</span> <span class="o">==</span> <span class="n">y</span><span class="p">)</span> <span class="k">break</span><span class="p">;</span> <span class="n">p</span><span class="p">[</span><span class="n">u</span><span class="p">]</span> <span class="o">+=</span> <span class="n">p</span><span class="p">[</span><span class="n">y</span><span class="p">];</span>
</span></span><span class="line"><span class="cl">        <span class="p">}</span>
</span></span><span class="line"><span class="cl">	<span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="kt">void</span> <span class="nf">topo</span><span class="p">()</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">	<span class="n">queue</span> <span class="o">&lt;</span><span class="kt">int</span><span class="o">&gt;</span> <span class="n">q</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">	<span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;=</span> <span class="n">n</span><span class="p">;</span> <span class="o">++</span><span class="n">i</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">		<span class="k">if</span><span class="p">(</span><span class="n">sd</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">==</span> <span class="n">i</span> <span class="o">&amp;&amp;</span> <span class="o">!</span><span class="n">in</span><span class="p">[</span><span class="n">i</span><span class="p">])</span> <span class="n">q</span><span class="p">.</span><span class="n">push</span><span class="p">(</span><span class="n">i</span><span class="p">),</span> <span class="n">dis</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">p</span><span class="p">[</span><span class="n">i</span><span class="p">];</span>
</span></span><span class="line"><span class="cl">	<span class="k">while</span><span class="p">(</span><span class="o">!</span><span class="n">q</span><span class="p">.</span><span class="n">empty</span><span class="p">())</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">		<span class="kt">int</span> <span class="n">u</span> <span class="o">=</span> <span class="n">q</span><span class="p">.</span><span class="n">front</span><span class="p">();</span> <span class="n">q</span><span class="p">.</span><span class="n">pop</span><span class="p">();</span>
</span></span><span class="line"><span class="cl">		<span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">v</span><span class="p">,</span> <span class="n">i</span> <span class="o">=</span> <span class="n">h</span><span class="p">[</span><span class="n">u</span><span class="p">];</span> <span class="o">~</span><span class="n">i</span><span class="p">;</span> <span class="n">i</span> <span class="o">=</span> <span class="n">e</span><span class="p">[</span><span class="n">i</span><span class="p">].</span><span class="n">next</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">				<span class="n">v</span> <span class="o">=</span> <span class="n">e</span><span class="p">[</span><span class="n">i</span><span class="p">].</span><span class="n">to</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">				<span class="n">dis</span><span class="p">[</span><span class="n">v</span><span class="p">]</span> <span class="o">=</span> <span class="n">max</span><span class="p">(</span><span class="n">dis</span><span class="p">[</span><span class="n">v</span><span class="p">],</span> <span class="n">dis</span><span class="p">[</span><span class="n">u</span><span class="p">]</span> <span class="o">+</span> <span class="n">p</span><span class="p">[</span><span class="n">v</span><span class="p">]);</span>
</span></span><span class="line"><span class="cl">				<span class="o">--</span><span class="n">in</span><span class="p">[</span><span class="n">v</span><span class="p">];</span> <span class="k">if</span><span class="p">(</span><span class="o">!</span><span class="n">in</span><span class="p">[</span><span class="n">v</span><span class="p">])</span> <span class="n">q</span><span class="p">.</span><span class="n">push</span><span class="p">(</span><span class="n">v</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">			<span class="p">}</span>
</span></span><span class="line"><span class="cl">	<span class="p">}</span>
</span></span><span class="line"><span class="cl">	<span class="kt">int</span> <span class="n">ans</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">	<span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;=</span> <span class="n">n</span><span class="p">;</span> <span class="o">++</span><span class="n">i</span><span class="p">)</span> <span class="n">ans</span> <span class="o">=</span> <span class="n">max</span><span class="p">(</span><span class="n">ans</span><span class="p">,</span> <span class="n">dis</span><span class="p">[</span><span class="n">i</span><span class="p">]);</span>
</span></span><span class="line"><span class="cl">	<span class="n">printf</span><span class="p">(</span><span class="s">&#34;%d</span><span class="se">\n</span><span class="s">&#34;</span><span class="p">,</span> <span class="n">ans</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span></span></span></code></pre></td></tr></table>
</div>
</div><h2 id="st" class="heading-element"><span>ST</span>
  <a href="#st" class="heading-mark">
    <svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg>
  </a>
</h2><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span><span class="lnt">8
</span><span class="lnt">9
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-C++" data-lang="C++"><span class="line"><span class="cl"><span class="kt">void</span> <span class="nf">ST_Build</span><span class="p">()</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">	<span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">j</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span> <span class="n">j</span> <span class="o">&lt;=</span> <span class="mi">21</span><span class="p">;</span> <span class="o">++</span><span class="n">j</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">		<span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span> <span class="n">i</span> <span class="o">+</span> <span class="p">(</span><span class="mi">1</span> <span class="o">&lt;&lt;</span> <span class="n">j</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span> <span class="o">&lt;=</span> <span class="n">n</span><span class="p">;</span> <span class="o">++</span><span class="n">i</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">			<span class="n">st</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="n">max</span><span class="p">(</span><span class="n">st</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="n">st</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="p">(</span><span class="mi">1</span><span class="o">&lt;&lt;</span><span class="p">(</span><span class="n">j</span><span class="o">-</span><span class="mi">1</span><span class="p">))][</span><span class="n">j</span><span class="o">-</span><span class="mi">1</span><span class="p">]);</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="kt">int</span> <span class="nf">ST_query</span><span class="p">(</span><span class="kt">int</span> <span class="n">l</span><span class="p">,</span> <span class="kt">int</span> <span class="n">r</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">	<span class="kt">int</span> <span class="n">k</span> <span class="o">=</span> <span class="n">lg2</span><span class="p">[</span><span class="n">r</span><span class="o">-</span><span class="n">l</span><span class="o">+</span><span class="mi">1</span><span class="p">];</span>
</span></span><span class="line"><span class="cl">	<span class="k">return</span> <span class="n">max</span><span class="p">(</span><span class="n">st</span><span class="p">[</span><span class="n">l</span><span class="p">][</span><span class="n">k</span><span class="p">],</span> <span class="n">st</span><span class="p">[</span><span class="n">r</span><span class="o">-</span><span class="p">(</span><span class="mi">1</span><span class="o">&lt;&lt;</span><span class="n">k</span><span class="p">)</span><span class="o">+</span><span class="mi">1</span><span class="p">][</span><span class="n">k</span><span class="p">]);</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span></span></span></code></pre></td></tr></table>
</div>
</div><h2 id="st-blackmagic" class="heading-element"><span>ST-BlackMagic</span>
  <a href="#st-blackmagic" class="heading-mark">
    <svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg>
  </a>
</h2><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-c++" data-lang="c++"><span class="line"><span class="cl"><span class="k">struct</span> <span class="nc">RMQ</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">	<span class="cp">#define L(x) ((x-1)*siz+1)
</span></span></span><span class="line"><span class="cl"><span class="cp"></span>	<span class="cp">#define R(x) std::min(n, x*siz+1)
</span></span></span><span class="line"><span class="cl"><span class="cp"></span>	<span class="cp">#define bl(x) ((x-1)/siz+1)
</span></span></span><span class="line"><span class="cl"><span class="cp"></span>	<span class="k">const</span> <span class="kt">int</span> <span class="n">MAXB</span> <span class="o">=</span> <span class="mi">2050</span><span class="p">,</span> <span class="n">siz</span> <span class="o">=</span> <span class="mi">50</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">	<span class="kt">int</span> <span class="n">prf</span><span class="p">[</span><span class="n">MAXN</span><span class="p">],</span> <span class="n">suf</span><span class="p">[</span><span class="n">MAXN</span><span class="p">],</span> <span class="n">n</span><span class="p">,</span> <span class="n">st</span><span class="p">[</span><span class="n">MAXB</span><span class="p">][</span><span class="mi">13</span><span class="p">],</span> <span class="n">lg2</span><span class="p">[</span><span class="n">MAXN</span><span class="p">],</span> <span class="n">a</span><span class="p">[</span><span class="n">MAXN</span><span class="p">];</span>
</span></span><span class="line"><span class="cl">	<span class="kt">void</span> <span class="nf">init</span><span class="p">(</span><span class="kt">int</span> <span class="o">*</span><span class="n">s</span><span class="p">,</span> <span class="kt">int</span> <span class="n">_n</span><span class="p">,</span> <span class="kt">int</span> <span class="n">k</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">		<span class="n">n</span> <span class="o">=</span> <span class="n">_n</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">		<span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;=</span> <span class="n">n</span><span class="p">;</span> <span class="o">++</span><span class="n">i</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">            <span class="n">a</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">s</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">%</span> <span class="n">k</span><span class="p">,</span> <span class="n">st</span><span class="p">[</span><span class="n">bl</span><span class="p">(</span><span class="n">i</span><span class="p">)][</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">min</span><span class="p">(</span><span class="n">st</span><span class="p">[</span><span class="n">bl</span><span class="p">(</span><span class="n">i</span><span class="p">)][</span><span class="mi">0</span><span class="p">],</span> <span class="n">a</span><span class="p">[</span><span class="n">i</span><span class="p">]);</span>
</span></span><span class="line"><span class="cl">		<span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;=</span> <span class="n">bl</span><span class="p">(</span><span class="n">n</span><span class="p">);</span> <span class="o">++</span><span class="n">i</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">			<span class="n">prf</span><span class="p">[</span><span class="n">L</span><span class="p">(</span><span class="n">i</span><span class="p">)]</span> <span class="o">=</span> <span class="n">a</span><span class="p">[</span><span class="n">L</span><span class="p">(</span><span class="n">i</span><span class="p">)];</span> <span class="n">suf</span><span class="p">[</span><span class="n">R</span><span class="p">(</span><span class="n">i</span><span class="p">)]</span> <span class="o">=</span> <span class="n">a</span><span class="p">[</span><span class="n">R</span><span class="p">(</span><span class="n">i</span><span class="p">)];</span>
</span></span><span class="line"><span class="cl">			<span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">j</span> <span class="o">=</span> <span class="n">L</span><span class="p">(</span><span class="n">i</span><span class="p">)</span><span class="o">+</span><span class="mi">1</span><span class="p">;</span> <span class="n">j</span> <span class="o">&lt;=</span> <span class="n">R</span><span class="p">(</span><span class="n">i</span><span class="p">);</span> <span class="o">++</span><span class="n">j</span><span class="p">)</span> <span class="n">prf</span><span class="p">[</span><span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="n">min</span><span class="p">(</span><span class="n">prf</span><span class="p">[</span><span class="n">j</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="n">a</span><span class="p">[</span><span class="n">j</span><span class="p">]);</span>
</span></span><span class="line"><span class="cl">			<span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">j</span> <span class="o">=</span> <span class="n">R</span><span class="p">(</span><span class="n">i</span><span class="p">)</span><span class="o">-</span><span class="mi">1</span><span class="p">;</span> <span class="n">j</span> <span class="o">&gt;=</span> <span class="n">L</span><span class="p">(</span><span class="n">i</span><span class="p">);</span> <span class="o">--</span><span class="n">j</span><span class="p">)</span> <span class="n">suf</span><span class="p">[</span><span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="n">min</span><span class="p">(</span><span class="n">suf</span><span class="p">[</span><span class="n">j</span><span class="o">+</span><span class="mi">1</span><span class="p">],</span> <span class="n">a</span><span class="p">[</span><span class="n">j</span><span class="p">]);</span>
</span></span><span class="line"><span class="cl">		<span class="p">}</span>
</span></span><span class="line"><span class="cl">		<span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">j</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span> <span class="n">j</span> <span class="o">&lt;=</span> <span class="mi">12</span><span class="p">;</span> <span class="o">++</span><span class="n">j</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">			<span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span> <span class="n">i</span> <span class="o">+</span> <span class="p">(</span><span class="mi">1</span> <span class="o">&lt;&lt;</span> <span class="n">j</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span> <span class="o">&lt;=</span> <span class="n">bl</span><span class="p">(</span><span class="n">n</span><span class="p">);</span> <span class="o">++</span><span class="n">i</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">				<span class="n">st</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="n">min</span><span class="p">(</span><span class="n">st</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="n">st</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="p">(</span><span class="mi">1</span><span class="o">&lt;&lt;</span><span class="p">(</span><span class="n">j</span><span class="o">-</span><span class="mi">1</span><span class="p">))][</span><span class="n">j</span><span class="o">-</span><span class="mi">1</span><span class="p">]);</span>
</span></span><span class="line"><span class="cl">	<span class="p">}</span>
</span></span><span class="line"><span class="cl">	<span class="kt">int</span> <span class="nf">QST</span><span class="p">(</span><span class="kt">int</span> <span class="n">l</span><span class="p">,</span> <span class="kt">int</span> <span class="n">r</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">		<span class="k">if</span><span class="p">(</span><span class="n">l</span> <span class="o">&gt;</span> <span class="n">r</span><span class="p">)</span> <span class="k">return</span> <span class="mi">0</span><span class="p">;</span> <span class="kt">int</span> <span class="n">k</span> <span class="o">=</span> <span class="n">lg2</span><span class="p">[</span><span class="n">r</span><span class="o">-</span><span class="n">l</span><span class="o">+</span><span class="mi">1</span><span class="p">];</span>
</span></span><span class="line"><span class="cl">		<span class="k">return</span> <span class="n">min</span><span class="p">(</span><span class="n">st</span><span class="p">[</span><span class="n">l</span><span class="p">][</span><span class="n">k</span><span class="p">],</span> <span class="n">st</span><span class="p">[</span><span class="n">r</span><span class="o">-</span><span class="p">(</span><span class="mi">1</span><span class="o">&lt;&lt;</span><span class="n">k</span><span class="p">)</span><span class="o">+</span><span class="mi">1</span><span class="p">][</span><span class="n">k</span><span class="p">]);</span>
</span></span><span class="line"><span class="cl">	<span class="p">}</span>
</span></span><span class="line"><span class="cl">	<span class="kt">int</span> <span class="nf">query</span><span class="p">(</span><span class="kt">int</span> <span class="n">l</span><span class="p">,</span> <span class="kt">int</span> <span class="n">r</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">		<span class="k">if</span><span class="p">(</span><span class="n">bl</span><span class="p">(</span><span class="n">l</span><span class="p">)</span> <span class="o">==</span> <span class="n">bl</span><span class="p">(</span><span class="n">r</span><span class="p">))</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">			<span class="kt">int</span> <span class="n">res</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">			<span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="n">l</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;=</span> <span class="n">r</span><span class="p">;</span> <span class="o">++</span><span class="n">i</span><span class="p">)</span> <span class="n">res</span> <span class="o">=</span> <span class="n">max</span><span class="p">(</span><span class="n">res</span><span class="p">,</span> <span class="n">a</span><span class="p">[</span><span class="n">i</span><span class="p">]);</span>
</span></span><span class="line"><span class="cl">			<span class="k">return</span> <span class="n">res</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">		<span class="p">}</span> <span class="k">else</span> <span class="k">return</span> <span class="n">min</span><span class="p">(</span><span class="n">min</span><span class="p">(</span><span class="n">prf</span><span class="p">[</span><span class="n">r</span><span class="p">],</span> <span class="n">suf</span><span class="p">[</span><span class="n">l</span><span class="p">]),</span> <span class="n">QST</span><span class="p">(</span><span class="n">bl</span><span class="p">(</span><span class="n">l</span><span class="p">)</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span> <span class="n">bl</span><span class="p">(</span><span class="n">r</span><span class="p">)</span><span class="o">-</span><span class="mi">1</span><span class="p">));</span>
</span></span><span class="line"><span class="cl">	<span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span> <span class="n">ST</span><span class="p">;</span></span></span></code></pre></td></tr></table>
</div>
</div><h2 id="manacher" class="heading-element"><span>Manacher</span>
  <a href="#manacher" class="heading-mark">
    <svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg>
  </a>
</h2><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-c++" data-lang="c++"><span class="line"><span class="cl"><span class="kt">void</span> <span class="nf">Manacher</span><span class="p">()</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">	<span class="kt">int</span> <span class="n">mr</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="n">mid</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">	<span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">n</span><span class="p">;</span> <span class="o">++</span><span class="n">i</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">		<span class="n">p</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">mr</span> <span class="o">?</span> <span class="n">min</span><span class="p">(</span><span class="n">p</span><span class="p">[(</span><span class="n">mid</span> <span class="o">&lt;&lt;</span> <span class="mi">1</span><span class="p">)</span> <span class="o">-</span> <span class="n">i</span><span class="p">],</span> <span class="n">p</span><span class="p">[</span><span class="n">mid</span><span class="p">]</span> <span class="o">+</span> <span class="n">mid</span> <span class="o">-</span> <span class="n">i</span><span class="p">)</span> <span class="o">:</span> <span class="mi">1</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">		<span class="k">for</span><span class="p">(;</span> <span class="n">s</span><span class="p">[</span><span class="n">i</span><span class="o">-</span><span class="n">p</span><span class="p">[</span><span class="n">i</span><span class="p">]]</span> <span class="o">==</span> <span class="n">s</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="n">p</span><span class="p">[</span><span class="n">i</span><span class="p">]];</span> <span class="o">++</span><span class="n">p</span><span class="p">[</span><span class="n">i</span><span class="p">]);</span>
</span></span><span class="line"><span class="cl">		<span class="k">if</span><span class="p">(</span><span class="n">p</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">+</span> <span class="n">i</span> <span class="o">&gt;</span> <span class="n">mr</span><span class="p">)</span> <span class="n">mr</span> <span class="o">=</span> <span class="n">i</span> <span class="o">+</span> <span class="n">p</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">mid</span> <span class="o">=</span> <span class="n">i</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">	<span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="kt">int</span> <span class="nf">main</span><span class="p">()</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">	<span class="n">scanf</span><span class="p">(</span><span class="s">&#34;%s&#34;</span><span class="p">,</span> <span class="n">a</span><span class="p">);</span> <span class="n">_n</span> <span class="o">=</span> <span class="n">strlen</span><span class="p">(</span><span class="n">a</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">	<span class="n">s</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">s</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="sc">&#39;#&#39;</span><span class="p">;</span> <span class="n">n</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">	<span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">_n</span><span class="p">;</span> <span class="o">++</span><span class="n">i</span><span class="p">)</span> <span class="n">s</span><span class="p">[</span><span class="o">++</span><span class="n">n</span><span class="p">]</span> <span class="o">=</span> <span class="n">a</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">s</span><span class="p">[</span><span class="o">++</span><span class="n">n</span><span class="p">]</span> <span class="o">=</span> <span class="sc">&#39;#&#39;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">	<span class="n">s</span><span class="p">[</span><span class="o">++</span><span class="n">n</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">Manacher</span><span class="p">();</span>
</span></span><span class="line"><span class="cl">	<span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">n</span><span class="p">;</span> <span class="o">++</span><span class="n">i</span><span class="p">)</span> <span class="n">ans</span> <span class="o">=</span> <span class="n">max</span><span class="p">(</span><span class="n">ans</span><span class="p">,</span> <span class="n">p</span><span class="p">[</span><span class="n">i</span><span class="p">]);</span>
</span></span><span class="line"><span class="cl">	<span class="n">printf</span><span class="p">(</span><span class="s">&#34;%d</span><span class="se">\n</span><span class="s">&#34;</span><span class="p">,</span> <span class="n">ans</span><span class="o">-</span><span class="mi">1</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span></span></span></code></pre></td></tr></table>
</div>
</div><h2 id="线性基" class="heading-element"><span>线性基</span>
  <a href="#%e7%ba%bf%e6%80%a7%e5%9f%ba" class="heading-mark">
    <svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg>
  </a>
</h2><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-C++" data-lang="C++"><span class="line"><span class="cl"><span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;=</span> <span class="n">n</span><span class="p">;</span> <span class="o">++</span><span class="n">i</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">		<span class="n">read</span><span class="p">(</span><span class="n">a</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">		<span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">j</span> <span class="o">=</span> <span class="mi">50</span><span class="p">;</span> <span class="n">j</span> <span class="o">&gt;=</span> <span class="mi">0</span><span class="p">;</span> <span class="o">--</span><span class="n">j</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">			<span class="k">if</span><span class="p">((</span><span class="n">a</span> <span class="o">&gt;&gt;</span> <span class="n">j</span><span class="p">)</span> <span class="o">&amp;</span> <span class="mi">1</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">				<span class="k">if</span><span class="p">(</span><span class="o">!</span><span class="n">p</span><span class="p">[</span><span class="n">j</span><span class="p">])</span> <span class="p">{</span><span class="n">p</span><span class="p">[</span><span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="n">a</span><span class="p">;</span> <span class="k">break</span><span class="p">;}</span>
</span></span><span class="line"><span class="cl">				<span class="n">a</span> <span class="o">^=</span> <span class="n">p</span><span class="p">[</span><span class="n">j</span><span class="p">];</span>
</span></span><span class="line"><span class="cl">			<span class="p">}</span>
</span></span><span class="line"><span class="cl">		<span class="p">}</span>
</span></span><span class="line"><span class="cl">	<span class="p">}</span>
</span></span><span class="line"><span class="cl">	<span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">50</span><span class="p">;</span> <span class="n">i</span> <span class="o">&gt;=</span> <span class="mi">0</span><span class="p">;</span> <span class="o">--</span><span class="n">i</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">		<span class="k">if</span><span class="p">(</span><span class="n">p</span><span class="p">[</span><span class="n">i</span><span class="p">])</span> <span class="n">ans</span> <span class="o">=</span> <span class="n">max</span><span class="p">(</span><span class="n">ans</span><span class="p">,</span> <span class="n">ans</span> <span class="o">^</span> <span class="n">p</span><span class="p">[</span><span class="n">i</span><span class="p">]);</span></span></span></code></pre></td></tr></table>
</div>
</div><h2 id="线性逆元" class="heading-element"><span>线性逆元</span>
  <a href="#%e7%ba%bf%e6%80%a7%e9%80%86%e5%85%83" class="heading-mark">
    <svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg>
  </a>
</h2><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-c++" data-lang="c++"><span class="line"><span class="cl"><span class="n">inv</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">2</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;=</span> <span class="n">n</span><span class="p">;</span> <span class="o">++</span><span class="n">i</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">	<span class="n">inv</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1ll</span> <span class="o">*</span> <span class="p">(</span><span class="n">P</span> <span class="o">-</span> <span class="n">P</span> <span class="o">/</span> <span class="n">i</span><span class="p">)</span> <span class="o">%</span> <span class="n">P</span> <span class="o">*</span> <span class="n">inv</span><span class="p">[</span><span class="n">P</span> <span class="o">%</span> <span class="n">i</span><span class="p">]</span>	<span class="o">%</span> <span class="n">P</span><span class="p">;</span></span></span></code></pre></td></tr></table>
</div>
</div><h2 id="后缀数组" class="heading-element"><span>后缀数组</span>
  <a href="#%e5%90%8e%e7%bc%80%e6%95%b0%e7%bb%84" class="heading-mark">
    <svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg>
  </a>
</h2><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-C++" data-lang="C++"><span class="line"><span class="cl"><span class="kt">void</span> <span class="nf">getSA</span><span class="p">()</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">	<span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;=</span> <span class="n">n</span><span class="p">;</span> <span class="o">++</span><span class="n">i</span><span class="p">)</span> <span class="o">++</span><span class="n">c</span><span class="p">[</span><span class="n">x</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">s</span><span class="p">[</span><span class="n">i</span><span class="p">]];</span>
</span></span><span class="line"><span class="cl">	<span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;=</span> <span class="n">m</span><span class="p">;</span> <span class="o">++</span><span class="n">i</span><span class="p">)</span> <span class="n">c</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">+=</span> <span class="n">c</span><span class="p">[</span><span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="p">];</span>
</span></span><span class="line"><span class="cl">	<span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="n">n</span><span class="p">;</span> <span class="n">i</span> <span class="o">&gt;=</span> <span class="mi">1</span><span class="p">;</span> <span class="o">--</span><span class="n">i</span><span class="p">)</span> <span class="n">sa</span><span class="p">[</span><span class="n">c</span><span class="p">[</span><span class="n">x</span><span class="p">[</span><span class="n">i</span><span class="p">]]</span><span class="o">--</span><span class="p">]</span> <span class="o">=</span> <span class="n">i</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">	<span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">k</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span> <span class="n">k</span> <span class="o">&lt;=</span> <span class="n">n</span><span class="p">;</span> <span class="n">k</span> <span class="o">&lt;&lt;=</span> <span class="mi">1</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">		<span class="kt">int</span> <span class="n">num</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">		<span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="n">n</span> <span class="o">-</span> <span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;=</span> <span class="n">n</span><span class="p">;</span> <span class="o">++</span><span class="n">i</span><span class="p">)</span> <span class="n">y</span><span class="p">[</span><span class="o">++</span><span class="n">num</span><span class="p">]</span> <span class="o">=</span> <span class="n">i</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">		<span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;=</span> <span class="n">n</span><span class="p">;</span> <span class="o">++</span><span class="n">i</span><span class="p">)</span> <span class="k">if</span><span class="p">(</span><span class="n">sa</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">&gt;</span> <span class="n">k</span><span class="p">)</span> <span class="n">y</span><span class="p">[</span><span class="o">++</span><span class="n">num</span><span class="p">]</span> <span class="o">=</span> <span class="n">sa</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">-</span> <span class="n">k</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">		<span class="n">memset</span><span class="p">(</span><span class="n">c</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="k">sizeof</span> <span class="n">c</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">		<span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;=</span> <span class="n">n</span><span class="p">;</span> <span class="o">++</span><span class="n">i</span><span class="p">)</span> <span class="o">++</span><span class="n">c</span><span class="p">[</span><span class="n">x</span><span class="p">[</span><span class="n">i</span><span class="p">]];</span>
</span></span><span class="line"><span class="cl">		<span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;=</span> <span class="n">m</span><span class="p">;</span> <span class="o">++</span><span class="n">i</span><span class="p">)</span> <span class="n">c</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">+=</span> <span class="n">c</span><span class="p">[</span><span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="p">];</span>
</span></span><span class="line"><span class="cl">		<span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="n">n</span><span class="p">;</span> <span class="n">i</span> <span class="o">&gt;=</span> <span class="mi">1</span><span class="p">;</span> <span class="o">--</span><span class="n">i</span><span class="p">)</span> <span class="n">sa</span><span class="p">[</span><span class="n">c</span><span class="p">[</span><span class="n">x</span><span class="p">[</span><span class="n">y</span><span class="p">[</span><span class="n">i</span><span class="p">]]]</span><span class="o">--</span><span class="p">]</span> <span class="o">=</span> <span class="n">y</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">y</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">		<span class="n">swap</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">		<span class="n">x</span><span class="p">[</span><span class="n">sa</span><span class="p">[</span><span class="mi">1</span><span class="p">]]</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span> <span class="n">num</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">		<span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;=</span> <span class="n">n</span><span class="p">;</span> <span class="o">++</span><span class="n">i</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">			<span class="n">x</span><span class="p">[</span><span class="n">sa</span><span class="p">[</span><span class="n">i</span><span class="p">]]</span> <span class="o">=</span> <span class="p">(</span><span class="n">y</span><span class="p">[</span><span class="n">sa</span><span class="p">[</span><span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="p">]]</span> <span class="o">==</span> <span class="n">y</span><span class="p">[</span><span class="n">sa</span><span class="p">[</span><span class="n">i</span><span class="p">]]</span> <span class="o">&amp;&amp;</span> <span class="n">y</span><span class="p">[</span><span class="n">sa</span><span class="p">[</span><span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">+</span><span class="n">k</span><span class="p">]</span> <span class="o">==</span> <span class="n">y</span><span class="p">[</span><span class="n">sa</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">+</span><span class="n">k</span><span class="p">])</span> <span class="o">?</span> <span class="nl">num</span> <span class="p">:</span> <span class="o">++</span><span class="n">num</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">		<span class="k">if</span><span class="p">(</span><span class="n">num</span> <span class="o">==</span> <span class="n">n</span><span class="p">)</span> <span class="k">break</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">		<span class="n">m</span> <span class="o">=</span> <span class="n">num</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">	<span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span></span></span></code></pre></td></tr></table>
</div>
</div><h2 id="点分治" class="heading-element"><span>点分治</span>
  <a href="#%e7%82%b9%e5%88%86%e6%b2%bb" class="heading-mark">
    <svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg>
  </a>
</h2><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-C++" data-lang="C++"><span class="line"><span class="cl"><span class="kt">void</span> <span class="nf">getroot</span><span class="p">(</span><span class="kt">int</span> <span class="n">u</span><span class="p">,</span> <span class="kt">int</span> <span class="n">p</span><span class="p">,</span> <span class="kt">int</span> <span class="n">S</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">	<span class="n">siz</span><span class="p">[</span><span class="n">u</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">f</span><span class="p">[</span><span class="n">u</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">	<span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">v</span><span class="p">,</span> <span class="n">i</span> <span class="o">=</span> <span class="n">h</span><span class="p">[</span><span class="n">u</span><span class="p">];</span> <span class="o">~</span><span class="n">i</span><span class="p">;</span> <span class="n">i</span> <span class="o">=</span> <span class="n">e</span><span class="p">[</span><span class="n">i</span><span class="p">].</span><span class="n">next</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">		<span class="k">if</span><span class="p">((</span><span class="n">v</span> <span class="o">=</span> <span class="n">e</span><span class="p">[</span><span class="n">i</span><span class="p">].</span><span class="n">to</span><span class="p">)</span> <span class="o">!=</span> <span class="n">p</span> <span class="o">&amp;&amp;</span> <span class="o">!</span><span class="n">vis</span><span class="p">[</span><span class="n">v</span><span class="p">])</span>
</span></span><span class="line"><span class="cl">			<span class="n">getroot</span><span class="p">(</span><span class="n">v</span><span class="p">,</span> <span class="n">u</span><span class="p">,</span> <span class="n">S</span><span class="p">),</span> <span class="n">siz</span><span class="p">[</span><span class="n">u</span><span class="p">]</span> <span class="o">+=</span> <span class="n">siz</span><span class="p">[</span><span class="n">v</span><span class="p">],</span> <span class="n">f</span><span class="p">[</span><span class="n">u</span><span class="p">]</span> <span class="o">=</span> <span class="n">max</span><span class="p">(</span><span class="n">f</span><span class="p">[</span><span class="n">u</span><span class="p">],</span> <span class="n">siz</span><span class="p">[</span><span class="n">v</span><span class="p">]);</span>
</span></span><span class="line"><span class="cl">	<span class="n">f</span><span class="p">[</span><span class="n">u</span><span class="p">]</span> <span class="o">=</span> <span class="n">max</span><span class="p">(</span><span class="n">f</span><span class="p">[</span><span class="n">u</span><span class="p">],</span> <span class="n">S</span> <span class="o">-</span> <span class="n">siz</span><span class="p">[</span><span class="n">u</span><span class="p">]);</span> <span class="n">rt</span> <span class="o">=</span> <span class="n">f</span><span class="p">[</span><span class="n">u</span><span class="p">]</span> <span class="o">&lt;</span> <span class="n">f</span><span class="p">[</span><span class="n">rt</span><span class="p">]</span> <span class="o">?</span> <span class="nl">u</span> <span class="p">:</span> <span class="n">rt</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="kt">void</span> <span class="nf">getdis</span><span class="p">(</span><span class="kt">int</span> <span class="n">u</span><span class="p">,</span> <span class="kt">int</span> <span class="n">p</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">	<span class="n">stk</span><span class="p">[</span><span class="o">++</span><span class="n">top</span><span class="p">]</span> <span class="o">=</span> <span class="n">dis</span><span class="p">[</span><span class="n">u</span><span class="p">];</span>
</span></span><span class="line"><span class="cl">	<span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">v</span><span class="p">,</span> <span class="n">i</span> <span class="o">=</span> <span class="n">h</span><span class="p">[</span><span class="n">u</span><span class="p">];</span> <span class="o">~</span><span class="n">i</span><span class="p">;</span> <span class="n">i</span> <span class="o">=</span> <span class="n">e</span><span class="p">[</span><span class="n">i</span><span class="p">].</span><span class="n">next</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">		<span class="k">if</span><span class="p">((</span><span class="n">v</span> <span class="o">=</span> <span class="n">e</span><span class="p">[</span><span class="n">i</span><span class="p">].</span><span class="n">to</span><span class="p">)</span> <span class="o">!=</span> <span class="n">p</span> <span class="o">&amp;&amp;</span> <span class="o">!</span><span class="n">vis</span><span class="p">[</span><span class="n">v</span><span class="p">])</span>
</span></span><span class="line"><span class="cl">			<span class="n">dis</span><span class="p">[</span><span class="n">v</span><span class="p">]</span> <span class="o">=</span> <span class="n">dis</span><span class="p">[</span><span class="n">u</span><span class="p">]</span> <span class="o">+</span> <span class="n">e</span><span class="p">[</span><span class="n">i</span><span class="p">].</span><span class="n">w</span><span class="p">,</span> <span class="n">getdis</span><span class="p">(</span><span class="n">v</span><span class="p">,</span> <span class="n">u</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="kt">void</span> <span class="nf">solve</span><span class="p">(</span><span class="kt">int</span> <span class="n">u</span><span class="p">,</span> <span class="kt">int</span> <span class="n">w</span><span class="p">,</span> <span class="kt">int</span> <span class="n">t</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">	<span class="n">top</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="n">dis</span><span class="p">[</span><span class="n">u</span><span class="p">]</span> <span class="o">=</span> <span class="n">w</span><span class="p">,</span> <span class="n">getdis</span><span class="p">(</span><span class="n">u</span><span class="p">,</span> <span class="mi">0</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">	<span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;=</span> <span class="n">top</span><span class="p">;</span> <span class="o">++</span><span class="n">i</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">		<span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">j</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span> <span class="n">j</span> <span class="o">&lt;=</span> <span class="n">top</span><span class="p">;</span> <span class="o">++</span><span class="n">j</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">			<span class="k">if</span><span class="p">(</span><span class="n">i</span> <span class="o">!=</span> <span class="n">j</span><span class="p">)</span> <span class="n">ans</span><span class="p">[</span><span class="n">stk</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">+</span> <span class="n">stk</span><span class="p">[</span><span class="n">j</span><span class="p">]]</span> <span class="o">+=</span> <span class="n">t</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="kt">void</span> <span class="nf">devide</span><span class="p">(</span><span class="kt">int</span> <span class="n">u</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">	<span class="n">solve</span><span class="p">(</span><span class="n">u</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">);</span> <span class="n">vis</span><span class="p">[</span><span class="n">u</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">	<span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">v</span><span class="p">,</span> <span class="n">i</span> <span class="o">=</span> <span class="n">h</span><span class="p">[</span><span class="n">u</span><span class="p">];</span> <span class="o">~</span><span class="n">i</span><span class="p">;</span> <span class="n">i</span> <span class="o">=</span> <span class="n">e</span><span class="p">[</span><span class="n">i</span><span class="p">].</span><span class="n">next</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">		<span class="k">if</span><span class="p">(</span><span class="o">!</span><span class="n">vis</span><span class="p">[(</span><span class="n">v</span> <span class="o">=</span> <span class="n">e</span><span class="p">[</span><span class="n">i</span><span class="p">].</span><span class="n">to</span><span class="p">)])</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">			<span class="n">solve</span><span class="p">(</span><span class="n">v</span><span class="p">,</span> <span class="n">e</span><span class="p">[</span><span class="n">i</span><span class="p">].</span><span class="n">w</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">),</span> <span class="n">rt</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="n">f</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">n</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">			<span class="n">getroot</span><span class="p">(</span><span class="n">v</span><span class="p">,</span> <span class="n">u</span><span class="p">,</span> <span class="n">siz</span><span class="p">[</span><span class="n">u</span><span class="p">]),</span> <span class="n">devide</span><span class="p">(</span><span class="n">rt</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">		<span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span></span></span></code></pre></td></tr></table>
</div>
</div><h2 id="线段树" class="heading-element"><span>线段树</span>
  <a href="#%e7%ba%bf%e6%ae%b5%e6%a0%91" class="heading-mark">
    <svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg>
  </a>
</h2><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-C++" data-lang="C++"><span class="line"><span class="cl"><span class="cp">#define L(u) (u&lt;&lt;1)
</span></span></span><span class="line"><span class="cl"><span class="cp">#define R(u) (u&lt;&lt;1|1)
</span></span></span><span class="line"><span class="cl"><span class="cp">#define mid ((l+r)&gt;&gt;1)
</span></span></span><span class="line"><span class="cl"><span class="cp"></span><span class="kt">void</span> <span class="nf">PU</span><span class="p">(</span><span class="kt">int</span> <span class="n">u</span><span class="p">)</span> <span class="p">{</span><span class="n">t</span><span class="p">[</span><span class="n">u</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="n">t</span><span class="p">[</span><span class="n">L</span><span class="p">(</span><span class="n">u</span><span class="p">)]</span> <span class="o">+</span> <span class="n">t</span><span class="p">[</span><span class="n">R</span><span class="p">(</span><span class="n">u</span><span class="p">)])</span> <span class="o">%</span> <span class="n">P</span><span class="p">;}</span>
</span></span><span class="line"><span class="cl"><span class="kt">void</span> <span class="nf">ADD</span><span class="p">(</span><span class="kt">int</span> <span class="n">u</span><span class="p">,</span> <span class="kt">int</span> <span class="n">l</span><span class="p">,</span> <span class="kt">int</span> <span class="n">r</span><span class="p">,</span> <span class="kt">int</span> <span class="n">k</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">	<span class="n">t</span><span class="p">[</span><span class="n">u</span><span class="p">]</span> <span class="o">+=</span> <span class="p">(</span><span class="n">r</span> <span class="o">-</span> <span class="n">l</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="o">*</span> <span class="n">k</span> <span class="o">%</span> <span class="n">P</span><span class="p">;</span> <span class="n">t</span><span class="p">[</span><span class="n">u</span><span class="p">]</span> <span class="o">%=</span> <span class="n">P</span><span class="p">;</span> <span class="n">add</span><span class="p">[</span><span class="n">u</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="n">add</span><span class="p">[</span><span class="n">u</span><span class="p">]</span> <span class="o">+</span> <span class="n">k</span><span class="p">)</span> <span class="o">%</span> <span class="n">P</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="kt">void</span> <span class="nf">MUL</span><span class="p">(</span><span class="kt">int</span> <span class="n">u</span><span class="p">,</span> <span class="kt">int</span> <span class="n">l</span><span class="p">,</span> <span class="kt">int</span> <span class="n">r</span><span class="p">,</span> <span class="kt">int</span> <span class="n">k</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">	<span class="n">t</span><span class="p">[</span><span class="n">u</span><span class="p">]</span> <span class="o">=</span> <span class="n">t</span><span class="p">[</span><span class="n">u</span><span class="p">]</span> <span class="o">*</span> <span class="n">k</span> <span class="o">%</span> <span class="n">P</span><span class="p">;</span> <span class="n">add</span><span class="p">[</span><span class="n">u</span><span class="p">]</span> <span class="o">=</span> <span class="n">add</span><span class="p">[</span><span class="n">u</span><span class="p">]</span> <span class="o">*</span> <span class="n">k</span> <span class="o">%</span> <span class="n">P</span><span class="p">;</span> <span class="n">mul</span><span class="p">[</span><span class="n">u</span><span class="p">]</span> <span class="o">=</span> <span class="n">mul</span><span class="p">[</span><span class="n">u</span><span class="p">]</span> <span class="o">*</span> <span class="n">k</span> <span class="o">%</span> <span class="n">P</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="kt">void</span> <span class="nf">PD</span><span class="p">(</span><span class="kt">int</span> <span class="n">u</span><span class="p">,</span> <span class="kt">int</span> <span class="n">l</span><span class="p">,</span> <span class="kt">int</span> <span class="n">r</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">	<span class="n">MUL</span><span class="p">(</span><span class="n">L</span><span class="p">(</span><span class="n">u</span><span class="p">),</span> <span class="n">l</span><span class="p">,</span> <span class="n">mid</span><span class="p">,</span> <span class="n">mul</span><span class="p">[</span><span class="n">u</span><span class="p">]);</span> <span class="n">MUL</span><span class="p">(</span><span class="n">R</span><span class="p">(</span><span class="n">u</span><span class="p">),</span> <span class="n">mid</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span> <span class="n">r</span><span class="p">,</span> <span class="n">mul</span><span class="p">[</span><span class="n">u</span><span class="p">]);</span> <span class="n">mul</span><span class="p">[</span><span class="n">u</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">	<span class="n">ADD</span><span class="p">(</span><span class="n">L</span><span class="p">(</span><span class="n">u</span><span class="p">),</span> <span class="n">l</span><span class="p">,</span> <span class="n">mid</span><span class="p">,</span> <span class="n">add</span><span class="p">[</span><span class="n">u</span><span class="p">]);</span> <span class="n">ADD</span><span class="p">(</span><span class="n">R</span><span class="p">(</span><span class="n">u</span><span class="p">),</span> <span class="n">mid</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span> <span class="n">r</span><span class="p">,</span> <span class="n">add</span><span class="p">[</span><span class="n">u</span><span class="p">]);</span> <span class="n">add</span><span class="p">[</span><span class="n">u</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="kt">void</span> <span class="nf">build</span><span class="p">(</span><span class="kt">int</span> <span class="n">u</span><span class="p">,</span> <span class="kt">int</span> <span class="n">l</span><span class="p">,</span> <span class="kt">int</span> <span class="n">r</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">	<span class="n">mul</span><span class="p">[</span><span class="n">u</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span> <span class="k">if</span><span class="p">(</span><span class="n">l</span> <span class="o">==</span> <span class="n">r</span><span class="p">)</span> <span class="p">{</span><span class="n">t</span><span class="p">[</span><span class="n">u</span><span class="p">]</span> <span class="o">=</span> <span class="n">a</span><span class="p">[</span><span class="n">l</span><span class="p">];</span> <span class="k">return</span><span class="p">;}</span>
</span></span><span class="line"><span class="cl">	<span class="n">build</span><span class="p">(</span><span class="n">L</span><span class="p">(</span><span class="n">u</span><span class="p">),</span> <span class="n">l</span><span class="p">,</span> <span class="n">mid</span><span class="p">);</span> <span class="n">build</span><span class="p">(</span><span class="n">R</span><span class="p">(</span><span class="n">u</span><span class="p">),</span> <span class="n">mid</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span> <span class="n">r</span><span class="p">);</span> <span class="n">PU</span><span class="p">(</span><span class="n">u</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="kt">void</span> <span class="nf">MA</span><span class="p">(</span><span class="kt">int</span> <span class="n">u</span><span class="p">,</span> <span class="kt">int</span> <span class="n">l</span><span class="p">,</span> <span class="kt">int</span> <span class="n">r</span><span class="p">,</span> <span class="kt">int</span> <span class="n">tl</span><span class="p">,</span> <span class="kt">int</span> <span class="n">tr</span><span class="p">,</span> <span class="kt">int</span> <span class="n">k</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">	<span class="k">if</span><span class="p">(</span><span class="n">tr</span> <span class="o">&lt;</span> <span class="n">l</span> <span class="o">||</span> <span class="n">tl</span> <span class="o">&gt;</span> <span class="n">r</span><span class="p">)</span> <span class="k">return</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">	<span class="k">if</span><span class="p">(</span><span class="n">tl</span> <span class="o">&lt;=</span> <span class="n">l</span> <span class="o">&amp;&amp;</span> <span class="n">r</span> <span class="o">&lt;=</span> <span class="n">tr</span><span class="p">)</span> <span class="p">{</span><span class="n">ADD</span><span class="p">(</span><span class="n">u</span><span class="p">,</span> <span class="n">l</span><span class="p">,</span> <span class="n">r</span><span class="p">,</span> <span class="n">k</span><span class="p">);</span> <span class="k">return</span><span class="p">;}</span>
</span></span><span class="line"><span class="cl">	<span class="n">PD</span><span class="p">(</span><span class="n">u</span><span class="p">,</span> <span class="n">l</span><span class="p">,</span> <span class="n">r</span><span class="p">);</span> <span class="n">MA</span><span class="p">(</span><span class="n">L</span><span class="p">(</span><span class="n">u</span><span class="p">),</span> <span class="n">l</span><span class="p">,</span> <span class="n">mid</span><span class="p">,</span> <span class="n">tl</span><span class="p">,</span> <span class="n">tr</span><span class="p">,</span> <span class="n">k</span><span class="p">);</span> <span class="n">MA</span><span class="p">(</span><span class="n">R</span><span class="p">(</span><span class="n">u</span><span class="p">),</span> <span class="n">mid</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span> <span class="n">r</span><span class="p">,</span> <span class="n">tl</span><span class="p">,</span> <span class="n">tr</span><span class="p">,</span> <span class="n">k</span><span class="p">);</span> <span class="n">PU</span><span class="p">(</span><span class="n">u</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="kt">void</span> <span class="nf">MM</span><span class="p">(</span><span class="kt">int</span> <span class="n">u</span><span class="p">,</span> <span class="kt">int</span> <span class="n">l</span><span class="p">,</span> <span class="kt">int</span> <span class="n">r</span><span class="p">,</span> <span class="kt">int</span> <span class="n">tl</span><span class="p">,</span> <span class="kt">int</span> <span class="n">tr</span><span class="p">,</span> <span class="kt">int</span> <span class="n">k</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">	<span class="k">if</span><span class="p">(</span><span class="n">tr</span> <span class="o">&lt;</span> <span class="n">l</span> <span class="o">||</span> <span class="n">tl</span> <span class="o">&gt;</span> <span class="n">r</span><span class="p">)</span> <span class="k">return</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">	<span class="k">if</span><span class="p">(</span><span class="n">tl</span> <span class="o">&lt;=</span> <span class="n">l</span> <span class="o">&amp;&amp;</span> <span class="n">r</span> <span class="o">&lt;=</span> <span class="n">tr</span><span class="p">)</span> <span class="p">{</span><span class="n">MUL</span><span class="p">(</span><span class="n">u</span><span class="p">,</span> <span class="n">l</span><span class="p">,</span> <span class="n">r</span><span class="p">,</span> <span class="n">k</span><span class="p">);</span> <span class="k">return</span><span class="p">;}</span>
</span></span><span class="line"><span class="cl">	<span class="n">PD</span><span class="p">(</span><span class="n">u</span><span class="p">,</span> <span class="n">l</span><span class="p">,</span> <span class="n">r</span><span class="p">);</span> <span class="n">MM</span><span class="p">(</span><span class="n">L</span><span class="p">(</span><span class="n">u</span><span class="p">),</span> <span class="n">l</span><span class="p">,</span> <span class="n">mid</span><span class="p">,</span> <span class="n">tl</span><span class="p">,</span> <span class="n">tr</span><span class="p">,</span> <span class="n">k</span><span class="p">);</span> <span class="n">MM</span><span class="p">(</span><span class="n">R</span><span class="p">(</span><span class="n">u</span><span class="p">),</span> <span class="n">mid</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span> <span class="n">r</span><span class="p">,</span> <span class="n">tl</span><span class="p">,</span> <span class="n">tr</span><span class="p">,</span> <span class="n">k</span><span class="p">);</span> <span class="n">PU</span><span class="p">(</span><span class="n">u</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="kt">int</span> <span class="nf">Q</span><span class="p">(</span><span class="kt">int</span> <span class="n">u</span><span class="p">,</span> <span class="kt">int</span> <span class="n">l</span><span class="p">,</span> <span class="kt">int</span> <span class="n">r</span><span class="p">,</span> <span class="kt">int</span> <span class="n">tl</span><span class="p">,</span> <span class="kt">int</span> <span class="n">tr</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">	<span class="k">if</span><span class="p">(</span><span class="n">tr</span> <span class="o">&lt;</span> <span class="n">l</span> <span class="o">||</span> <span class="n">tl</span> <span class="o">&gt;</span> <span class="n">r</span><span class="p">)</span> <span class="k">return</span> <span class="mi">0</span><span class="p">;</span> <span class="k">if</span><span class="p">(</span><span class="n">tl</span> <span class="o">&lt;=</span> <span class="n">l</span> <span class="o">&amp;&amp;</span> <span class="n">r</span> <span class="o">&lt;=</span> <span class="n">tr</span><span class="p">)</span> <span class="k">return</span> <span class="n">t</span><span class="p">[</span><span class="n">u</span><span class="p">];</span>
</span></span><span class="line"><span class="cl">	<span class="n">PD</span><span class="p">(</span><span class="n">u</span><span class="p">,</span> <span class="n">l</span><span class="p">,</span> <span class="n">r</span><span class="p">);</span> <span class="k">return</span> <span class="p">(</span><span class="n">Q</span><span class="p">(</span><span class="n">L</span><span class="p">(</span><span class="n">u</span><span class="p">),</span> <span class="n">l</span><span class="p">,</span> <span class="n">mid</span><span class="p">,</span> <span class="n">tl</span><span class="p">,</span> <span class="n">tr</span><span class="p">)</span> <span class="o">+</span> <span class="n">Q</span><span class="p">(</span><span class="n">R</span><span class="p">(</span><span class="n">u</span><span class="p">),</span> <span class="n">mid</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span> <span class="n">r</span><span class="p">,</span> <span class="n">tl</span><span class="p">,</span> <span class="n">tr</span><span class="p">))</span> <span class="o">%</span> <span class="n">P</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span></span></span></code></pre></td></tr></table>
</div>
</div><h2 id="三分" class="heading-element"><span>三分</span>
  <a href="#%e4%b8%89%e5%88%86" class="heading-mark">
    <svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg>
  </a>
</h2><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-C++" data-lang="C++"><span class="line"><span class="cl"><span class="k">while</span><span class="p">(</span><span class="n">fabs</span><span class="p">(</span><span class="n">r</span><span class="o">-</span><span class="n">l</span><span class="p">)</span> <span class="o">&gt;=</span> <span class="n">eps</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">	<span class="kt">double</span> <span class="n">mid</span> <span class="o">=</span> <span class="p">(</span><span class="n">l</span> <span class="o">+</span> <span class="n">r</span><span class="p">)</span> <span class="o">/</span> <span class="mi">2</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">	<span class="k">if</span><span class="p">(</span><span class="n">f</span><span class="p">(</span><span class="n">mid</span> <span class="o">-</span> <span class="n">eps</span><span class="p">)</span> <span class="o">&lt;</span> <span class="n">f</span><span class="p">(</span><span class="n">mid</span> <span class="o">+</span> <span class="n">eps</span><span class="p">))</span> <span class="n">l</span> <span class="o">=</span> <span class="n">mid</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">	<span class="k">else</span> <span class="n">r</span> <span class="o">=</span> <span class="n">mid</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span></span></span></code></pre></td></tr></table>
</div>
</div><h2 id="树状数组" class="heading-element"><span>树状数组</span>
  <a href="#%e6%a0%91%e7%8a%b6%e6%95%b0%e7%bb%84" class="heading-mark">
    <svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg>
  </a>
</h2><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-c++" data-lang="c++"><span class="line"><span class="cl"><span class="kt">void</span> <span class="nf">U</span><span class="p">(</span><span class="kt">int</span> <span class="n">x</span><span class="p">,</span> <span class="kt">int</span> <span class="n">k</span><span class="p">)</span> <span class="p">{</span><span class="k">for</span><span class="p">(;</span> <span class="n">x</span> <span class="o">&lt;=</span> <span class="n">n</span><span class="p">;</span> <span class="n">t</span><span class="p">[</span><span class="n">x</span><span class="p">]</span> <span class="o">+=</span> <span class="n">k</span><span class="p">,</span> <span class="n">x</span> <span class="o">+=</span> <span class="n">x</span><span class="o">&amp;-</span><span class="n">x</span><span class="p">);}</span>
</span></span><span class="line"><span class="cl"><span class="kt">int</span> <span class="nf">Q</span><span class="p">(</span><span class="kt">int</span> <span class="n">x</span><span class="p">)</span> <span class="p">{</span><span class="kt">int</span> <span class="n">w</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="k">for</span><span class="p">(;</span> <span class="n">x</span><span class="p">;</span> <span class="n">w</span> <span class="o">+=</span> <span class="n">t</span><span class="p">[</span><span class="n">x</span><span class="p">],</span> <span class="n">x</span> <span class="o">-=</span> <span class="n">x</span><span class="o">&amp;-</span><span class="n">x</span><span class="p">);</span> <span class="k">return</span> <span class="n">w</span><span class="p">;}</span></span></span></code></pre></td></tr></table>
</div>
</div><h2 id="高斯消元" class="heading-element"><span>高斯消元</span>
  <a href="#%e9%ab%98%e6%96%af%e6%b6%88%e5%85%83" class="heading-mark">
    <svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg>
  </a>
</h2><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-C++" data-lang="C++"><span class="line"><span class="cl"><span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;=</span> <span class="n">n</span><span class="p">;</span> <span class="o">++</span><span class="n">i</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">	<span class="kt">int</span> <span class="n">p</span> <span class="o">=</span> <span class="n">i</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">	<span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">j</span> <span class="o">=</span> <span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">;</span> <span class="n">j</span> <span class="o">&lt;=</span> <span class="n">n</span><span class="p">;</span> <span class="o">++</span><span class="n">j</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">		<span class="k">if</span><span class="p">(</span><span class="n">fabs</span><span class="p">(</span><span class="n">a</span><span class="p">[</span><span class="n">j</span><span class="p">][</span><span class="n">i</span><span class="p">])</span> <span class="o">&gt;</span> <span class="n">fabs</span><span class="p">(</span><span class="n">a</span><span class="p">[</span><span class="n">p</span><span class="p">][</span><span class="n">i</span><span class="p">]))</span> <span class="n">p</span> <span class="o">=</span> <span class="n">j</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">	<span class="k">if</span><span class="p">(</span><span class="n">a</span><span class="p">[</span><span class="n">p</span><span class="p">][</span><span class="n">i</span><span class="p">]</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="p">{</span><span class="n">puts</span><span class="p">(</span><span class="s">&#34;No Solution&#34;</span><span class="p">);</span> <span class="k">return</span> <span class="mi">0</span><span class="p">;}</span>
</span></span><span class="line"><span class="cl">	<span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">j</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span> <span class="n">j</span> <span class="o">&lt;=</span> <span class="n">n</span><span class="o">+</span><span class="mi">1</span><span class="p">;</span> <span class="o">++</span><span class="n">j</span><span class="p">)</span> <span class="n">swap</span><span class="p">(</span><span class="n">a</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="p">],</span> <span class="n">a</span><span class="p">[</span><span class="n">p</span><span class="p">][</span><span class="n">j</span><span class="p">]);</span>
</span></span><span class="line"><span class="cl">	<span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">j</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span> <span class="n">j</span> <span class="o">&lt;=</span> <span class="n">n</span><span class="p">;</span> <span class="o">++</span><span class="n">j</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">		<span class="k">if</span><span class="p">(</span><span class="n">i</span> <span class="o">==</span> <span class="n">j</span><span class="p">)</span> <span class="k">continue</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">		<span class="kt">double</span> <span class="n">t</span> <span class="o">=</span> <span class="n">a</span><span class="p">[</span><span class="n">j</span><span class="p">][</span><span class="n">i</span><span class="p">]</span> <span class="o">/</span> <span class="n">a</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">i</span><span class="p">];</span>
</span></span><span class="line"><span class="cl">		<span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">k</span> <span class="o">=</span> <span class="n">i</span><span class="p">;</span> <span class="n">k</span> <span class="o">&lt;=</span> <span class="n">n</span><span class="o">+</span><span class="mi">1</span><span class="p">;</span> <span class="o">++</span><span class="n">k</span><span class="p">)</span> <span class="n">a</span><span class="p">[</span><span class="n">j</span><span class="p">][</span><span class="n">k</span><span class="p">]</span> <span class="o">-=</span> <span class="n">a</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">k</span><span class="p">]</span> <span class="o">*</span> <span class="n">t</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">	<span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;=</span> <span class="n">n</span><span class="p">;</span> <span class="o">++</span><span class="n">i</span><span class="p">)</span> <span class="n">printf</span><span class="p">(</span><span class="s">&#34;%.2lf</span><span class="se">\n</span><span class="s">&#34;</span><span class="p">,</span> <span class="n">a</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">n</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span> <span class="o">/</span> <span class="n">a</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">i</span><span class="p">]);</span></span></span></code></pre></td></tr></table>
</div>
</div><h2 id="最小生成树并查集" class="heading-element"><span>最小生成树&amp;并查集</span>
  <a href="#%e6%9c%80%e5%b0%8f%e7%94%9f%e6%88%90%e6%a0%91%e5%b9%b6%e6%9f%a5%e9%9b%86" class="heading-mark">
    <svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg>
  </a>
</h2><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-C++" data-lang="C++"><span class="line"><span class="cl"><span class="kt">int</span> <span class="nf">findfa</span><span class="p">(</span><span class="kt">int</span> <span class="n">x</span><span class="p">)</span> <span class="p">{</span><span class="k">return</span> <span class="n">x</span> <span class="o">==</span> <span class="n">fa</span><span class="p">[</span><span class="n">x</span><span class="p">]</span> <span class="o">?</span> <span class="nl">x</span> <span class="p">:</span> <span class="n">fa</span><span class="p">[</span><span class="n">x</span><span class="p">]</span> <span class="o">=</span> <span class="n">findfa</span><span class="p">(</span><span class="n">fa</span><span class="p">[</span><span class="n">x</span><span class="p">]);}</span>
</span></span><span class="line"><span class="cl"><span class="kt">int</span> <span class="nf">main</span><span class="p">()</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">	<span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;=</span> <span class="n">n</span><span class="p">;</span> <span class="o">++</span><span class="n">i</span><span class="p">)</span> <span class="n">fa</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">i</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">	<span class="n">sort</span><span class="p">(</span><span class="n">e</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span> <span class="n">e</span><span class="o">+</span><span class="n">m</span><span class="o">+</span><span class="mi">1</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">	<span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;=</span> <span class="n">m</span><span class="p">;</span> <span class="o">++</span><span class="n">i</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">		<span class="kt">int</span> <span class="n">x</span> <span class="o">=</span> <span class="n">findfa</span><span class="p">(</span><span class="n">e</span><span class="p">[</span><span class="n">i</span><span class="p">].</span><span class="n">u</span><span class="p">),</span> <span class="n">y</span> <span class="o">=</span> <span class="n">findfa</span><span class="p">(</span><span class="n">e</span><span class="p">[</span><span class="n">i</span><span class="p">].</span><span class="n">v</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">		<span class="k">if</span><span class="p">(</span><span class="n">x</span> <span class="o">==</span> <span class="n">y</span><span class="p">)</span> <span class="k">continue</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">		<span class="n">ans</span> <span class="o">+=</span> <span class="n">e</span><span class="p">[</span><span class="n">i</span><span class="p">].</span><span class="n">w</span><span class="p">;</span> <span class="o">++</span><span class="n">cnt</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">		<span class="k">if</span><span class="p">(</span><span class="n">cnt</span> <span class="o">==</span> <span class="n">n</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span> <span class="k">break</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">		<span class="n">fa</span><span class="p">[</span><span class="n">x</span><span class="p">]</span> <span class="o">=</span> <span class="n">y</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">	<span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span></span></span></code></pre></td></tr></table>
</div>
</div><h2 id="dinic" class="heading-element"><span>DINIC</span>
  <a href="#dinic" class="heading-mark">
    <svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg>
  </a>
</h2><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-C++" data-lang="C++"><span class="line"><span class="cl"><span class="kt">bool</span> <span class="nf">bfs</span><span class="p">()</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">	<span class="n">memset</span><span class="p">(</span><span class="n">d</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="k">sizeof</span> <span class="n">d</span><span class="p">);</span> <span class="n">queue</span> <span class="o">&lt;</span><span class="kt">int</span><span class="o">&gt;</span> <span class="n">q</span><span class="p">;</span> <span class="n">q</span><span class="p">.</span><span class="n">push</span><span class="p">(</span><span class="n">s</span><span class="p">);</span> <span class="n">d</span><span class="p">[</span><span class="n">s</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">	<span class="k">while</span><span class="p">(</span><span class="o">!</span><span class="n">q</span><span class="p">.</span><span class="n">empty</span><span class="p">())</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">		<span class="kt">int</span> <span class="n">u</span> <span class="o">=</span> <span class="n">q</span><span class="p">.</span><span class="n">front</span><span class="p">();</span> <span class="n">q</span><span class="p">.</span><span class="n">pop</span><span class="p">();</span>
</span></span><span class="line"><span class="cl">		<span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">v</span><span class="p">,</span> <span class="n">i</span> <span class="o">=</span> <span class="n">h</span><span class="p">[</span><span class="n">u</span><span class="p">];</span> <span class="o">~</span><span class="n">i</span><span class="p">;</span> <span class="n">i</span> <span class="o">=</span> <span class="n">e</span><span class="p">[</span><span class="n">i</span><span class="p">].</span><span class="n">next</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">			<span class="k">if</span><span class="p">(</span><span class="n">d</span><span class="p">[</span><span class="n">v</span> <span class="o">=</span> <span class="n">e</span><span class="p">[</span><span class="n">i</span><span class="p">].</span><span class="n">to</span><span class="p">]</span> <span class="o">==</span> <span class="o">-</span><span class="mi">1</span> <span class="o">&amp;&amp;</span> <span class="n">e</span><span class="p">[</span><span class="n">i</span><span class="p">].</span><span class="n">w</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">				<span class="n">d</span><span class="p">[</span><span class="n">v</span><span class="p">]</span> <span class="o">=</span> <span class="n">d</span><span class="p">[</span><span class="n">u</span><span class="p">]</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="n">q</span><span class="p">.</span><span class="n">push</span><span class="p">(</span><span class="n">v</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">	<span class="p">}</span>
</span></span><span class="line"><span class="cl">	<span class="k">return</span> <span class="n">d</span><span class="p">[</span><span class="n">t</span><span class="p">]</span> <span class="o">!=</span> <span class="o">-</span><span class="mi">1</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="kt">int</span> <span class="nf">dfs</span><span class="p">(</span><span class="kt">int</span> <span class="n">u</span><span class="p">,</span> <span class="kt">int</span> <span class="n">f</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">	<span class="kt">int</span> <span class="n">r</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">	<span class="k">if</span><span class="p">(</span><span class="n">u</span> <span class="o">==</span> <span class="n">t</span><span class="p">)</span> <span class="k">return</span> <span class="n">f</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">	<span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">v</span><span class="p">,</span> <span class="n">i</span> <span class="o">=</span> <span class="n">h</span><span class="p">[</span><span class="n">u</span><span class="p">];</span> <span class="o">~</span><span class="n">i</span> <span class="o">&amp;&amp;</span> <span class="n">r</span> <span class="o">&lt;</span> <span class="n">f</span><span class="p">;</span> <span class="n">i</span> <span class="o">=</span> <span class="n">e</span><span class="p">[</span><span class="n">i</span><span class="p">].</span><span class="n">next</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">		<span class="k">if</span><span class="p">(</span><span class="n">d</span><span class="p">[(</span><span class="n">v</span> <span class="o">=</span> <span class="n">e</span><span class="p">[</span><span class="n">i</span><span class="p">].</span><span class="n">to</span><span class="p">)]</span> <span class="o">==</span> <span class="n">d</span><span class="p">[</span><span class="n">u</span><span class="p">]</span> <span class="o">+</span> <span class="mi">1</span> <span class="o">&amp;&amp;</span> <span class="n">e</span><span class="p">[</span><span class="n">i</span><span class="p">].</span><span class="n">w</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">			<span class="kt">int</span> <span class="n">x</span> <span class="o">=</span> <span class="n">dfs</span><span class="p">(</span><span class="n">v</span><span class="p">,</span> <span class="n">min</span><span class="p">(</span><span class="n">e</span><span class="p">[</span><span class="n">i</span><span class="p">].</span><span class="n">w</span><span class="p">,</span> <span class="n">f</span><span class="o">-</span><span class="n">r</span><span class="p">));</span>
</span></span><span class="line"><span class="cl">			<span class="n">e</span><span class="p">[</span><span class="n">i</span><span class="p">].</span><span class="n">w</span> <span class="o">-=</span> <span class="n">x</span><span class="p">;</span> <span class="n">e</span><span class="p">[</span><span class="n">i</span><span class="o">^</span><span class="mi">1</span><span class="p">].</span><span class="n">w</span> <span class="o">+=</span> <span class="n">x</span><span class="p">;</span> <span class="n">r</span> <span class="o">+=</span> <span class="n">x</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">		<span class="p">}</span>
</span></span><span class="line"><span class="cl">	<span class="k">if</span><span class="p">(</span><span class="o">!</span><span class="n">r</span><span class="p">)</span> <span class="n">d</span><span class="p">[</span><span class="n">u</span><span class="p">]</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span><span class="p">;</span> <span class="k">return</span> <span class="n">r</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="kt">int</span> <span class="nf">dinic</span><span class="p">()</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">	<span class="kt">int</span> <span class="n">x</span><span class="p">,</span> <span class="n">ans</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">	<span class="k">while</span><span class="p">(</span><span class="n">bfs</span><span class="p">())</span> <span class="k">while</span><span class="p">(</span><span class="n">x</span> <span class="o">=</span> <span class="n">dfs</span><span class="p">(</span><span class="n">s</span><span class="p">,</span> <span class="mf">1e9</span><span class="p">))</span> <span class="n">ans</span> <span class="o">+=</span> <span class="n">x</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">	<span class="k">return</span> <span class="n">ans</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span></span></span></code></pre></td></tr></table>
</div>
</div><h2 id="线性筛" class="heading-element"><span>线性筛</span>
  <a href="#%e7%ba%bf%e6%80%a7%e7%ad%9b" class="heading-mark">
    <svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg>
  </a>
</h2><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-C++" data-lang="C++"><span class="line"><span class="cl"><span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">2</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;=</span> <span class="n">n</span><span class="p">;</span> <span class="o">++</span><span class="n">i</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">	<span class="k">if</span><span class="p">(</span><span class="o">!</span><span class="n">notp</span><span class="p">[</span><span class="n">i</span><span class="p">])</span> <span class="n">p</span><span class="p">[</span><span class="o">++</span><span class="n">cntp</span><span class="p">]</span> <span class="o">=</span> <span class="n">i</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">	<span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">j</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span> <span class="mi">1ll</span><span class="o">*</span><span class="n">i</span><span class="o">*</span><span class="n">p</span><span class="p">[</span><span class="n">j</span><span class="p">]</span> <span class="o">&lt;=</span> <span class="n">n</span> <span class="o">&amp;&amp;</span> <span class="n">j</span> <span class="o">&lt;=</span> <span class="n">cntp</span><span class="p">;</span> <span class="o">++</span><span class="n">j</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">		<span class="n">notp</span><span class="p">[</span><span class="n">i</span><span class="o">*</span><span class="n">p</span><span class="p">[</span><span class="n">j</span><span class="p">]]</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">		<span class="k">if</span><span class="p">(</span><span class="n">i</span> <span class="o">%</span> <span class="n">p</span><span class="p">[</span><span class="n">j</span><span class="p">]</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="k">break</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">	<span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span></span></span></code></pre></td></tr></table>
</div>
</div><h2 id="左偏树" class="heading-element"><span>左偏树</span>
  <a href="#%e5%b7%a6%e5%81%8f%e6%a0%91" class="heading-mark">
    <svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg>
  </a>
</h2><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-C++" data-lang="C++"><span class="line"><span class="cl"><span class="kt">int</span> <span class="nf">F</span><span class="p">(</span><span class="kt">int</span> <span class="n">x</span><span class="p">)</span> <span class="p">{</span><span class="k">return</span> <span class="n">x</span> <span class="o">==</span> <span class="n">fa</span><span class="p">[</span><span class="n">x</span><span class="p">]</span> <span class="o">?</span> <span class="nl">x</span> <span class="p">:</span> <span class="n">fa</span><span class="p">[</span><span class="n">x</span><span class="p">]</span> <span class="o">=</span> <span class="n">F</span><span class="p">(</span><span class="n">fa</span><span class="p">[</span><span class="n">x</span><span class="p">]);}</span>
</span></span><span class="line"><span class="cl"><span class="kt">int</span> <span class="nf">Merge</span><span class="p">(</span><span class="kt">int</span> <span class="n">x</span><span class="p">,</span> <span class="kt">int</span> <span class="n">y</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">	<span class="k">if</span><span class="p">(</span><span class="n">x</span><span class="o">*</span><span class="n">y</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="k">return</span> <span class="n">x</span><span class="o">+</span><span class="n">y</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">	<span class="k">if</span><span class="p">(</span><span class="n">v</span><span class="p">[</span><span class="n">x</span><span class="p">]</span> <span class="o">&gt;</span> <span class="n">v</span><span class="p">[</span><span class="n">y</span><span class="p">]</span> <span class="o">||</span> <span class="p">(</span><span class="n">v</span><span class="p">[</span><span class="n">x</span><span class="p">]</span> <span class="o">==</span> <span class="n">v</span><span class="p">[</span><span class="n">y</span><span class="p">]</span> <span class="o">&amp;&amp;</span> <span class="n">x</span> <span class="o">&gt;</span> <span class="n">y</span><span class="p">))</span> <span class="n">swap</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">	<span class="n">R</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="o">=</span> <span class="n">Merge</span><span class="p">(</span><span class="n">R</span><span class="p">(</span><span class="n">x</span><span class="p">),</span> <span class="n">y</span><span class="p">);</span> <span class="n">fa</span><span class="p">[</span><span class="n">R</span><span class="p">(</span><span class="n">x</span><span class="p">)]</span> <span class="o">=</span> <span class="n">fa</span><span class="p">[</span><span class="n">L</span><span class="p">(</span><span class="n">x</span><span class="p">)]</span> <span class="o">=</span> <span class="n">x</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">	<span class="k">if</span><span class="p">(</span><span class="n">dis</span><span class="p">[</span><span class="n">R</span><span class="p">(</span><span class="n">x</span><span class="p">)]</span> <span class="o">&gt;</span> <span class="n">dis</span><span class="p">[</span><span class="n">L</span><span class="p">(</span><span class="n">x</span><span class="p">)])</span> <span class="n">swap</span><span class="p">(</span><span class="n">L</span><span class="p">(</span><span class="n">x</span><span class="p">),</span> <span class="n">R</span><span class="p">(</span><span class="n">x</span><span class="p">));</span>
</span></span><span class="line"><span class="cl">	<span class="n">dis</span><span class="p">[</span><span class="n">x</span><span class="p">]</span> <span class="o">=</span> <span class="n">dis</span><span class="p">[</span><span class="n">R</span><span class="p">(</span><span class="n">x</span><span class="p">)]</span> <span class="o">+</span> <span class="mi">1</span><span class="p">;</span> <span class="k">return</span> <span class="n">x</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="kt">int</span> <span class="nf">Top</span><span class="p">(</span><span class="kt">int</span> <span class="n">x</span><span class="p">)</span> <span class="p">{</span><span class="k">return</span> <span class="n">del</span><span class="p">[</span><span class="n">x</span><span class="p">]</span> <span class="o">?</span> <span class="o">-</span><span class="mi">1</span> <span class="o">:</span> <span class="n">v</span><span class="p">[</span><span class="n">x</span><span class="p">];}</span>
</span></span><span class="line"><span class="cl"><span class="kt">void</span> <span class="nf">Pop</span><span class="p">(</span><span class="kt">int</span> <span class="n">x</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">	<span class="k">if</span><span class="p">(</span><span class="n">del</span><span class="p">[</span><span class="n">x</span><span class="p">])</span> <span class="k">return</span><span class="p">;</span> <span class="n">del</span><span class="p">[</span><span class="n">x</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">	<span class="n">fa</span><span class="p">[</span><span class="n">L</span><span class="p">(</span><span class="n">x</span><span class="p">)]</span> <span class="o">=</span> <span class="n">L</span><span class="p">(</span><span class="n">x</span><span class="p">);</span> <span class="n">fa</span><span class="p">[</span><span class="n">R</span><span class="p">(</span><span class="n">x</span><span class="p">)]</span> <span class="o">=</span> <span class="n">R</span><span class="p">(</span><span class="n">x</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">	<span class="n">fa</span><span class="p">[</span><span class="n">x</span><span class="p">]</span> <span class="o">=</span> <span class="n">Merge</span><span class="p">(</span><span class="n">L</span><span class="p">(</span><span class="n">x</span><span class="p">),</span> <span class="n">R</span><span class="p">(</span><span class="n">x</span><span class="p">));</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span></span></span></code></pre></td></tr></table>
</div>
</div><h2 id="lct" class="heading-element"><span>LCT</span>
  <a href="#lct" class="heading-mark">
    <svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg>
  </a>
</h2><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-c++" data-lang="c++"><span class="line"><span class="cl"><span class="kt">bool</span> <span class="nf">nroot</span><span class="p">(</span><span class="kt">int</span> <span class="n">x</span><span class="p">)</span> <span class="p">{</span><span class="k">return</span> <span class="n">ch</span><span class="p">[</span><span class="n">fa</span><span class="p">[</span><span class="n">x</span><span class="p">]][</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="n">x</span> <span class="o">||</span> <span class="n">ch</span><span class="p">[</span><span class="n">fa</span><span class="p">[</span><span class="n">x</span><span class="p">]][</span><span class="mi">1</span><span class="p">]</span> <span class="o">==</span> <span class="n">x</span><span class="p">;}</span>
</span></span><span class="line"><span class="cl"><span class="kt">void</span> <span class="nf">pushup</span><span class="p">(</span><span class="kt">int</span> <span class="n">x</span><span class="p">)</span> <span class="p">{</span><span class="n">sumx</span><span class="p">[</span><span class="n">x</span><span class="p">]</span> <span class="o">=</span> <span class="n">sumx</span><span class="p">[</span><span class="n">ch</span><span class="p">[</span><span class="n">x</span><span class="p">][</span><span class="mi">1</span><span class="p">]]</span> <span class="o">^</span> <span class="n">sumx</span><span class="p">[</span><span class="n">ch</span><span class="p">[</span><span class="n">x</span><span class="p">][</span><span class="mi">0</span><span class="p">]]</span> <span class="o">^</span> <span class="n">val</span><span class="p">[</span><span class="n">x</span><span class="p">];}</span> 
</span></span><span class="line"><span class="cl"><span class="kt">void</span> <span class="nf">pushr</span><span class="p">(</span><span class="kt">int</span> <span class="n">x</span><span class="p">)</span> <span class="p">{</span><span class="n">swap</span><span class="p">(</span><span class="n">ch</span><span class="p">[</span><span class="n">x</span><span class="p">][</span><span class="mi">1</span><span class="p">],</span> <span class="n">ch</span><span class="p">[</span><span class="n">x</span><span class="p">][</span><span class="mi">0</span><span class="p">]);</span> <span class="n">rot</span><span class="p">[</span><span class="n">x</span><span class="p">]</span> <span class="o">^=</span> <span class="mi">1</span><span class="p">;}</span>
</span></span><span class="line"><span class="cl"><span class="kt">void</span> <span class="nf">pushdown</span><span class="p">(</span><span class="kt">int</span> <span class="n">x</span><span class="p">)</span> <span class="p">{</span><span class="k">if</span><span class="p">(</span><span class="n">rot</span><span class="p">[</span><span class="n">x</span><span class="p">])</span> <span class="p">{</span><span class="k">if</span><span class="p">(</span><span class="n">ch</span><span class="p">[</span><span class="n">x</span><span class="p">][</span><span class="mi">0</span><span class="p">])</span> <span class="n">pushr</span><span class="p">(</span><span class="n">ch</span><span class="p">[</span><span class="n">x</span><span class="p">][</span><span class="mi">0</span><span class="p">]);</span> <span class="k">if</span><span class="p">(</span><span class="n">ch</span><span class="p">[</span><span class="n">x</span><span class="p">][</span><span class="mi">1</span><span class="p">])</span> <span class="n">pushr</span><span class="p">(</span><span class="n">ch</span><span class="p">[</span><span class="n">x</span><span class="p">][</span><span class="mi">1</span><span class="p">]);</span> <span class="n">rot</span><span class="p">[</span><span class="n">x</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;}}</span>
</span></span><span class="line"><span class="cl"><span class="kt">void</span> <span class="nf">rotate</span><span class="p">(</span><span class="kt">int</span> <span class="n">x</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">	<span class="kt">int</span> <span class="n">y</span> <span class="o">=</span> <span class="n">fa</span><span class="p">[</span><span class="n">x</span><span class="p">],</span> <span class="n">z</span> <span class="o">=</span> <span class="n">fa</span><span class="p">[</span><span class="n">y</span><span class="p">],</span> <span class="n">k</span> <span class="o">=</span> <span class="p">(</span><span class="n">x</span> <span class="o">==</span> <span class="n">ch</span><span class="p">[</span><span class="n">y</span><span class="p">][</span><span class="mi">1</span><span class="p">]);</span>
</span></span><span class="line"><span class="cl">	<span class="k">if</span><span class="p">(</span><span class="n">nroot</span><span class="p">(</span><span class="n">y</span><span class="p">))</span> <span class="n">ch</span><span class="p">[</span><span class="n">z</span><span class="p">][(</span><span class="n">y</span> <span class="o">==</span> <span class="n">ch</span><span class="p">[</span><span class="n">z</span><span class="p">][</span><span class="mi">1</span><span class="p">])]</span> <span class="o">=</span> <span class="n">x</span><span class="p">;</span> <span class="n">fa</span><span class="p">[</span><span class="n">x</span><span class="p">]</span> <span class="o">=</span> <span class="n">z</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">	<span class="n">ch</span><span class="p">[</span><span class="n">y</span><span class="p">][</span><span class="n">k</span><span class="p">]</span> <span class="o">=</span> <span class="n">ch</span><span class="p">[</span><span class="n">x</span><span class="p">][</span><span class="n">k</span><span class="o">^</span><span class="mi">1</span><span class="p">];</span> <span class="k">if</span><span class="p">(</span><span class="n">ch</span><span class="p">[</span><span class="n">x</span><span class="p">][</span><span class="n">k</span><span class="o">^</span><span class="mi">1</span><span class="p">])</span> <span class="n">fa</span><span class="p">[</span><span class="n">ch</span><span class="p">[</span><span class="n">x</span><span class="p">][</span><span class="n">k</span><span class="o">^</span><span class="mi">1</span><span class="p">]]</span> <span class="o">=</span> <span class="n">y</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">	<span class="n">ch</span><span class="p">[</span><span class="n">x</span><span class="p">][</span><span class="n">k</span><span class="o">^</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">y</span><span class="p">;</span> <span class="n">fa</span><span class="p">[</span><span class="n">y</span><span class="p">]</span> <span class="o">=</span> <span class="n">x</span><span class="p">;</span> <span class="n">pushup</span><span class="p">(</span><span class="n">y</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="kt">void</span> <span class="nf">splay</span><span class="p">(</span><span class="kt">int</span> <span class="n">x</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">	<span class="kt">int</span> <span class="n">y</span> <span class="o">=</span> <span class="n">x</span><span class="p">,</span> <span class="n">z</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">st</span><span class="p">[</span><span class="o">++</span><span class="n">z</span><span class="p">]</span> <span class="o">=</span> <span class="n">y</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">	<span class="k">while</span><span class="p">(</span><span class="n">nroot</span><span class="p">(</span><span class="n">y</span><span class="p">))</span> <span class="n">st</span><span class="p">[</span><span class="o">++</span><span class="n">z</span><span class="p">]</span> <span class="o">=</span> <span class="n">y</span> <span class="o">=</span> <span class="n">fa</span><span class="p">[</span><span class="n">y</span><span class="p">];</span> <span class="k">while</span><span class="p">(</span><span class="n">z</span><span class="p">)</span> <span class="n">pushdown</span><span class="p">(</span><span class="n">st</span><span class="p">[</span><span class="n">z</span><span class="o">--</span><span class="p">]);</span>
</span></span><span class="line"><span class="cl">	<span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">y</span><span class="p">;</span> <span class="n">nroot</span><span class="p">(</span><span class="n">x</span><span class="p">);</span> <span class="n">rotate</span><span class="p">(</span><span class="n">x</span><span class="p">))</span> <span class="k">if</span><span class="p">(</span><span class="n">nroot</span><span class="p">(</span><span class="n">y</span> <span class="o">=</span> <span class="n">fa</span><span class="p">[</span><span class="n">x</span><span class="p">]))</span> <span class="n">rotate</span><span class="p">((</span><span class="n">y</span> <span class="o">==</span> <span class="n">ch</span><span class="p">[</span><span class="n">fa</span><span class="p">[</span><span class="n">y</span><span class="p">]][</span><span class="mi">0</span><span class="p">])</span> <span class="o">^</span> <span class="p">(</span><span class="n">x</span> <span class="o">==</span> <span class="n">ch</span><span class="p">[</span><span class="n">y</span><span class="p">][</span><span class="mi">0</span><span class="p">])</span> <span class="o">?</span> <span class="nl">x</span> <span class="p">:</span> <span class="n">y</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">	<span class="n">pushup</span><span class="p">(</span><span class="n">x</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="kt">void</span> <span class="nf">access</span><span class="p">(</span><span class="kt">int</span> <span class="n">x</span><span class="p">)</span> <span class="p">{</span><span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">y</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">x</span><span class="p">;</span> <span class="n">x</span> <span class="o">=</span> <span class="n">fa</span><span class="p">[</span><span class="n">y</span> <span class="o">=</span> <span class="n">x</span><span class="p">])</span> <span class="n">splay</span><span class="p">(</span><span class="n">x</span><span class="p">),</span> <span class="n">ch</span><span class="p">[</span><span class="n">x</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">y</span><span class="p">,</span> <span class="n">pushup</span><span class="p">(</span><span class="n">x</span><span class="p">);}</span>
</span></span><span class="line"><span class="cl"><span class="kt">void</span> <span class="nf">makeroot</span><span class="p">(</span><span class="kt">int</span> <span class="n">x</span><span class="p">)</span> <span class="p">{</span><span class="n">access</span><span class="p">(</span><span class="n">x</span><span class="p">);</span> <span class="n">splay</span><span class="p">(</span><span class="n">x</span><span class="p">);</span> <span class="n">pushr</span><span class="p">(</span><span class="n">x</span><span class="p">);}</span>
</span></span><span class="line"><span class="cl"><span class="kt">int</span> <span class="nf">findroot</span><span class="p">(</span><span class="kt">int</span> <span class="n">x</span><span class="p">)</span> <span class="p">{</span><span class="n">access</span><span class="p">(</span><span class="n">x</span><span class="p">);</span> <span class="n">splay</span><span class="p">(</span><span class="n">x</span><span class="p">);</span> <span class="k">for</span><span class="p">(;</span> <span class="n">ch</span><span class="p">[</span><span class="n">x</span><span class="p">][</span><span class="mi">0</span><span class="p">];</span> <span class="n">x</span> <span class="o">=</span> <span class="n">ch</span><span class="p">[</span><span class="n">x</span><span class="p">][</span><span class="mi">0</span><span class="p">])</span> <span class="n">pushdown</span><span class="p">(</span><span class="n">x</span><span class="p">);</span> <span class="n">splay</span><span class="p">(</span><span class="n">x</span><span class="p">);</span> <span class="k">return</span> <span class="n">x</span><span class="p">;}</span>
</span></span><span class="line"><span class="cl"><span class="kt">void</span> <span class="nf">spilit</span><span class="p">(</span><span class="kt">int</span> <span class="n">x</span><span class="p">,</span> <span class="kt">int</span> <span class="n">y</span><span class="p">)</span> <span class="p">{</span><span class="n">makeroot</span><span class="p">(</span><span class="n">x</span><span class="p">);</span> <span class="n">access</span><span class="p">(</span><span class="n">y</span><span class="p">);</span> <span class="n">splay</span><span class="p">(</span><span class="n">y</span><span class="p">);}</span>
</span></span><span class="line"><span class="cl"><span class="kt">void</span> <span class="nf">link</span><span class="p">(</span><span class="kt">int</span> <span class="n">x</span><span class="p">,</span> <span class="kt">int</span> <span class="n">y</span><span class="p">)</span> <span class="p">{</span><span class="n">makeroot</span><span class="p">(</span><span class="n">x</span><span class="p">);</span> <span class="k">if</span><span class="p">(</span><span class="n">findroot</span><span class="p">(</span><span class="n">y</span><span class="p">)</span> <span class="o">!=</span> <span class="n">x</span><span class="p">)</span> <span class="n">fa</span><span class="p">[</span><span class="n">x</span><span class="p">]</span> <span class="o">=</span> <span class="n">y</span><span class="p">;}</span>
</span></span><span class="line"><span class="cl"><span class="kt">void</span> <span class="nf">cut</span><span class="p">(</span><span class="kt">int</span> <span class="n">x</span><span class="p">,</span> <span class="kt">int</span> <span class="n">y</span><span class="p">)</span> <span class="p">{</span><span class="n">makeroot</span><span class="p">(</span><span class="n">x</span><span class="p">);</span> <span class="k">if</span><span class="p">(</span><span class="n">findroot</span><span class="p">(</span><span class="n">y</span><span class="p">)</span> <span class="o">==</span> <span class="n">x</span> <span class="o">&amp;&amp;</span> <span class="n">fa</span><span class="p">[</span><span class="n">y</span><span class="p">]</span> <span class="o">==</span> <span class="n">x</span> <span class="o">&amp;&amp;</span> <span class="o">!</span><span class="n">ch</span><span class="p">[</span><span class="n">y</span><span class="p">][</span><span class="mi">0</span><span class="p">])</span> <span class="p">{</span><span class="n">fa</span><span class="p">[</span><span class="n">y</span><span class="p">]</span> <span class="o">=</span> <span class="n">ch</span><span class="p">[</span><span class="n">x</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">pushup</span><span class="p">(</span><span class="n">x</span><span class="p">);}}</span></span></span></code></pre></td></tr></table>
</div>
</div><h2 id="kmp" class="heading-element"><span>KMP</span>
  <a href="#kmp" class="heading-mark">
    <svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg>
  </a>
</h2><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span><span class="lnt">8
</span><span class="lnt">9
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-C++" data-lang="C++"><span class="line"><span class="cl"><span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">2</span><span class="p">,</span> <span class="n">j</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;=</span> <span class="n">n</span><span class="p">;</span> <span class="o">++</span><span class="n">i</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">	<span class="k">while</span><span class="p">(</span><span class="n">j</span> <span class="o">&amp;&amp;</span> <span class="n">s</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">!=</span> <span class="n">s</span><span class="p">[</span><span class="n">j</span><span class="o">+</span><span class="mi">1</span><span class="p">])</span> <span class="n">j</span> <span class="o">=</span> <span class="n">nxt</span><span class="p">[</span><span class="n">j</span><span class="p">];</span>
</span></span><span class="line"><span class="cl">	<span class="k">if</span><span class="p">(</span><span class="n">s</span><span class="p">[</span><span class="n">j</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span> <span class="o">==</span> <span class="n">s</span><span class="p">[</span><span class="n">i</span><span class="p">])</span> <span class="o">++</span><span class="n">j</span><span class="p">;</span> <span class="n">nxt</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">j</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">j</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;=</span> <span class="n">m</span><span class="p">;</span> <span class="o">++</span><span class="n">i</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">	<span class="k">while</span><span class="p">(</span><span class="n">j</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="o">&amp;&amp;</span> <span class="n">t</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">!=</span> <span class="n">s</span><span class="p">[</span><span class="n">j</span><span class="o">+</span><span class="mi">1</span><span class="p">])</span> <span class="n">j</span> <span class="o">=</span> <span class="n">nxt</span><span class="p">[</span><span class="n">j</span><span class="p">];</span>
</span></span><span class="line"><span class="cl">	<span class="k">if</span><span class="p">(</span><span class="n">s</span><span class="p">[</span><span class="n">j</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span> <span class="o">==</span> <span class="n">t</span><span class="p">[</span><span class="n">i</span><span class="p">])</span> <span class="o">++</span><span class="n">j</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">	<span class="k">if</span><span class="p">(</span><span class="n">j</span> <span class="o">==</span> <span class="n">n</span><span class="p">)</span> <span class="n">printf</span><span class="p">(</span><span class="s">&#34;%d</span><span class="se">\n</span><span class="s">&#34;</span><span class="p">,</span> <span class="n">i</span><span class="o">-</span><span class="n">n</span><span class="o">+</span><span class="mi">1</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span></span></span></code></pre></td></tr></table>
</div>
</div><h2 id="sam" class="heading-element"><span>SAM</span>
  <a href="#sam" class="heading-mark">
    <svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg>
  </a>
</h2><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-C++" data-lang="C++"><span class="line"><span class="cl"><span class="k">struct</span> <span class="nc">SoumAsuMire</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">	<span class="kt">int</span> <span class="n">ch</span><span class="p">[</span><span class="n">MAXN</span><span class="p">][</span><span class="mi">26</span><span class="p">],</span> <span class="n">fa</span><span class="p">[</span><span class="n">MAXN</span><span class="p">],</span> <span class="n">last</span><span class="p">,</span> <span class="n">cnt</span><span class="p">,</span> <span class="n">len</span><span class="p">[</span><span class="n">MAXN</span><span class="p">];</span>
</span></span><span class="line"><span class="cl">	<span class="kt">void</span> <span class="nf">insert</span><span class="p">(</span><span class="kt">int</span> <span class="n">c</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">		<span class="kt">int</span> <span class="n">p</span> <span class="o">=</span> <span class="n">last</span><span class="p">,</span> <span class="n">np</span> <span class="o">=</span> <span class="o">++</span><span class="n">cnt</span><span class="p">;</span> <span class="n">last</span> <span class="o">=</span> <span class="n">np</span><span class="p">;</span> <span class="n">len</span><span class="p">[</span><span class="n">np</span><span class="p">]</span> <span class="o">=</span> <span class="n">len</span><span class="p">[</span><span class="n">p</span><span class="p">]</span> <span class="o">+</span> <span class="mi">1</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">		<span class="k">for</span><span class="p">(;</span> <span class="n">p</span> <span class="o">&amp;&amp;</span> <span class="o">!</span><span class="n">ch</span><span class="p">[</span><span class="n">p</span><span class="p">][</span><span class="n">c</span><span class="p">];</span> <span class="n">ch</span><span class="p">[</span><span class="n">p</span><span class="p">][</span><span class="n">c</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="p">,</span> <span class="n">p</span> <span class="o">=</span> <span class="n">fa</span><span class="p">[</span><span class="n">p</span><span class="p">]);</span>
</span></span><span class="line"><span class="cl">		<span class="k">if</span><span class="p">(</span><span class="o">!</span><span class="n">p</span><span class="p">)</span> <span class="n">fa</span><span class="p">[</span><span class="n">np</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">		<span class="k">else</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">			<span class="kt">int</span> <span class="n">q</span> <span class="o">=</span> <span class="n">ch</span><span class="p">[</span><span class="n">p</span><span class="p">][</span><span class="n">c</span><span class="p">];</span>
</span></span><span class="line"><span class="cl">			<span class="k">if</span><span class="p">(</span><span class="n">len</span><span class="p">[</span><span class="n">q</span><span class="p">]</span> <span class="o">==</span> <span class="n">len</span><span class="p">[</span><span class="n">p</span><span class="p">]</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="n">fa</span><span class="p">[</span><span class="n">np</span><span class="p">]</span> <span class="o">=</span> <span class="n">q</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">			<span class="k">else</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">				<span class="kt">int</span> <span class="n">nq</span> <span class="o">=</span> <span class="o">++</span><span class="n">cnt</span><span class="p">;</span> <span class="n">len</span><span class="p">[</span><span class="n">nq</span><span class="p">]</span> <span class="o">=</span> <span class="n">len</span><span class="p">[</span><span class="n">p</span><span class="p">]</span> <span class="o">+</span> <span class="mi">1</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">				<span class="n">memcpy</span><span class="p">(</span><span class="n">ch</span><span class="p">[</span><span class="n">nq</span><span class="p">],</span> <span class="n">ch</span><span class="p">[</span><span class="n">q</span><span class="p">],</span> <span class="k">sizeof</span> <span class="n">ch</span><span class="p">[</span><span class="n">q</span><span class="p">]);</span>
</span></span><span class="line"><span class="cl">				<span class="n">fa</span><span class="p">[</span><span class="n">nq</span><span class="p">]</span> <span class="o">=</span> <span class="n">fa</span><span class="p">[</span><span class="n">q</span><span class="p">];</span> <span class="n">fa</span><span class="p">[</span><span class="n">q</span><span class="p">]</span> <span class="o">=</span> <span class="n">fa</span><span class="p">[</span><span class="n">np</span><span class="p">]</span> <span class="o">=</span> <span class="n">nq</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">				<span class="k">for</span><span class="p">(;</span> <span class="n">p</span> <span class="o">&amp;&amp;</span> <span class="n">ch</span><span class="p">[</span><span class="n">p</span><span class="p">][</span><span class="n">c</span><span class="p">]</span> <span class="o">==</span> <span class="n">q</span><span class="p">;</span> <span class="n">ch</span><span class="p">[</span><span class="n">p</span><span class="p">][</span><span class="n">c</span><span class="p">]</span> <span class="o">=</span> <span class="n">nq</span><span class="p">,</span> <span class="n">p</span> <span class="o">=</span> <span class="n">fa</span><span class="p">[</span><span class="n">p</span><span class="p">]);</span>
</span></span><span class="line"><span class="cl">			<span class="p">}</span>
</span></span><span class="line"><span class="cl">		<span class="p">}</span>
</span></span><span class="line"><span class="cl">	<span class="p">}</span>
</span></span><span class="line"><span class="cl">	<span class="kt">void</span> <span class="nf">build</span><span class="p">(</span><span class="kt">char</span> <span class="o">*</span><span class="n">s</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">		<span class="kt">int</span> <span class="n">n</span> <span class="o">=</span> <span class="n">strlen</span><span class="p">(</span><span class="n">s</span><span class="o">+</span><span class="mi">1</span><span class="p">);</span> <span class="n">last</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">		<span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;=</span> <span class="n">n</span><span class="p">;</span> <span class="o">++</span><span class="n">i</span><span class="p">)</span> <span class="n">insert</span><span class="p">(</span><span class="n">s</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">-</span> <span class="sc">&#39;a&#39;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">	<span class="p">}</span>
</span></span><span class="line"><span class="cl">	<span class="kt">int</span> <span class="nf">getans</span><span class="p">()</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">		<span class="kt">int</span> <span class="n">ans</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">		<span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">2</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;=</span> <span class="n">cnt</span><span class="p">;</span> <span class="o">++</span><span class="n">i</span><span class="p">)</span> <span class="n">ans</span> <span class="o">+=</span> <span class="n">len</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">-</span> <span class="n">len</span><span class="p">[</span><span class="n">fa</span><span class="p">[</span><span class="n">i</span><span class="p">]];</span>
</span></span><span class="line"><span class="cl">		<span class="k">return</span> <span class="n">ans</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">	<span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span> <span class="n">SAM</span><span class="p">;</span></span></span></code></pre></td></tr></table>
</div>
</div><h2 id="lcast" class="heading-element"><span>LCA(ST)</span>
  <a href="#lcast" class="heading-mark">
    <svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg>
  </a>
</h2><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-C++" data-lang="C++"><span class="line"><span class="cl"><span class="kt">void</span> <span class="nf">dfsRMQ</span><span class="p">(</span><span class="kt">int</span> <span class="n">u</span><span class="p">,</span> <span class="kt">int</span> <span class="n">p</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">	<span class="n">st</span><span class="p">[</span><span class="o">++</span><span class="n">idx</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">u</span><span class="p">;</span> <span class="n">dfn</span><span class="p">[</span><span class="n">u</span><span class="p">]</span> <span class="o">=</span> <span class="n">idx</span><span class="p">;</span> <span class="n">dep</span><span class="p">[</span><span class="n">u</span><span class="p">]</span> <span class="o">=</span> <span class="n">dep</span><span class="p">[</span><span class="n">p</span><span class="p">]</span> <span class="o">+</span> <span class="mi">1</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">	<span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">v</span><span class="p">,</span> <span class="n">i</span> <span class="o">=</span> <span class="n">h</span><span class="p">[</span><span class="n">u</span><span class="p">];</span> <span class="o">~</span><span class="n">i</span><span class="p">;</span> <span class="n">i</span> <span class="o">=</span> <span class="n">e</span><span class="p">[</span><span class="n">i</span><span class="p">].</span><span class="n">next</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">		<span class="k">if</span><span class="p">((</span><span class="n">v</span> <span class="o">=</span> <span class="n">e</span><span class="p">[</span><span class="n">i</span><span class="p">].</span><span class="n">to</span><span class="p">)</span> <span class="o">!=</span> <span class="n">p</span><span class="p">)</span> <span class="n">dfsRMQ</span><span class="p">(</span><span class="n">v</span><span class="p">,</span> <span class="n">u</span><span class="p">),</span> <span class="n">st</span><span class="p">[</span><span class="o">++</span><span class="n">idx</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">u</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="kt">void</span> <span class="nf">LCAinit</span><span class="p">()</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">	<span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">2</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;=</span> <span class="p">(</span><span class="n">n</span> <span class="o">&lt;&lt;</span> <span class="mi">1</span><span class="p">);</span> <span class="o">++</span><span class="n">i</span><span class="p">)</span> <span class="n">lg2</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">lg2</span><span class="p">[</span><span class="n">i</span><span class="o">&gt;&gt;</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="mi">1</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">	<span class="n">dep</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span> <span class="n">dfsRMQ</span><span class="p">(</span><span class="n">rt</span><span class="p">,</span> <span class="mi">0</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">	<span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">j</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span> <span class="n">j</span> <span class="o">&lt;</span> <span class="mi">20</span><span class="p">;</span> <span class="o">++</span><span class="n">j</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">		<span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span> <span class="n">i</span> <span class="o">+</span> <span class="p">(</span><span class="mi">1</span> <span class="o">&lt;&lt;</span> <span class="n">j</span><span class="p">)</span> <span class="o">&lt;=</span> <span class="p">(</span><span class="n">n</span> <span class="o">&lt;&lt;</span> <span class="mi">1</span><span class="p">);</span> <span class="o">++</span><span class="n">i</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">			<span class="n">st</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="n">Min</span><span class="p">(</span><span class="n">st</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="n">st</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="p">(</span><span class="mi">1</span><span class="o">&lt;&lt;</span><span class="p">(</span><span class="n">j</span><span class="o">-</span><span class="mi">1</span><span class="p">))][</span><span class="n">j</span><span class="o">-</span><span class="mi">1</span><span class="p">]);</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="kt">int</span> <span class="nf">LCA</span><span class="p">(</span><span class="kt">int</span> <span class="n">x</span><span class="p">,</span> <span class="kt">int</span> <span class="n">y</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">	<span class="n">x</span> <span class="o">=</span> <span class="n">dfn</span><span class="p">[</span><span class="n">x</span><span class="p">];</span> <span class="n">y</span> <span class="o">=</span> <span class="n">dfn</span><span class="p">[</span><span class="n">y</span><span class="p">];</span>
</span></span><span class="line"><span class="cl">	<span class="k">if</span><span class="p">(</span><span class="n">x</span> <span class="o">&gt;</span> <span class="n">y</span><span class="p">)</span> <span class="n">swap</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">	<span class="kt">int</span> <span class="n">k</span> <span class="o">=</span> <span class="n">lg2</span><span class="p">[</span><span class="n">y</span><span class="o">-</span><span class="n">x</span><span class="o">+</span><span class="mi">1</span><span class="p">];</span>
</span></span><span class="line"><span class="cl">	<span class="k">return</span> <span class="n">Min</span><span class="p">(</span><span class="n">st</span><span class="p">[</span><span class="n">x</span><span class="p">][</span><span class="n">k</span><span class="p">],</span> <span class="n">st</span><span class="p">[</span><span class="n">y</span><span class="o">-</span><span class="p">(</span><span class="mi">1</span><span class="o">&lt;&lt;</span><span class="n">k</span><span class="p">)</span><span class="o">+</span><span class="mi">1</span><span class="p">][</span><span class="n">k</span><span class="p">]);</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span></span></span></code></pre></td></tr></table>
</div>
</div><h2 id="mcmf" class="heading-element"><span>mcmf</span>
  <a href="#mcmf" class="heading-mark">
    <svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg>
  </a>
</h2><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-C++" data-lang="C++"><span class="line"><span class="cl"><span class="kt">bool</span> <span class="nf">SPFA</span><span class="p">()</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">	<span class="n">memset</span><span class="p">(</span><span class="n">d</span><span class="p">,</span> <span class="mi">63</span><span class="p">,</span> <span class="k">sizeof</span> <span class="n">d</span><span class="p">);</span> <span class="n">memset</span><span class="p">(</span><span class="n">vis</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="k">sizeof</span> <span class="n">vis</span><span class="p">);</span> <span class="n">memset</span><span class="p">(</span><span class="n">flow</span><span class="p">,</span> <span class="mi">63</span><span class="p">,</span> <span class="k">sizeof</span> <span class="n">flow</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">	<span class="n">queue</span> <span class="o">&lt;</span><span class="kt">int</span><span class="o">&gt;</span> <span class="n">q</span><span class="p">;</span> <span class="n">q</span><span class="p">.</span><span class="n">push</span><span class="p">(</span><span class="n">s</span><span class="p">);</span> <span class="n">d</span><span class="p">[</span><span class="n">s</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">vis</span><span class="p">[</span><span class="n">s</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">	<span class="k">while</span><span class="p">(</span><span class="o">!</span><span class="n">q</span><span class="p">.</span><span class="n">empty</span><span class="p">())</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">		<span class="kt">int</span> <span class="n">u</span> <span class="o">=</span> <span class="n">q</span><span class="p">.</span><span class="n">front</span><span class="p">();</span> <span class="n">q</span><span class="p">.</span><span class="n">pop</span><span class="p">();</span> <span class="n">vis</span><span class="p">[</span><span class="n">u</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">		<span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">v</span><span class="p">,</span> <span class="n">i</span> <span class="o">=</span> <span class="n">h</span><span class="p">[</span><span class="n">u</span><span class="p">];</span> <span class="o">~</span><span class="n">i</span><span class="p">;</span> <span class="n">i</span> <span class="o">=</span> <span class="n">e</span><span class="p">[</span><span class="n">i</span><span class="p">].</span><span class="n">next</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">			<span class="k">if</span><span class="p">(</span><span class="n">d</span><span class="p">[</span><span class="n">v</span> <span class="o">=</span> <span class="n">e</span><span class="p">[</span><span class="n">i</span><span class="p">].</span><span class="n">to</span><span class="p">]</span> <span class="o">&gt;</span> <span class="n">d</span><span class="p">[</span><span class="n">u</span><span class="p">]</span> <span class="o">+</span> <span class="n">e</span><span class="p">[</span><span class="n">i</span><span class="p">].</span><span class="n">c</span> <span class="o">&amp;&amp;</span> <span class="n">e</span><span class="p">[</span><span class="n">i</span><span class="p">].</span><span class="n">f</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">				<span class="n">d</span><span class="p">[</span><span class="n">v</span><span class="p">]</span> <span class="o">=</span> <span class="n">d</span><span class="p">[</span><span class="n">u</span><span class="p">]</span> <span class="o">+</span> <span class="n">e</span><span class="p">[</span><span class="n">i</span><span class="p">].</span><span class="n">c</span><span class="p">;</span> <span class="n">pos</span><span class="p">[</span><span class="n">v</span><span class="p">]</span> <span class="o">=</span> <span class="n">i</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">				<span class="n">fa</span><span class="p">[</span><span class="n">v</span><span class="p">]</span> <span class="o">=</span> <span class="n">u</span><span class="p">;</span> <span class="n">flow</span><span class="p">[</span><span class="n">v</span><span class="p">]</span> <span class="o">=</span> <span class="n">min</span><span class="p">(</span><span class="n">flow</span><span class="p">[</span><span class="n">u</span><span class="p">],</span> <span class="n">e</span><span class="p">[</span><span class="n">i</span><span class="p">].</span><span class="n">f</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">				<span class="k">if</span><span class="p">(</span><span class="o">!</span><span class="n">vis</span><span class="p">[</span><span class="n">v</span><span class="p">])</span> <span class="n">vis</span><span class="p">[</span><span class="n">v</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">q</span><span class="p">.</span><span class="n">push</span><span class="p">(</span><span class="n">v</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">			<span class="p">}</span>
</span></span><span class="line"><span class="cl">	<span class="p">}</span> <span class="k">return</span> <span class="n">flow</span><span class="p">[</span><span class="n">s</span><span class="p">]</span> <span class="o">!=</span> <span class="n">flow</span><span class="p">[</span><span class="n">t</span><span class="p">];</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="kt">void</span> <span class="nf">mcmf</span><span class="p">()</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">	<span class="k">while</span><span class="p">(</span><span class="n">SPFA</span><span class="p">())</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">		<span class="n">mc</span> <span class="o">+=</span> <span class="n">flow</span><span class="p">[</span><span class="n">t</span><span class="p">];</span> <span class="n">mf</span> <span class="o">+=</span> <span class="n">flow</span><span class="p">[</span><span class="n">t</span><span class="p">]</span> <span class="o">*</span> <span class="n">d</span><span class="p">[</span><span class="n">t</span><span class="p">];</span>
</span></span><span class="line"><span class="cl">		<span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">u</span> <span class="o">=</span> <span class="n">t</span><span class="p">;</span> <span class="n">u</span> <span class="o">!=</span> <span class="n">s</span><span class="p">;</span> <span class="n">u</span> <span class="o">=</span> <span class="n">fa</span><span class="p">[</span><span class="n">u</span><span class="p">])</span> <span class="n">e</span><span class="p">[</span><span class="n">pos</span><span class="p">[</span><span class="n">u</span><span class="p">]].</span><span class="n">f</span> <span class="o">-=</span> <span class="n">flow</span><span class="p">[</span><span class="n">t</span><span class="p">],</span> <span class="n">e</span><span class="p">[</span><span class="n">pos</span><span class="p">[</span><span class="n">u</span><span class="p">]</span><span class="o">^</span><span class="mi">1</span><span class="p">].</span><span class="n">f</span> <span class="o">+=</span> <span class="n">flow</span><span class="p">[</span><span class="n">t</span><span class="p">];</span>
</span></span><span class="line"><span class="cl">	<span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span></span></span></code></pre></td></tr></table>
</div>
</div><h2 id="ac自动机" class="heading-element"><span>AC自动机</span>
  <a href="#ac%e8%87%aa%e5%8a%a8%e6%9c%ba" class="heading-mark">
    <svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg>
  </a>
</h2><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-c++" data-lang="c++"><span class="line"><span class="cl"><span class="cp">#include</span> <span class="cpf">&lt;bits/stdc++.h&gt;</span><span class="cp">
</span></span></span><span class="line"><span class="cl"><span class="cp"></span><span class="k">using</span> <span class="k">namespace</span> <span class="n">std</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="k">const</span> <span class="kt">int</span> <span class="n">S</span> <span class="o">=</span> <span class="mi">2000050</span><span class="p">,</span> <span class="n">T</span> <span class="o">=</span> <span class="mi">200050</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="k">struct</span> <span class="nc">Edge</span> <span class="p">{</span><span class="kt">int</span> <span class="n">to</span><span class="p">,</span> <span class="n">next</span><span class="p">;}</span> <span class="n">e</span><span class="p">[</span><span class="n">T</span><span class="p">];</span>
</span></span><span class="line"><span class="cl"><span class="kt">char</span> <span class="n">s</span><span class="p">[</span><span class="n">S</span><span class="p">];</span> <span class="kt">int</span> <span class="n">n</span><span class="p">,</span> <span class="n">h</span><span class="p">[</span><span class="n">T</span><span class="p">],</span> <span class="n">cnt</span><span class="p">,</span> <span class="n">ch</span><span class="p">[</span><span class="n">T</span><span class="p">][</span><span class="mi">26</span><span class="p">],</span> <span class="n">fail</span><span class="p">[</span><span class="n">T</span><span class="p">],</span> <span class="n">match</span><span class="p">[</span><span class="n">T</span><span class="p">],</span> <span class="n">siz</span><span class="p">[</span><span class="n">T</span><span class="p">],</span> <span class="n">tot</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">en</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="n">queue</span> <span class="o">&lt;</span><span class="kt">int</span><span class="o">&gt;</span> <span class="n">q</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="kt">void</span> <span class="nf">addedge</span><span class="p">(</span><span class="kt">int</span> <span class="n">u</span><span class="p">,</span> <span class="kt">int</span> <span class="n">v</span><span class="p">)</span> <span class="p">{</span><span class="n">e</span><span class="p">[</span><span class="n">en</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="n">Edge</span><span class="p">)</span> <span class="p">{</span><span class="n">v</span><span class="p">,</span> <span class="n">h</span><span class="p">[</span><span class="n">u</span><span class="p">]};</span> <span class="n">h</span><span class="p">[</span><span class="n">u</span><span class="p">]</span> <span class="o">=</span> <span class="n">en</span><span class="o">++</span><span class="p">;}</span>
</span></span><span class="line"><span class="cl"><span class="kt">void</span> <span class="nf">dfs</span><span class="p">(</span><span class="kt">int</span> <span class="n">u</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">	<span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">v</span><span class="p">,</span> <span class="n">i</span> <span class="o">=</span> <span class="n">h</span><span class="p">[</span><span class="n">u</span><span class="p">];</span> <span class="o">~</span><span class="n">i</span><span class="p">;</span> <span class="n">i</span> <span class="o">=</span> <span class="n">e</span><span class="p">[</span><span class="n">i</span><span class="p">].</span><span class="n">next</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">		<span class="n">dfs</span><span class="p">(</span><span class="n">v</span> <span class="o">=</span> <span class="n">e</span><span class="p">[</span><span class="n">i</span><span class="p">].</span><span class="n">to</span><span class="p">),</span> <span class="n">siz</span><span class="p">[</span><span class="n">u</span><span class="p">]</span> <span class="o">+=</span> <span class="n">siz</span><span class="p">[</span><span class="n">v</span><span class="p">];</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="kt">int</span> <span class="nf">main</span><span class="p">()</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">	<span class="n">scanf</span><span class="p">(</span><span class="s">&#34;%d&#34;</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">n</span><span class="p">);</span> <span class="n">memset</span><span class="p">(</span><span class="n">h</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="k">sizeof</span> <span class="n">h</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">	<span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;=</span> <span class="n">n</span><span class="p">;</span> <span class="o">++</span><span class="n">i</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">		<span class="n">scanf</span><span class="p">(</span><span class="s">&#34;%s&#34;</span><span class="p">,</span> <span class="n">s</span><span class="p">);</span> <span class="kt">int</span> <span class="n">u</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">j</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">		<span class="k">for</span><span class="p">(</span><span class="n">u</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">j</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">s</span><span class="p">[</span><span class="n">j</span><span class="p">];</span> <span class="o">++</span><span class="n">j</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">			<span class="kt">int</span> <span class="n">c</span> <span class="o">=</span> <span class="n">s</span><span class="p">[</span><span class="n">j</span><span class="p">]</span> <span class="o">-</span> <span class="sc">&#39;a&#39;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">			<span class="k">if</span><span class="p">(</span><span class="o">!</span><span class="n">ch</span><span class="p">[</span><span class="n">u</span><span class="p">][</span><span class="n">c</span><span class="p">])</span> <span class="n">ch</span><span class="p">[</span><span class="n">u</span><span class="p">][</span><span class="n">c</span><span class="p">]</span> <span class="o">=</span> <span class="o">++</span><span class="n">tot</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">			<span class="n">u</span> <span class="o">=</span> <span class="n">ch</span><span class="p">[</span><span class="n">u</span><span class="p">][</span><span class="n">c</span><span class="p">];</span>
</span></span><span class="line"><span class="cl">		<span class="p">}</span> <span class="n">match</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">u</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">	<span class="p">}</span>
</span></span><span class="line"><span class="cl">	<span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="mi">26</span><span class="p">;</span> <span class="o">++</span><span class="n">i</span><span class="p">)</span> <span class="n">ch</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">	<span class="n">q</span><span class="p">.</span><span class="n">push</span><span class="p">(</span><span class="mi">1</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">	<span class="k">while</span><span class="p">(</span><span class="o">!</span><span class="n">q</span><span class="p">.</span><span class="n">empty</span><span class="p">())</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">		<span class="kt">int</span> <span class="n">u</span> <span class="o">=</span> <span class="n">q</span><span class="p">.</span><span class="n">front</span><span class="p">();</span> <span class="n">q</span><span class="p">.</span><span class="n">pop</span><span class="p">();</span>
</span></span><span class="line"><span class="cl">		<span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="mi">26</span><span class="p">;</span> <span class="o">++</span><span class="n">i</span><span class="p">)</span> 
</span></span><span class="line"><span class="cl">			<span class="k">if</span><span class="p">(</span><span class="n">ch</span><span class="p">[</span><span class="n">u</span><span class="p">][</span><span class="n">i</span><span class="p">])</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">				<span class="n">fail</span><span class="p">[</span><span class="n">ch</span><span class="p">[</span><span class="n">u</span><span class="p">][</span><span class="n">i</span><span class="p">]]</span> <span class="o">=</span> <span class="n">ch</span><span class="p">[</span><span class="n">fail</span><span class="p">[</span><span class="n">u</span><span class="p">]][</span><span class="n">i</span><span class="p">];</span>
</span></span><span class="line"><span class="cl">				<span class="n">q</span><span class="p">.</span><span class="n">push</span><span class="p">(</span><span class="n">ch</span><span class="p">[</span><span class="n">u</span><span class="p">][</span><span class="n">i</span><span class="p">]);</span>
</span></span><span class="line"><span class="cl">			<span class="p">}</span> <span class="k">else</span> <span class="n">ch</span><span class="p">[</span><span class="n">u</span><span class="p">][</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">ch</span><span class="p">[</span><span class="n">fail</span><span class="p">[</span><span class="n">u</span><span class="p">]][</span><span class="n">i</span><span class="p">];</span>
</span></span><span class="line"><span class="cl">	<span class="p">}</span>
</span></span><span class="line"><span class="cl">	<span class="n">scanf</span><span class="p">(</span><span class="s">&#34;%s&#34;</span><span class="p">,</span> <span class="n">s</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">	<span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">u</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">s</span><span class="p">[</span><span class="n">i</span><span class="p">];</span> <span class="o">++</span><span class="n">i</span><span class="p">)</span> <span class="o">++</span><span class="n">siz</span><span class="p">[</span><span class="n">u</span> <span class="o">=</span> <span class="n">ch</span><span class="p">[</span><span class="n">u</span><span class="p">][</span><span class="n">s</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">-</span><span class="sc">&#39;a&#39;</span><span class="p">]];</span>
</span></span><span class="line"><span class="cl">	<span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">2</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;=</span> <span class="n">tot</span><span class="p">;</span> <span class="o">++</span><span class="n">i</span><span class="p">)</span> <span class="n">addedge</span><span class="p">(</span><span class="n">fail</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">i</span><span class="p">);</span> <span class="n">dfs</span><span class="p">(</span><span class="mi">1</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">	<span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;=</span> <span class="n">n</span><span class="p">;</span> <span class="o">++</span><span class="n">i</span><span class="p">)</span> <span class="n">printf</span><span class="p">(</span><span class="s">&#34;%d</span><span class="se">\n</span><span class="s">&#34;</span><span class="p">,</span> <span class="n">siz</span><span class="p">[</span><span class="n">match</span><span class="p">[</span><span class="n">i</span><span class="p">]]);</span>
</span></span><span class="line"><span class="cl">	<span class="n">puts</span><span class="p">(</span><span class="s">&#34;&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span></span></span></code></pre></td></tr></table>
</div>
</div><h2 id="dijkstra" class="heading-element"><span>dijkstra</span>
  <a href="#dijkstra" class="heading-mark">
    <svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg>
  </a>
</h2><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-C++" data-lang="C++"><span class="line"><span class="cl"><span class="kt">void</span> <span class="nf">dijkstra</span><span class="p">()</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">	<span class="n">memset</span><span class="p">(</span><span class="n">d</span><span class="p">,</span> <span class="mh">0x3f</span><span class="p">,</span> <span class="k">sizeof</span> <span class="n">d</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">	<span class="n">d</span><span class="p">[</span><span class="n">s</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">q</span><span class="p">.</span><span class="n">push</span><span class="p">((</span><span class="n">D</span><span class="p">)</span> <span class="p">{</span><span class="n">s</span><span class="p">,</span> <span class="mi">0</span><span class="p">});</span>
</span></span><span class="line"><span class="cl">	<span class="k">while</span><span class="p">(</span><span class="o">!</span><span class="n">q</span><span class="p">.</span><span class="n">empty</span><span class="p">())</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">		<span class="kt">int</span> <span class="n">u</span> <span class="o">=</span> <span class="n">q</span><span class="p">.</span><span class="n">top</span><span class="p">().</span><span class="n">u</span><span class="p">;</span> <span class="n">q</span><span class="p">.</span><span class="n">pop</span><span class="p">();</span>
</span></span><span class="line"><span class="cl">		<span class="k">if</span><span class="p">(</span><span class="n">vis</span><span class="p">[</span><span class="n">u</span><span class="p">])</span> <span class="k">continue</span><span class="p">;</span> <span class="n">vis</span><span class="p">[</span><span class="n">u</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">		<span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">v</span><span class="p">,</span> <span class="n">i</span> <span class="o">=</span> <span class="n">h</span><span class="p">[</span><span class="n">u</span><span class="p">];</span> <span class="o">~</span><span class="n">i</span><span class="p">;</span> <span class="n">i</span> <span class="o">=</span> <span class="n">e</span><span class="p">[</span><span class="n">i</span><span class="p">].</span><span class="n">next</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">			<span class="k">if</span><span class="p">(</span><span class="n">d</span><span class="p">[</span><span class="n">v</span> <span class="o">=</span> <span class="n">e</span><span class="p">[</span><span class="n">i</span><span class="p">].</span><span class="n">to</span><span class="p">]</span> <span class="o">&gt;</span> <span class="n">d</span><span class="p">[</span><span class="n">u</span><span class="p">]</span> <span class="o">+</span> <span class="n">e</span><span class="p">[</span><span class="n">i</span><span class="p">].</span><span class="n">w</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">				<span class="n">d</span><span class="p">[</span><span class="n">v</span><span class="p">]</span> <span class="o">=</span> <span class="n">d</span><span class="p">[</span><span class="n">u</span><span class="p">]</span> <span class="o">+</span> <span class="n">e</span><span class="p">[</span><span class="n">i</span><span class="p">].</span><span class="n">w</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">				<span class="k">if</span><span class="p">(</span><span class="o">!</span><span class="n">vis</span><span class="p">[</span><span class="n">v</span><span class="p">])</span> <span class="n">q</span><span class="p">.</span><span class="n">push</span><span class="p">((</span><span class="n">D</span><span class="p">)</span> <span class="p">{</span><span class="n">v</span><span class="p">,</span> <span class="n">d</span><span class="p">[</span><span class="n">v</span><span class="p">]});</span>
</span></span><span class="line"><span class="cl">			<span class="p">}</span>
</span></span><span class="line"><span class="cl">	<span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span></span></span></code></pre></td></tr></table>
</div>
</div><h2 id="树哈希" class="heading-element"><span>树哈希</span>
  <a href="#%e6%a0%91%e5%93%88%e5%b8%8c" class="heading-mark">
    <svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg>
  </a>
</h2><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span><span class="lnt">8
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-C++" data-lang="C++"><span class="line"><span class="cl"><span class="n">ull</span> <span class="nf">Hash</span><span class="p">(</span><span class="kt">int</span> <span class="n">u</span><span class="p">,</span> <span class="kt">int</span> <span class="n">p</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">	<span class="n">ull</span> <span class="n">q</span><span class="p">[</span><span class="n">MAXN</span><span class="p">],</span> <span class="n">ans</span> <span class="o">=</span> <span class="n">X</span><span class="p">;</span> <span class="kt">int</span> <span class="n">top</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">	<span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="n">h</span><span class="p">[</span><span class="n">u</span><span class="p">];</span> <span class="o">~</span><span class="n">i</span><span class="p">;</span> <span class="n">i</span> <span class="o">=</span> <span class="n">e</span><span class="p">[</span><span class="n">i</span><span class="p">].</span><span class="n">next</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">		<span class="k">if</span><span class="p">(</span><span class="n">e</span><span class="p">[</span><span class="n">i</span><span class="p">].</span><span class="n">to</span> <span class="o">!=</span> <span class="n">p</span><span class="p">)</span> <span class="n">q</span><span class="p">[</span><span class="o">++</span><span class="n">top</span><span class="p">]</span> <span class="o">=</span> <span class="n">Hash</span><span class="p">(</span><span class="n">e</span><span class="p">[</span><span class="n">i</span><span class="p">].</span><span class="n">to</span><span class="p">,</span> <span class="n">u</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">	<span class="n">sort</span><span class="p">(</span><span class="n">q</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span> <span class="n">q</span><span class="o">+</span><span class="n">top</span><span class="o">+</span><span class="mi">1</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">	<span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;=</span> <span class="n">top</span><span class="p">;</span> <span class="o">++</span><span class="n">i</span><span class="p">)</span> <span class="n">ans</span> <span class="o">=</span> <span class="n">ans</span> <span class="o">*</span> <span class="n">P</span> <span class="o">+</span> <span class="n">q</span><span class="p">[</span><span class="n">i</span><span class="p">];</span>
</span></span><span class="line"><span class="cl">	<span class="k">return</span> <span class="n">ans</span> <span class="o">*</span> <span class="n">P</span> <span class="o">+</span> <span class="n">X</span> <span class="o">+</span> <span class="mi">1</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span></span></span></code></pre></td></tr></table>
</div>
</div><h2 id="cdq分治" class="heading-element"><span>CDQ分治</span>
  <a href="#cdq%e5%88%86%e6%b2%bb" class="heading-mark">
    <svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg>
  </a>
</h2><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-c++" data-lang="c++"><span class="line"><span class="cl"><span class="k">struct</span> <span class="nc">BITS</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">	<span class="kt">int</span> <span class="n">t</span><span class="p">[</span><span class="n">MAXN</span><span class="p">];</span>
</span></span><span class="line"><span class="cl">	<span class="kt">void</span> <span class="nf">U</span><span class="p">(</span><span class="kt">int</span> <span class="n">x</span><span class="p">,</span> <span class="kt">int</span> <span class="n">k</span><span class="p">)</span> <span class="p">{</span><span class="k">for</span><span class="p">(;</span> <span class="n">x</span> <span class="o">&lt;=</span> <span class="n">m</span><span class="p">;</span> <span class="n">t</span><span class="p">[</span><span class="n">x</span><span class="p">]</span> <span class="o">+=</span> <span class="n">k</span><span class="p">,</span> <span class="n">x</span> <span class="o">+=</span> <span class="n">x</span><span class="o">&amp;-</span><span class="n">x</span><span class="p">);}</span>
</span></span><span class="line"><span class="cl">	<span class="kt">int</span> <span class="nf">Q</span><span class="p">(</span><span class="kt">int</span> <span class="n">x</span><span class="p">)</span> <span class="p">{</span><span class="kt">int</span> <span class="n">res</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="k">for</span><span class="p">(;</span> <span class="n">x</span><span class="p">;</span> <span class="n">res</span> <span class="o">+=</span> <span class="n">t</span><span class="p">[</span><span class="n">x</span><span class="p">],</span> <span class="n">x</span> <span class="o">-=</span> <span class="n">x</span><span class="o">&amp;-</span><span class="n">x</span><span class="p">);</span> <span class="k">return</span> <span class="n">res</span><span class="p">;}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span> <span class="n">T</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="kt">void</span> <span class="nf">cdq</span><span class="p">(</span><span class="kt">int</span> <span class="n">l</span><span class="p">,</span> <span class="kt">int</span> <span class="n">r</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">	<span class="k">if</span><span class="p">(</span><span class="n">l</span> <span class="o">==</span> <span class="n">r</span><span class="p">)</span> <span class="k">return</span><span class="p">;</span> <span class="kt">int</span> <span class="n">mid</span> <span class="o">=</span> <span class="p">(</span><span class="n">l</span> <span class="o">+</span> <span class="n">r</span><span class="p">)</span> <span class="o">&gt;&gt;</span> <span class="mi">1</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">	<span class="n">cdq</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="n">mid</span><span class="p">);</span> <span class="n">cdq</span><span class="p">(</span><span class="n">mid</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span> <span class="n">r</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">	<span class="n">sort</span><span class="p">(</span><span class="n">a</span><span class="o">+</span><span class="n">l</span><span class="p">,</span> <span class="n">a</span><span class="o">+</span><span class="n">mid</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span> <span class="n">cmpy</span><span class="p">);</span> <span class="n">sort</span><span class="p">(</span><span class="n">a</span><span class="o">+</span><span class="n">mid</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span> <span class="n">a</span><span class="o">+</span><span class="n">r</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span> <span class="n">cmpy</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">	<span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="n">mid</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="n">j</span> <span class="o">=</span> <span class="n">l</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">	<span class="k">for</span><span class="p">(;</span> <span class="n">i</span> <span class="o">&lt;=</span> <span class="n">r</span><span class="p">;</span> <span class="o">++</span><span class="n">i</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">		<span class="k">for</span><span class="p">(;</span> <span class="n">a</span><span class="p">[</span><span class="n">j</span><span class="p">].</span><span class="n">y</span> <span class="o">&lt;=</span> <span class="n">a</span><span class="p">[</span><span class="n">i</span><span class="p">].</span><span class="n">y</span> <span class="o">&amp;&amp;</span> <span class="n">j</span> <span class="o">&lt;=</span> <span class="n">mid</span><span class="p">;</span> <span class="o">++</span><span class="n">j</span><span class="p">)</span> <span class="n">T</span><span class="p">.</span><span class="n">U</span><span class="p">(</span><span class="n">a</span><span class="p">[</span><span class="n">j</span><span class="p">].</span><span class="n">z</span><span class="p">,</span> <span class="n">a</span><span class="p">[</span><span class="n">j</span><span class="p">].</span><span class="n">w</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">		<span class="n">a</span><span class="p">[</span><span class="n">i</span><span class="p">].</span><span class="n">ans</span> <span class="o">+=</span> <span class="n">T</span><span class="p">.</span><span class="n">Q</span><span class="p">(</span><span class="n">a</span><span class="p">[</span><span class="n">i</span><span class="p">].</span><span class="n">z</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">	<span class="p">}</span> <span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">k</span> <span class="o">=</span> <span class="n">l</span><span class="p">;</span> <span class="n">k</span> <span class="o">&lt;</span> <span class="n">j</span><span class="p">;</span> <span class="o">++</span><span class="n">k</span><span class="p">)</span> <span class="n">T</span><span class="p">.</span><span class="n">U</span><span class="p">(</span><span class="n">a</span><span class="p">[</span><span class="n">k</span><span class="p">].</span><span class="n">z</span><span class="p">,</span> <span class="o">-</span><span class="n">a</span><span class="p">[</span><span class="n">k</span><span class="p">].</span><span class="n">w</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="kt">int</span> <span class="nf">main</span><span class="p">()</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">	<span class="n">read</span><span class="p">(</span><span class="n">_n</span><span class="p">);</span> <span class="n">read</span><span class="p">(</span><span class="n">m</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">	<span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;=</span> <span class="n">_n</span><span class="p">;</span> <span class="o">++</span><span class="n">i</span><span class="p">)</span> <span class="n">read</span><span class="p">(</span><span class="n">b</span><span class="p">[</span><span class="n">i</span><span class="p">].</span><span class="n">x</span><span class="p">),</span> <span class="n">read</span><span class="p">(</span><span class="n">b</span><span class="p">[</span><span class="n">i</span><span class="p">].</span><span class="n">y</span><span class="p">),</span> <span class="n">read</span><span class="p">(</span><span class="n">b</span><span class="p">[</span><span class="n">i</span><span class="p">].</span><span class="n">z</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">	<span class="n">sort</span><span class="p">(</span><span class="n">b</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span> <span class="n">b</span><span class="o">+</span><span class="n">_n</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span> <span class="n">cmpx</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">	<span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">c</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;=</span> <span class="n">_n</span><span class="p">;</span> <span class="o">++</span><span class="n">i</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">		<span class="o">++</span><span class="n">c</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">		<span class="k">if</span><span class="p">(</span><span class="n">b</span><span class="p">[</span><span class="n">i</span><span class="p">].</span><span class="n">x</span> <span class="o">!=</span> <span class="n">b</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">].</span><span class="n">x</span> <span class="o">||</span> <span class="n">b</span><span class="p">[</span><span class="n">i</span><span class="p">].</span><span class="n">y</span> <span class="o">!=</span> <span class="n">b</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">].</span><span class="n">y</span> <span class="o">||</span> <span class="n">b</span><span class="p">[</span><span class="n">i</span><span class="p">].</span><span class="n">z</span> <span class="o">!=</span> <span class="n">b</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">].</span><span class="n">z</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">			<span class="n">a</span><span class="p">[</span><span class="o">++</span><span class="n">n</span><span class="p">]</span> <span class="o">=</span> <span class="n">b</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">a</span><span class="p">[</span><span class="n">n</span><span class="p">].</span><span class="n">w</span> <span class="o">=</span> <span class="n">c</span><span class="p">,</span> <span class="n">c</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">	<span class="p">}</span> <span class="n">cdq</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">n</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">	<span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;=</span> <span class="n">n</span><span class="p">;</span> <span class="o">++</span><span class="n">i</span><span class="p">)</span> <span class="n">cnt</span><span class="p">[</span><span class="n">a</span><span class="p">[</span><span class="n">i</span><span class="p">].</span><span class="n">ans</span> <span class="o">+</span> <span class="n">a</span><span class="p">[</span><span class="n">i</span><span class="p">].</span><span class="n">w</span> <span class="o">-</span> <span class="mi">1</span><span class="p">]</span> <span class="o">+=</span> <span class="n">a</span><span class="p">[</span><span class="n">i</span><span class="p">].</span><span class="n">w</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">	<span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">_n</span><span class="p">;</span> <span class="o">++</span><span class="n">i</span><span class="p">)</span> <span class="n">printf</span><span class="p">(</span><span class="s">&#34;%d</span><span class="se">\n</span><span class="s">&#34;</span><span class="p">,</span> <span class="n">cnt</span><span class="p">[</span><span class="n">i</span><span class="p">]);</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span></span></span></code></pre></td></tr></table>
</div>
</div><h2 id="lucas" class="heading-element"><span>Lucas</span>
  <a href="#lucas" class="heading-mark">
    <svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg>
  </a>
</h2><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span><span class="lnt">8
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-C++" data-lang="C++"><span class="line"><span class="cl"><span class="kt">int</span> <span class="nf">C</span><span class="p">(</span><span class="kt">int</span> <span class="n">n</span><span class="p">,</span> <span class="kt">int</span> <span class="n">m</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">	<span class="k">if</span><span class="p">(</span><span class="n">m</span> <span class="o">&gt;</span> <span class="n">n</span><span class="p">)</span> <span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">	<span class="k">return</span> <span class="mi">1ll</span> <span class="o">*</span> <span class="n">fac</span><span class="p">[</span><span class="n">n</span><span class="p">]</span> <span class="o">*</span> <span class="n">power</span><span class="p">(</span><span class="n">fac</span><span class="p">[</span><span class="n">m</span><span class="p">],</span> <span class="n">P</span><span class="o">-</span><span class="mi">2</span><span class="p">)</span> <span class="o">*</span> <span class="n">power</span><span class="p">(</span><span class="n">fac</span><span class="p">[</span><span class="n">n</span><span class="o">-</span><span class="n">m</span><span class="p">],</span> <span class="n">P</span><span class="o">-</span><span class="mi">2</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="kt">int</span> <span class="nf">Lucas</span><span class="p">(</span><span class="kt">int</span> <span class="n">n</span><span class="p">,</span> <span class="kt">int</span> <span class="n">m</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">	<span class="k">if</span><span class="p">(</span><span class="n">m</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="k">return</span> <span class="mi">1</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">	<span class="k">return</span> <span class="mi">1ll</span> <span class="o">*</span> <span class="n">C</span><span class="p">(</span><span class="n">n</span><span class="o">%</span><span class="n">P</span><span class="p">,</span> <span class="n">m</span><span class="o">%</span><span class="n">P</span><span class="p">)</span> <span class="o">*</span> <span class="n">Lucas</span><span class="p">(</span><span class="n">n</span><span class="o">/</span><span class="n">P</span><span class="p">,</span> <span class="n">m</span><span class="o">/</span><span class="n">P</span><span class="p">)</span> <span class="o">%</span> <span class="n">P</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span></span></span></code></pre></td></tr></table>
</div>
</div><h2 id="二分图" class="heading-element"><span>二分图</span>
  <a href="#%e4%ba%8c%e5%88%86%e5%9b%be" class="heading-mark">
    <svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg>
  </a>
</h2><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-c++" data-lang="c++"><span class="line"><span class="cl"><span class="kt">bool</span> <span class="nf">dfs</span><span class="p">(</span><span class="kt">int</span> <span class="n">u</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">	<span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">v</span><span class="p">,</span> <span class="n">i</span> <span class="o">=</span> <span class="n">h</span><span class="p">[</span><span class="n">u</span><span class="p">];</span> <span class="o">~</span><span class="n">i</span><span class="p">;</span> <span class="n">i</span> <span class="o">=</span> <span class="n">e</span><span class="p">[</span><span class="n">i</span><span class="p">].</span><span class="n">next</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">		<span class="k">if</span><span class="p">(</span><span class="n">vis</span><span class="p">[</span><span class="n">v</span> <span class="o">=</span> <span class="n">e</span><span class="p">[</span><span class="n">i</span><span class="p">].</span><span class="n">to</span><span class="p">]</span> <span class="o">!=</span> <span class="n">tag</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">			<span class="n">vis</span><span class="p">[</span><span class="n">v</span><span class="p">]</span> <span class="o">=</span> <span class="n">tag</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">			<span class="k">if</span><span class="p">(</span><span class="o">!</span><span class="n">match</span><span class="p">[</span><span class="n">v</span><span class="p">]</span> <span class="o">||</span> <span class="n">dfs</span><span class="p">(</span><span class="n">match</span><span class="p">[</span><span class="n">v</span><span class="p">]))</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">				<span class="n">match</span><span class="p">[</span><span class="n">v</span><span class="p">]</span> <span class="o">=</span> <span class="n">u</span><span class="p">;</span> <span class="k">return</span> <span class="mi">1</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">			<span class="p">}</span>
</span></span><span class="line"><span class="cl">		<span class="p">}</span>
</span></span><span class="line"><span class="cl">	<span class="p">}</span> <span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span></span></span></code></pre></td></tr></table>
</div>
</div><h2 id="莫队二次离线" class="heading-element"><span>莫队二次离线</span>
  <a href="#%e8%8e%ab%e9%98%9f%e4%ba%8c%e6%ac%a1%e7%a6%bb%e7%ba%bf" class="heading-mark">
    <svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg>
  </a>
</h2><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span><span class="lnt">38
</span><span class="lnt">39
</span><span class="lnt">40
</span><span class="lnt">41
</span><span class="lnt">42
</span><span class="lnt">43
</span><span class="lnt">44
</span><span class="lnt">45
</span><span class="lnt">46
</span><span class="lnt">47
</span><span class="lnt">48
</span><span class="lnt">49
</span><span class="lnt">50
</span><span class="lnt">51
</span><span class="lnt">52
</span><span class="lnt">53
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-c++" data-lang="c++"><span class="line"><span class="cl"><span class="cp">#include</span> <span class="cpf">&lt;bits/stdc++.h&gt;</span><span class="cp">
</span></span></span><span class="line"><span class="cl"><span class="cp"></span><span class="k">using</span> <span class="k">namespace</span> <span class="n">std</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="k">const</span> <span class="kt">int</span> <span class="n">MAXN</span> <span class="o">=</span> <span class="mi">100050</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="k">typedef</span> <span class="kt">long</span> <span class="kt">long</span> <span class="n">lint</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="kt">void</span> <span class="nf">read</span><span class="p">(</span><span class="kt">int</span> <span class="o">&amp;</span><span class="n">x</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">	<span class="kt">char</span> <span class="n">ch</span><span class="p">;</span> <span class="k">while</span><span class="p">(</span><span class="n">ch</span> <span class="o">=</span> <span class="n">getchar</span><span class="p">(),</span> <span class="n">ch</span> <span class="o">&lt;</span> <span class="sc">&#39;!&#39;</span><span class="p">);</span> <span class="n">x</span> <span class="o">=</span> <span class="n">ch</span> <span class="o">-</span> <span class="mi">48</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">	<span class="k">while</span><span class="p">(</span><span class="n">ch</span> <span class="o">=</span> <span class="n">getchar</span><span class="p">(),</span> <span class="n">ch</span> <span class="o">&gt;</span> <span class="sc">&#39;!&#39;</span><span class="p">)</span> <span class="n">x</span> <span class="o">=</span> <span class="p">(</span><span class="n">x</span> <span class="o">&lt;&lt;</span> <span class="mi">3</span><span class="p">)</span> <span class="o">+</span> <span class="p">(</span><span class="n">x</span> <span class="o">&lt;&lt;</span> <span class="mi">1</span><span class="p">)</span> <span class="o">+</span> <span class="n">ch</span> <span class="o">-</span> <span class="mi">48</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="k">struct</span> <span class="nc">Qry</span> <span class="p">{</span><span class="kt">int</span> <span class="n">l</span><span class="p">,</span> <span class="n">r</span><span class="p">,</span> <span class="n">id</span><span class="p">;</span> <span class="n">lint</span> <span class="n">ans</span><span class="p">;}</span> <span class="n">q</span><span class="p">[</span><span class="n">MAXN</span><span class="p">];</span>
</span></span><span class="line"><span class="cl"><span class="k">struct</span> <span class="nc">T</span><span class="p">{</span><span class="kt">int</span> <span class="n">l</span><span class="p">,</span> <span class="n">r</span><span class="p">,</span> <span class="n">id</span><span class="p">;};</span>
</span></span><span class="line"><span class="cl"><span class="kt">int</span> <span class="n">n</span><span class="p">,</span> <span class="n">m</span><span class="p">,</span> <span class="n">a</span><span class="p">[</span><span class="n">MAXN</span><span class="p">],</span> <span class="n">siz</span><span class="p">[</span><span class="n">MAXN</span><span class="p">],</span> <span class="n">k</span><span class="p">,</span> <span class="n">blsz</span><span class="p">,</span> <span class="n">bl</span><span class="p">[</span><span class="n">MAXN</span><span class="p">],</span> <span class="n">t</span><span class="p">[</span><span class="n">MAXN</span><span class="p">],</span> <span class="n">pref</span><span class="p">[</span><span class="n">MAXN</span><span class="p">];</span>
</span></span><span class="line"><span class="cl"><span class="n">vector</span> <span class="o">&lt;</span><span class="kt">int</span><span class="o">&gt;</span> <span class="n">buc</span><span class="p">;</span> <span class="n">vector</span> <span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;</span> <span class="n">v</span><span class="p">[</span><span class="n">MAXN</span><span class="p">];</span> <span class="n">lint</span> <span class="n">ans</span><span class="p">[</span><span class="n">MAXN</span><span class="p">];</span>
</span></span><span class="line"><span class="cl"><span class="kt">int</span> <span class="nf">cmp</span><span class="p">(</span><span class="n">Qry</span> <span class="n">a</span><span class="p">,</span> <span class="n">Qry</span> <span class="n">b</span><span class="p">)</span> <span class="p">{</span><span class="k">return</span> <span class="n">bl</span><span class="p">[</span><span class="n">a</span><span class="p">.</span><span class="n">l</span><span class="p">]</span> <span class="o">==</span> <span class="n">bl</span><span class="p">[</span><span class="n">b</span><span class="p">.</span><span class="n">l</span><span class="p">]</span> <span class="o">?</span> <span class="n">a</span><span class="p">.</span><span class="n">r</span> <span class="o">&lt;</span> <span class="n">b</span><span class="p">.</span><span class="nl">r</span> <span class="p">:</span> <span class="n">a</span><span class="p">.</span><span class="n">l</span> <span class="o">&lt;</span> <span class="n">b</span><span class="p">.</span><span class="n">l</span><span class="p">;}</span>
</span></span><span class="line"><span class="cl"><span class="kt">int</span> <span class="nf">main</span><span class="p">()</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">	<span class="n">read</span><span class="p">(</span><span class="n">n</span><span class="p">);</span> <span class="n">read</span><span class="p">(</span><span class="n">m</span><span class="p">);</span> <span class="n">read</span><span class="p">(</span><span class="n">k</span><span class="p">);</span> <span class="n">blsz</span> <span class="o">=</span> <span class="n">sqrt</span><span class="p">(</span><span class="n">n</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">	<span class="k">if</span><span class="p">(</span><span class="n">k</span> <span class="o">&gt;</span> <span class="mi">14</span><span class="p">)</span> <span class="p">{</span><span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;=</span> <span class="n">m</span><span class="p">;</span> <span class="o">++</span><span class="n">i</span><span class="p">)</span> <span class="n">puts</span><span class="p">(</span><span class="s">&#34;0&#34;</span><span class="p">);</span> <span class="k">return</span> <span class="mi">0</span><span class="p">;}</span>
</span></span><span class="line"><span class="cl">	<span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;=</span> <span class="n">n</span><span class="p">;</span> <span class="o">++</span><span class="n">i</span><span class="p">)</span> <span class="n">read</span><span class="p">(</span><span class="n">a</span><span class="p">[</span><span class="n">i</span><span class="p">]);</span>
</span></span><span class="line"><span class="cl">	<span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="mi">16384</span><span class="p">;</span> <span class="o">++</span><span class="n">i</span><span class="p">)</span> <span class="k">if</span><span class="p">((</span><span class="n">siz</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">siz</span><span class="p">[(</span><span class="n">i</span><span class="o">&gt;&gt;</span><span class="mi">1</span><span class="p">)]</span> <span class="o">+</span> <span class="p">(</span><span class="n">i</span><span class="o">&amp;</span><span class="mi">1</span><span class="p">))</span> <span class="o">==</span> <span class="n">k</span><span class="p">)</span> <span class="n">buc</span><span class="p">.</span><span class="n">push_back</span><span class="p">(</span><span class="n">i</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">	<span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;=</span> <span class="n">m</span><span class="p">;</span> <span class="o">++</span><span class="n">i</span><span class="p">)</span> <span class="n">read</span><span class="p">(</span><span class="n">q</span><span class="p">[</span><span class="n">i</span><span class="p">].</span><span class="n">l</span><span class="p">),</span> <span class="n">read</span><span class="p">(</span><span class="n">q</span><span class="p">[</span><span class="n">i</span><span class="p">].</span><span class="n">r</span><span class="p">),</span> <span class="n">q</span><span class="p">[</span><span class="n">i</span><span class="p">].</span><span class="n">id</span> <span class="o">=</span> <span class="n">i</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">	<span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;=</span> <span class="n">n</span><span class="p">;</span> <span class="o">++</span><span class="n">i</span><span class="p">)</span> <span class="n">bl</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span> <span class="o">/</span> <span class="n">blsz</span> <span class="o">+</span> <span class="mi">1</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">	<span class="n">sort</span><span class="p">(</span><span class="n">q</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span> <span class="n">q</span><span class="o">+</span><span class="n">m</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span> <span class="n">cmp</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">	<span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;=</span> <span class="n">n</span><span class="p">;</span> <span class="o">++</span><span class="n">i</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">		<span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">j</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">j</span> <span class="o">&lt;</span> <span class="n">buc</span><span class="p">.</span><span class="n">size</span><span class="p">();</span> <span class="o">++</span><span class="n">j</span><span class="p">)</span> <span class="o">++</span><span class="n">t</span><span class="p">[</span><span class="n">a</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">^</span><span class="n">buc</span><span class="p">[</span><span class="n">j</span><span class="p">]];</span>
</span></span><span class="line"><span class="cl">		<span class="n">pref</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">t</span><span class="p">[</span><span class="n">a</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">]];</span>
</span></span><span class="line"><span class="cl">	<span class="p">}</span>
</span></span><span class="line"><span class="cl">	<span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">L</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">R</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;=</span> <span class="n">m</span><span class="p">;</span> <span class="o">++</span><span class="n">i</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">		<span class="kt">int</span> <span class="n">l</span> <span class="o">=</span> <span class="n">q</span><span class="p">[</span><span class="n">i</span><span class="p">].</span><span class="n">l</span><span class="p">,</span> <span class="n">r</span> <span class="o">=</span> <span class="n">q</span><span class="p">[</span><span class="n">i</span><span class="p">].</span><span class="n">r</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">		   <span class="k">if</span><span class="p">(</span><span class="n">L</span> <span class="o">&lt;</span> <span class="n">l</span><span class="p">)</span> <span class="n">v</span><span class="p">[</span><span class="n">R</span><span class="p">].</span><span class="n">push_back</span><span class="p">((</span><span class="n">T</span><span class="p">)</span> <span class="p">{</span><span class="n">L</span><span class="p">,</span> <span class="n">l</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="n">i</span><span class="p">});</span>
</span></span><span class="line"><span class="cl">		<span class="k">while</span><span class="p">(</span><span class="n">L</span> <span class="o">&lt;</span> <span class="n">l</span><span class="p">)</span> <span class="p">{</span><span class="n">q</span><span class="p">[</span><span class="n">i</span><span class="p">].</span><span class="n">ans</span> <span class="o">+=</span> <span class="n">pref</span><span class="p">[</span><span class="n">L</span><span class="o">-</span><span class="mi">1</span><span class="p">];</span> <span class="o">++</span><span class="n">L</span><span class="p">;}</span>
</span></span><span class="line"><span class="cl">		   <span class="k">if</span><span class="p">(</span><span class="n">L</span> <span class="o">&gt;</span> <span class="n">l</span><span class="p">)</span> <span class="n">v</span><span class="p">[</span><span class="n">R</span><span class="p">].</span><span class="n">push_back</span><span class="p">((</span><span class="n">T</span><span class="p">)</span> <span class="p">{</span><span class="n">l</span><span class="p">,</span> <span class="n">L</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="n">i</span><span class="p">});</span>
</span></span><span class="line"><span class="cl">		<span class="k">while</span><span class="p">(</span><span class="n">L</span> <span class="o">&gt;</span> <span class="n">l</span><span class="p">)</span> <span class="p">{</span><span class="n">q</span><span class="p">[</span><span class="n">i</span><span class="p">].</span><span class="n">ans</span> <span class="o">-=</span> <span class="n">pref</span><span class="p">[</span><span class="n">L</span><span class="o">-</span><span class="mi">2</span><span class="p">];</span> <span class="o">--</span><span class="n">L</span><span class="p">;}</span>
</span></span><span class="line"><span class="cl">		   <span class="k">if</span><span class="p">(</span><span class="n">R</span> <span class="o">&lt;</span> <span class="n">r</span><span class="p">)</span> <span class="n">v</span><span class="p">[</span><span class="n">L</span><span class="o">-</span><span class="mi">1</span><span class="p">].</span><span class="n">push_back</span><span class="p">((</span><span class="n">T</span><span class="p">)</span> <span class="p">{</span><span class="n">R</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span> <span class="n">r</span><span class="p">,</span> <span class="o">-</span><span class="n">i</span><span class="p">});</span>
</span></span><span class="line"><span class="cl">		<span class="k">while</span><span class="p">(</span><span class="n">R</span> <span class="o">&lt;</span> <span class="n">r</span><span class="p">)</span> <span class="p">{</span><span class="n">q</span><span class="p">[</span><span class="n">i</span><span class="p">].</span><span class="n">ans</span> <span class="o">+=</span> <span class="n">pref</span><span class="p">[</span><span class="n">R</span><span class="p">];</span> <span class="o">++</span><span class="n">R</span><span class="p">;}</span>
</span></span><span class="line"><span class="cl">		   <span class="k">if</span><span class="p">(</span><span class="n">R</span> <span class="o">&gt;</span> <span class="n">r</span><span class="p">)</span> <span class="n">v</span><span class="p">[</span><span class="n">L</span><span class="o">-</span><span class="mi">1</span><span class="p">].</span><span class="n">push_back</span><span class="p">((</span><span class="n">T</span><span class="p">)</span> <span class="p">{</span><span class="n">r</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span> <span class="n">R</span><span class="p">,</span> <span class="n">i</span><span class="p">});</span>
</span></span><span class="line"><span class="cl">		<span class="k">while</span><span class="p">(</span><span class="n">R</span> <span class="o">&gt;</span> <span class="n">r</span><span class="p">)</span> <span class="p">{</span><span class="n">q</span><span class="p">[</span><span class="n">i</span><span class="p">].</span><span class="n">ans</span> <span class="o">-=</span> <span class="n">pref</span><span class="p">[</span><span class="n">R</span><span class="o">-</span><span class="mi">1</span><span class="p">];</span> <span class="o">--</span><span class="n">R</span><span class="p">;}</span>
</span></span><span class="line"><span class="cl">	<span class="p">}</span>
</span></span><span class="line"><span class="cl">	<span class="n">memset</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="k">sizeof</span> <span class="n">t</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">	<span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">l</span><span class="p">,</span> <span class="n">r</span><span class="p">,</span> <span class="n">id</span><span class="p">,</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;=</span> <span class="n">n</span><span class="p">;</span> <span class="o">++</span><span class="n">i</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">		<span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">j</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">j</span> <span class="o">&lt;</span> <span class="n">buc</span><span class="p">.</span><span class="n">size</span><span class="p">();</span> <span class="o">++</span><span class="n">j</span><span class="p">)</span> <span class="o">++</span><span class="n">t</span><span class="p">[</span><span class="n">a</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">^</span><span class="n">buc</span><span class="p">[</span><span class="n">j</span><span class="p">]];</span>
</span></span><span class="line"><span class="cl">		<span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">o</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">o</span> <span class="o">&lt;</span> <span class="n">v</span><span class="p">[</span><span class="n">i</span><span class="p">].</span><span class="n">size</span><span class="p">();</span> <span class="o">++</span><span class="n">o</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">			<span class="n">l</span> <span class="o">=</span> <span class="n">v</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">o</span><span class="p">].</span><span class="n">l</span><span class="p">;</span> <span class="n">r</span> <span class="o">=</span> <span class="n">v</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">o</span><span class="p">].</span><span class="n">r</span><span class="p">;</span> <span class="n">id</span> <span class="o">=</span> <span class="n">v</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">o</span><span class="p">].</span><span class="n">id</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">			<span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">j</span> <span class="o">=</span> <span class="n">l</span><span class="p">,</span> <span class="n">tmp</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">j</span> <span class="o">&lt;=</span> <span class="n">r</span><span class="p">;</span> <span class="o">++</span><span class="n">j</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">				<span class="n">tmp</span> <span class="o">=</span> <span class="n">t</span><span class="p">[</span><span class="n">a</span><span class="p">[</span><span class="n">j</span><span class="p">]];</span>
</span></span><span class="line"><span class="cl">				<span class="k">if</span><span class="p">(</span><span class="n">j</span> <span class="o">&lt;=</span> <span class="n">i</span> <span class="o">&amp;&amp;</span> <span class="o">!</span><span class="n">k</span><span class="p">)</span> <span class="o">--</span><span class="n">tmp</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">				<span class="k">if</span><span class="p">(</span><span class="n">id</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="n">q</span><span class="p">[</span><span class="n">id</span><span class="p">].</span><span class="n">ans</span> <span class="o">+=</span> <span class="n">tmp</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">				<span class="k">else</span> <span class="n">q</span><span class="p">[</span><span class="o">-</span><span class="n">id</span><span class="p">].</span><span class="n">ans</span> <span class="o">-=</span> <span class="n">tmp</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">			<span class="p">}</span>
</span></span><span class="line"><span class="cl">		<span class="p">}</span>
</span></span><span class="line"><span class="cl">	<span class="p">}</span>
</span></span><span class="line"><span class="cl">	<span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;=</span> <span class="n">m</span><span class="p">;</span> <span class="o">++</span><span class="n">i</span><span class="p">)</span> <span class="n">q</span><span class="p">[</span><span class="n">i</span><span class="p">].</span><span class="n">ans</span> <span class="o">+=</span> <span class="n">q</span><span class="p">[</span><span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="p">].</span><span class="n">ans</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">	<span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;=</span> <span class="n">m</span><span class="p">;</span> <span class="o">++</span><span class="n">i</span><span class="p">)</span> <span class="n">ans</span><span class="p">[</span><span class="n">q</span><span class="p">[</span><span class="n">i</span><span class="p">].</span><span class="n">id</span><span class="p">]</span> <span class="o">=</span> <span class="n">q</span><span class="p">[</span><span class="n">i</span><span class="p">].</span><span class="n">ans</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">	<span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;=</span> <span class="n">m</span><span class="p">;</span> <span class="o">++</span><span class="n">i</span><span class="p">)</span> <span class="n">printf</span><span class="p">(</span><span class="s">&#34;%lld</span><span class="se">\n</span><span class="s">&#34;</span><span class="p">,</span> <span class="n">ans</span><span class="p">[</span><span class="n">i</span><span class="p">]);</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span></span></span></code></pre></td></tr></table>
</div>
</div><h2 id="莫比乌斯反演" class="heading-element"><span>莫比乌斯反演</span>
  <a href="#%e8%8e%ab%e6%af%94%e4%b9%8c%e6%96%af%e5%8f%8d%e6%bc%94" class="heading-mark">
    <svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg>
  </a>
</h2><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-C++" data-lang="C++"><span class="line"><span class="cl"><span class="kt">void</span> <span class="nf">GetMu</span><span class="p">()</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">	<span class="n">mu</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">	<span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">2</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;=</span> <span class="mi">10000000</span><span class="p">;</span> <span class="o">++</span><span class="n">i</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">		<span class="k">if</span><span class="p">(</span><span class="o">!</span><span class="n">vis</span><span class="p">[</span><span class="n">i</span><span class="p">])</span> <span class="n">p</span><span class="p">[</span><span class="o">++</span><span class="n">cnt</span><span class="p">]</span> <span class="o">=</span> <span class="n">i</span><span class="p">,</span> <span class="n">mu</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">		<span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">j</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span> <span class="n">j</span> <span class="o">&lt;=</span> <span class="n">cnt</span> <span class="o">&amp;&amp;</span> <span class="n">p</span><span class="p">[</span><span class="n">j</span><span class="p">]</span> <span class="o">*</span> <span class="n">i</span> <span class="o">&lt;=</span> <span class="mi">10000000</span><span class="p">;</span> <span class="o">++</span><span class="n">j</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">			<span class="n">vis</span><span class="p">[</span><span class="n">p</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">*</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">			<span class="k">if</span><span class="p">(</span><span class="n">i</span> <span class="o">%</span> <span class="n">p</span><span class="p">[</span><span class="n">j</span><span class="p">])</span> <span class="n">mu</span><span class="p">[</span><span class="n">p</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">*</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="o">-</span><span class="n">mu</span><span class="p">[</span><span class="n">i</span><span class="p">];</span>
</span></span><span class="line"><span class="cl">		<span class="p">}</span>
</span></span><span class="line"><span class="cl">	<span class="p">}</span>
</span></span><span class="line"><span class="cl">	<span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;=</span> <span class="n">cnt</span><span class="p">;</span> <span class="o">++</span><span class="n">i</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">		<span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">j</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span> <span class="n">j</span> <span class="o">*</span> <span class="n">p</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">&lt;=</span> <span class="mi">10000000</span><span class="p">;</span> <span class="o">++</span><span class="n">j</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">			<span class="n">f</span><span class="p">[</span><span class="n">j</span><span class="o">*</span><span class="n">p</span><span class="p">[</span><span class="n">i</span><span class="p">]]</span> <span class="o">+=</span> <span class="n">mu</span><span class="p">[</span><span class="n">j</span><span class="p">];</span>
</span></span><span class="line"><span class="cl">	<span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;=</span> <span class="mi">10000000</span><span class="p">;</span> <span class="o">++</span><span class="n">i</span><span class="p">)</span> <span class="n">pref</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">pref</span><span class="p">[</span><span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">f</span><span class="p">[</span><span class="n">i</span><span class="p">];</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="n">lint</span> <span class="nf">calc</span><span class="p">(</span><span class="kt">int</span> <span class="n">a</span><span class="p">,</span> <span class="kt">int</span> <span class="n">b</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">	<span class="n">lint</span> <span class="n">res</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">	<span class="k">if</span><span class="p">(</span><span class="n">a</span> <span class="o">&gt;</span> <span class="n">b</span><span class="p">)</span> <span class="n">swap</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">	<span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">l</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">r</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">l</span> <span class="o">&lt;=</span> <span class="n">a</span><span class="p">;</span> <span class="n">l</span> <span class="o">=</span> <span class="n">r</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">		<span class="n">r</span> <span class="o">=</span> <span class="n">min</span><span class="p">(</span><span class="n">a</span><span class="o">/</span><span class="p">(</span><span class="n">a</span><span class="o">/</span><span class="n">l</span><span class="p">),</span> <span class="n">b</span><span class="o">/</span><span class="p">(</span><span class="n">b</span><span class="o">/</span><span class="n">l</span><span class="p">));</span>
</span></span><span class="line"><span class="cl">		<span class="n">res</span> <span class="o">+=</span> <span class="p">(</span><span class="n">pref</span><span class="p">[</span><span class="n">r</span><span class="p">]</span> <span class="o">-</span> <span class="n">pref</span><span class="p">[</span><span class="n">l</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span><span class="o">*</span><span class="mi">1ll</span><span class="o">*</span><span class="p">(</span><span class="n">a</span><span class="o">/</span><span class="n">l</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">b</span><span class="o">/</span><span class="n">l</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">	<span class="p">}</span> <span class="k">return</span> <span class="n">res</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span></span></span></code></pre></td></tr></table>
</div>
</div><h2 id="树剖" class="heading-element"><span>树剖</span>
  <a href="#%e6%a0%91%e5%89%96" class="heading-mark">
    <svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg>
  </a>
</h2><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span><span class="lnt">38
</span><span class="lnt">39
</span><span class="lnt">40
</span><span class="lnt">41
</span><span class="lnt">42
</span><span class="lnt">43
</span><span class="lnt">44
</span><span class="lnt">45
</span><span class="lnt">46
</span><span class="lnt">47
</span><span class="lnt">48
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-c++" data-lang="c++"><span class="line"><span class="cl"><span class="kt">void</span> <span class="nf">ADD</span><span class="p">(</span><span class="kt">int</span> <span class="n">u</span><span class="p">,</span> <span class="kt">int</span> <span class="n">l</span><span class="p">,</span> <span class="kt">int</span> <span class="n">r</span><span class="p">,</span> <span class="kt">int</span> <span class="n">k</span><span class="p">)</span> <span class="p">{</span><span class="n">t</span><span class="p">[</span><span class="n">u</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="n">t</span><span class="p">[</span><span class="n">u</span><span class="p">]</span> <span class="o">+</span> <span class="mi">1ll</span><span class="o">*</span><span class="n">k</span><span class="o">*</span><span class="p">(</span><span class="n">r</span><span class="o">-</span><span class="n">l</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">%</span><span class="n">P</span><span class="p">)</span> <span class="o">%</span> <span class="n">P</span><span class="p">;</span> <span class="n">tag</span><span class="p">[</span><span class="n">u</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="n">tag</span><span class="p">[</span><span class="n">u</span><span class="p">]</span> <span class="o">+</span> <span class="n">k</span><span class="p">)</span> <span class="o">%</span> <span class="n">P</span><span class="p">;}</span>
</span></span><span class="line"><span class="cl"><span class="kt">void</span> <span class="nf">PD</span><span class="p">(</span><span class="kt">int</span> <span class="n">u</span><span class="p">,</span> <span class="kt">int</span> <span class="n">l</span><span class="p">,</span> <span class="kt">int</span> <span class="n">r</span><span class="p">)</span> <span class="p">{</span><span class="n">ADD</span><span class="p">(</span><span class="n">L</span><span class="p">(</span><span class="n">u</span><span class="p">),</span> <span class="n">l</span><span class="p">,</span> <span class="n">mid</span><span class="p">,</span> <span class="n">tag</span><span class="p">[</span><span class="n">u</span><span class="p">]);</span> <span class="n">ADD</span><span class="p">(</span><span class="n">R</span><span class="p">(</span><span class="n">u</span><span class="p">),</span> <span class="n">mid</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span> <span class="n">r</span><span class="p">,</span> <span class="n">tag</span><span class="p">[</span><span class="n">u</span><span class="p">]);</span> <span class="n">tag</span><span class="p">[</span><span class="n">u</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;}</span>
</span></span><span class="line"><span class="cl"><span class="kt">void</span> <span class="nf">PU</span><span class="p">(</span><span class="kt">int</span> <span class="n">u</span><span class="p">)</span> <span class="p">{</span><span class="n">t</span><span class="p">[</span><span class="n">u</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="n">t</span><span class="p">[</span><span class="n">L</span><span class="p">(</span><span class="n">u</span><span class="p">)]</span> <span class="o">+</span> <span class="n">t</span><span class="p">[</span><span class="n">R</span><span class="p">(</span><span class="n">u</span><span class="p">)])</span> <span class="o">%</span> <span class="n">P</span><span class="p">;}</span>
</span></span><span class="line"><span class="cl"><span class="kt">void</span> <span class="nf">build</span><span class="p">(</span><span class="kt">int</span> <span class="n">u</span><span class="p">,</span> <span class="kt">int</span> <span class="n">l</span><span class="p">,</span> <span class="kt">int</span> <span class="n">r</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">	<span class="k">if</span><span class="p">(</span><span class="n">l</span> <span class="o">==</span> <span class="n">r</span><span class="p">)</span> <span class="p">{</span><span class="n">t</span><span class="p">[</span><span class="n">u</span><span class="p">]</span> <span class="o">=</span> <span class="n">w</span><span class="p">[</span><span class="n">id</span><span class="p">[</span><span class="n">l</span><span class="p">]];</span> <span class="k">return</span><span class="p">;</span> <span class="p">}</span>
</span></span><span class="line"><span class="cl">	<span class="n">build</span><span class="p">(</span><span class="n">L</span><span class="p">(</span><span class="n">u</span><span class="p">),</span> <span class="n">l</span><span class="p">,</span> <span class="n">mid</span><span class="p">);</span> <span class="n">build</span><span class="p">(</span><span class="n">R</span><span class="p">(</span><span class="n">u</span><span class="p">),</span> <span class="n">mid</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span> <span class="n">r</span><span class="p">);</span> <span class="n">PU</span><span class="p">(</span><span class="n">u</span><span class="p">);</span> 
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="kt">void</span> <span class="nf">upd</span><span class="p">(</span><span class="kt">int</span> <span class="n">u</span><span class="p">,</span> <span class="kt">int</span> <span class="n">l</span><span class="p">,</span> <span class="kt">int</span> <span class="n">r</span><span class="p">,</span> <span class="kt">int</span> <span class="n">tl</span><span class="p">,</span> <span class="kt">int</span> <span class="n">tr</span><span class="p">,</span> <span class="kt">int</span> <span class="n">k</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">	<span class="k">if</span><span class="p">(</span><span class="n">tr</span> <span class="o">&lt;</span> <span class="n">l</span> <span class="o">||</span> <span class="n">tl</span> <span class="o">&gt;</span> <span class="n">r</span><span class="p">)</span> <span class="k">return</span><span class="p">;</span> <span class="k">if</span><span class="p">(</span><span class="n">tl</span> <span class="o">&lt;=</span> <span class="n">l</span> <span class="o">&amp;&amp;</span> <span class="n">r</span> <span class="o">&lt;=</span> <span class="n">tr</span><span class="p">)</span> <span class="n">ADD</span><span class="p">(</span><span class="n">u</span><span class="p">,</span> <span class="n">l</span><span class="p">,</span> <span class="n">r</span><span class="p">,</span> <span class="n">k</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">	<span class="k">else</span> <span class="n">PD</span><span class="p">(</span><span class="n">u</span><span class="p">,</span> <span class="n">l</span><span class="p">,</span> <span class="n">r</span><span class="p">),</span> <span class="n">upd</span><span class="p">(</span><span class="n">L</span><span class="p">(</span><span class="n">u</span><span class="p">),</span> <span class="n">l</span><span class="p">,</span> <span class="n">mid</span><span class="p">,</span> <span class="n">tl</span><span class="p">,</span> <span class="n">tr</span><span class="p">,</span> <span class="n">k</span><span class="p">),</span> <span class="n">upd</span><span class="p">(</span><span class="n">R</span><span class="p">(</span><span class="n">u</span><span class="p">),</span> <span class="n">mid</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span> <span class="n">r</span><span class="p">,</span> <span class="n">tl</span><span class="p">,</span> <span class="n">tr</span><span class="p">,</span> <span class="n">k</span><span class="p">),</span> <span class="n">PU</span><span class="p">(</span><span class="n">u</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="kt">int</span> <span class="nf">qry</span><span class="p">(</span><span class="kt">int</span> <span class="n">u</span><span class="p">,</span> <span class="kt">int</span> <span class="n">l</span><span class="p">,</span> <span class="kt">int</span> <span class="n">r</span><span class="p">,</span> <span class="kt">int</span> <span class="n">tl</span><span class="p">,</span> <span class="kt">int</span> <span class="n">tr</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">	<span class="k">if</span><span class="p">(</span><span class="n">tr</span> <span class="o">&lt;</span> <span class="n">l</span> <span class="o">||</span> <span class="n">tl</span> <span class="o">&gt;</span> <span class="n">r</span><span class="p">)</span> <span class="k">return</span> <span class="mi">0</span><span class="p">;</span> <span class="k">if</span><span class="p">(</span><span class="n">tl</span> <span class="o">&lt;=</span> <span class="n">l</span> <span class="o">&amp;&amp;</span> <span class="n">r</span> <span class="o">&lt;=</span> <span class="n">tr</span><span class="p">)</span> <span class="k">return</span> <span class="n">t</span><span class="p">[</span><span class="n">u</span><span class="p">];</span> <span class="n">PD</span><span class="p">(</span><span class="n">u</span><span class="p">,</span> <span class="n">l</span><span class="p">,</span> <span class="n">r</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">	<span class="k">return</span> <span class="p">(</span><span class="n">qry</span><span class="p">(</span><span class="n">L</span><span class="p">(</span><span class="n">u</span><span class="p">),</span> <span class="n">l</span><span class="p">,</span> <span class="n">mid</span><span class="p">,</span> <span class="n">tl</span><span class="p">,</span> <span class="n">tr</span><span class="p">)</span> <span class="o">+</span> <span class="n">qry</span><span class="p">(</span><span class="n">R</span><span class="p">(</span><span class="n">u</span><span class="p">),</span> <span class="n">mid</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span> <span class="n">r</span><span class="p">,</span> <span class="n">tl</span><span class="p">,</span> <span class="n">tr</span><span class="p">))</span> <span class="o">%</span> <span class="n">P</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="kt">void</span> <span class="nf">dfs1</span><span class="p">(</span><span class="kt">int</span> <span class="n">u</span><span class="p">,</span> <span class="kt">int</span> <span class="n">p</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">	<span class="n">fa</span><span class="p">[</span><span class="n">u</span><span class="p">]</span> <span class="o">=</span> <span class="n">p</span><span class="p">;</span> <span class="n">siz</span><span class="p">[</span><span class="n">u</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span> <span class="n">dep</span><span class="p">[</span><span class="n">u</span><span class="p">]</span> <span class="o">=</span> <span class="n">dep</span><span class="p">[</span><span class="n">p</span><span class="p">]</span> <span class="o">+</span> <span class="mi">1</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">	<span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">v</span><span class="p">,</span> <span class="n">i</span> <span class="o">=</span> <span class="n">h</span><span class="p">[</span><span class="n">u</span><span class="p">];</span> <span class="o">~</span><span class="n">i</span><span class="p">;</span> <span class="n">i</span> <span class="o">=</span> <span class="n">e</span><span class="p">[</span><span class="n">i</span><span class="p">].</span><span class="n">next</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">		<span class="k">if</span><span class="p">((</span><span class="n">v</span> <span class="o">=</span> <span class="n">e</span><span class="p">[</span><span class="n">i</span><span class="p">].</span><span class="n">to</span><span class="p">)</span> <span class="o">!=</span> <span class="n">p</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">			<span class="n">dfs1</span><span class="p">(</span><span class="n">v</span><span class="p">,</span> <span class="n">u</span><span class="p">);</span> <span class="n">siz</span><span class="p">[</span><span class="n">u</span><span class="p">]</span> <span class="o">+=</span> <span class="n">siz</span><span class="p">[</span><span class="n">v</span><span class="p">];</span>
</span></span><span class="line"><span class="cl">			<span class="k">if</span><span class="p">(</span><span class="n">siz</span><span class="p">[</span><span class="n">son</span><span class="p">[</span><span class="n">u</span><span class="p">]]</span> <span class="o">&lt;</span> <span class="n">siz</span><span class="p">[</span><span class="n">v</span><span class="p">])</span> <span class="n">son</span><span class="p">[</span><span class="n">u</span><span class="p">]</span> <span class="o">=</span> <span class="n">v</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">		<span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="kt">void</span> <span class="nf">dfs2</span><span class="p">(</span><span class="kt">int</span> <span class="n">u</span><span class="p">,</span> <span class="kt">int</span> <span class="n">p</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">	<span class="n">id</span><span class="p">[</span><span class="n">dfn</span><span class="p">[</span><span class="n">u</span><span class="p">]</span> <span class="o">=</span> <span class="o">++</span><span class="n">idx</span><span class="p">]</span> <span class="o">=</span> <span class="n">u</span><span class="p">;</span> <span class="n">top</span><span class="p">[</span><span class="n">u</span><span class="p">]</span> <span class="o">=</span> <span class="n">p</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">	<span class="k">if</span><span class="p">(</span><span class="n">son</span><span class="p">[</span><span class="n">u</span><span class="p">])</span> <span class="n">dfs2</span><span class="p">(</span><span class="n">son</span><span class="p">[</span><span class="n">u</span><span class="p">],</span> <span class="n">p</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">	<span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">v</span><span class="p">,</span> <span class="n">i</span> <span class="o">=</span> <span class="n">h</span><span class="p">[</span><span class="n">u</span><span class="p">];</span> <span class="o">~</span><span class="n">i</span><span class="p">;</span> <span class="n">i</span> <span class="o">=</span> <span class="n">e</span><span class="p">[</span><span class="n">i</span><span class="p">].</span><span class="n">next</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">		<span class="k">if</span><span class="p">((</span><span class="n">v</span> <span class="o">=</span> <span class="n">e</span><span class="p">[</span><span class="n">i</span><span class="p">].</span><span class="n">to</span><span class="p">)</span> <span class="o">!=</span> <span class="n">fa</span><span class="p">[</span><span class="n">u</span><span class="p">]</span> <span class="o">&amp;&amp;</span> <span class="n">v</span> <span class="o">!=</span> <span class="n">son</span><span class="p">[</span><span class="n">u</span><span class="p">])</span> <span class="n">dfs2</span><span class="p">(</span><span class="n">v</span><span class="p">,</span> <span class="n">v</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="kt">void</span> <span class="nf">addpath</span><span class="p">(</span><span class="kt">int</span> <span class="n">x</span><span class="p">,</span> <span class="kt">int</span> <span class="n">y</span><span class="p">,</span> <span class="kt">int</span> <span class="n">k</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">	<span class="k">for</span><span class="p">(;</span> <span class="n">top</span><span class="p">[</span><span class="n">x</span><span class="p">]</span> <span class="o">!=</span> <span class="n">top</span><span class="p">[</span><span class="n">y</span><span class="p">];</span> <span class="n">x</span> <span class="o">=</span> <span class="n">fa</span><span class="p">[</span><span class="n">top</span><span class="p">[</span><span class="n">x</span><span class="p">]])</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">		<span class="k">if</span><span class="p">(</span><span class="n">dep</span><span class="p">[</span><span class="n">top</span><span class="p">[</span><span class="n">x</span><span class="p">]]</span> <span class="o">&lt;</span> <span class="n">dep</span><span class="p">[</span><span class="n">top</span><span class="p">[</span><span class="n">y</span><span class="p">]])</span> <span class="n">swap</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">		<span class="n">upd</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">n</span><span class="p">,</span> <span class="n">dfn</span><span class="p">[</span><span class="n">top</span><span class="p">[</span><span class="n">x</span><span class="p">]],</span> <span class="n">dfn</span><span class="p">[</span><span class="n">x</span><span class="p">],</span> <span class="n">k</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">	<span class="p">}</span>
</span></span><span class="line"><span class="cl">	<span class="k">if</span><span class="p">(</span><span class="n">dep</span><span class="p">[</span><span class="n">x</span><span class="p">]</span> <span class="o">&gt;</span> <span class="n">dep</span><span class="p">[</span><span class="n">y</span><span class="p">])</span> <span class="n">swap</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">	<span class="n">upd</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">n</span><span class="p">,</span> <span class="n">dfn</span><span class="p">[</span><span class="n">x</span><span class="p">],</span> <span class="n">dfn</span><span class="p">[</span><span class="n">y</span><span class="p">],</span> <span class="n">k</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="kt">int</span> <span class="nf">qrypath</span><span class="p">(</span><span class="kt">int</span> <span class="n">x</span><span class="p">,</span> <span class="kt">int</span> <span class="n">y</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">	<span class="kt">int</span> <span class="n">res</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">	<span class="k">for</span><span class="p">(;</span> <span class="n">top</span><span class="p">[</span><span class="n">x</span><span class="p">]</span> <span class="o">!=</span> <span class="n">top</span><span class="p">[</span><span class="n">y</span><span class="p">];</span> <span class="n">x</span> <span class="o">=</span> <span class="n">fa</span><span class="p">[</span><span class="n">top</span><span class="p">[</span><span class="n">x</span><span class="p">]])</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">		<span class="k">if</span><span class="p">(</span><span class="n">dep</span><span class="p">[</span><span class="n">top</span><span class="p">[</span><span class="n">x</span><span class="p">]]</span> <span class="o">&lt;</span> <span class="n">dep</span><span class="p">[</span><span class="n">top</span><span class="p">[</span><span class="n">y</span><span class="p">]])</span> <span class="n">swap</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">		<span class="n">res</span> <span class="o">=</span> <span class="p">(</span><span class="n">res</span> <span class="o">+</span> <span class="n">qry</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">n</span><span class="p">,</span> <span class="n">dfn</span><span class="p">[</span><span class="n">top</span><span class="p">[</span><span class="n">x</span><span class="p">]],</span> <span class="n">dfn</span><span class="p">[</span><span class="n">x</span><span class="p">]))</span> <span class="o">%</span> <span class="n">P</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">	<span class="p">}</span>
</span></span><span class="line"><span class="cl">	<span class="k">if</span><span class="p">(</span><span class="n">dep</span><span class="p">[</span><span class="n">x</span><span class="p">]</span> <span class="o">&gt;</span> <span class="n">dep</span><span class="p">[</span><span class="n">y</span><span class="p">])</span> <span class="n">swap</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">	<span class="k">return</span> <span class="p">(</span><span class="n">res</span> <span class="o">+</span> <span class="n">qry</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">n</span><span class="p">,</span> <span class="n">dfn</span><span class="p">[</span><span class="n">x</span><span class="p">],</span> <span class="n">dfn</span><span class="p">[</span><span class="n">y</span><span class="p">]))</span> <span class="o">%</span> <span class="n">P</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="kt">void</span> <span class="nf">addroot</span><span class="p">(</span><span class="kt">int</span> <span class="n">x</span><span class="p">,</span> <span class="kt">int</span> <span class="n">k</span><span class="p">)</span> <span class="p">{</span><span class="n">upd</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">n</span><span class="p">,</span> <span class="n">dfn</span><span class="p">[</span><span class="n">x</span><span class="p">],</span> <span class="n">dfn</span><span class="p">[</span><span class="n">x</span><span class="p">]</span> <span class="o">+</span> <span class="n">siz</span><span class="p">[</span><span class="n">x</span><span class="p">]</span> <span class="o">-</span> <span class="mi">1</span><span class="p">,</span> <span class="n">k</span><span class="p">);</span> <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="kt">int</span> <span class="nf">qryroot</span><span class="p">(</span><span class="kt">int</span> <span class="n">x</span><span class="p">)</span> <span class="p">{</span><span class="k">return</span> <span class="n">qry</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">n</span><span class="p">,</span> <span class="n">dfn</span><span class="p">[</span><span class="n">x</span><span class="p">],</span> <span class="n">dfn</span><span class="p">[</span><span class="n">x</span><span class="p">]</span> <span class="o">+</span> <span class="n">siz</span><span class="p">[</span><span class="n">x</span><span class="p">]</span> <span class="o">-</span> <span class="mi">1</span><span class="p">);}</span></span></span></code></pre></td></tr></table>
</div>
</div><h2 id="主席树" class="heading-element"><span>主席树</span>
  <a href="#%e4%b8%bb%e5%b8%ad%e6%a0%91" class="heading-mark">
    <svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg>
  </a>
</h2><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-c++" data-lang="c++"><span class="line"><span class="cl"><span class="k">struct</span> <span class="nc">JZM_T</span> <span class="p">{</span><span class="kt">int</span> <span class="n">ch</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span> <span class="n">v</span><span class="p">;}</span> <span class="n">t</span><span class="p">[</span><span class="n">MAXN</span> <span class="o">&lt;&lt;</span> <span class="mi">6</span><span class="p">];</span>
</span></span><span class="line"><span class="cl"><span class="kt">int</span> <span class="n">cnt</span><span class="p">,</span> <span class="n">rt</span><span class="p">[</span><span class="n">MAXN</span> <span class="o">&lt;&lt;</span> <span class="mi">6</span><span class="p">],</span> <span class="n">o</span><span class="p">[</span><span class="n">MAXN</span><span class="p">],</span> <span class="n">a</span><span class="p">[</span><span class="n">MAXN</span><span class="p">],</span> <span class="n">n</span><span class="p">,</span> <span class="n">m</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="kt">void</span> <span class="nf">build</span><span class="p">(</span><span class="kt">int</span> <span class="o">&amp;</span><span class="n">u</span><span class="p">,</span> <span class="kt">int</span> <span class="n">l</span><span class="p">,</span> <span class="kt">int</span> <span class="n">r</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">	<span class="n">t</span><span class="p">[</span><span class="n">u</span> <span class="o">=</span> <span class="o">++</span><span class="n">cnt</span><span class="p">].</span><span class="n">v</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">	<span class="k">if</span><span class="p">(</span><span class="n">l</span> <span class="o">!=</span> <span class="n">r</span><span class="p">)</span> <span class="n">build</span><span class="p">(</span><span class="n">L</span><span class="p">(</span><span class="n">u</span><span class="p">),</span> <span class="n">l</span><span class="p">,</span> <span class="n">mid</span><span class="p">),</span> <span class="n">build</span><span class="p">(</span><span class="n">R</span><span class="p">(</span><span class="n">u</span><span class="p">),</span> <span class="n">mid</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span> <span class="n">r</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="kt">void</span> <span class="nf">update</span><span class="p">(</span><span class="kt">int</span> <span class="o">&amp;</span><span class="n">u</span><span class="p">,</span> <span class="kt">int</span> <span class="n">v</span><span class="p">,</span> <span class="kt">int</span> <span class="n">l</span><span class="p">,</span> <span class="kt">int</span> <span class="n">r</span><span class="p">,</span> <span class="kt">int</span> <span class="n">p</span><span class="p">,</span> <span class="kt">int</span> <span class="n">k</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">	<span class="n">t</span><span class="p">[</span><span class="n">u</span> <span class="o">=</span> <span class="o">++</span><span class="n">cnt</span><span class="p">]</span> <span class="o">=</span> <span class="n">t</span><span class="p">[</span><span class="n">v</span><span class="p">];</span> <span class="n">t</span><span class="p">[</span><span class="n">u</span><span class="p">].</span><span class="n">v</span> <span class="o">+=</span> <span class="n">k</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">	<span class="k">if</span><span class="p">(</span><span class="n">l</span> <span class="o">!=</span> <span class="n">r</span><span class="p">)</span> <span class="n">p</span> <span class="o">&lt;=</span> <span class="n">mid</span> <span class="o">?</span> <span class="n">update</span><span class="p">(</span><span class="n">L</span><span class="p">(</span><span class="n">u</span><span class="p">),</span> <span class="n">L</span><span class="p">(</span><span class="n">v</span><span class="p">),</span> <span class="n">l</span><span class="p">,</span> <span class="n">mid</span><span class="p">,</span> <span class="n">p</span><span class="p">,</span> <span class="n">k</span><span class="p">)</span> <span class="o">:</span> <span class="n">update</span><span class="p">(</span><span class="n">R</span><span class="p">(</span><span class="n">u</span><span class="p">),</span> <span class="n">R</span><span class="p">(</span><span class="n">v</span><span class="p">),</span> <span class="n">mid</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span> <span class="n">r</span><span class="p">,</span> <span class="n">p</span><span class="p">,</span> <span class="n">k</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="kt">int</span> <span class="nf">query</span><span class="p">(</span><span class="kt">int</span> <span class="n">tl</span><span class="p">,</span> <span class="kt">int</span> <span class="n">tr</span><span class="p">,</span> <span class="kt">int</span> <span class="n">l</span><span class="p">,</span> <span class="kt">int</span> <span class="n">r</span><span class="p">,</span> <span class="kt">int</span> <span class="n">k</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">	<span class="k">if</span><span class="p">(</span><span class="n">l</span> <span class="o">==</span> <span class="n">r</span><span class="p">)</span> <span class="k">return</span> <span class="n">o</span><span class="p">[</span><span class="n">l</span><span class="p">];</span> <span class="kt">int</span> <span class="n">s</span> <span class="o">=</span> <span class="n">t</span><span class="p">[</span><span class="n">L</span><span class="p">(</span><span class="n">tr</span><span class="p">)].</span><span class="n">v</span> <span class="o">-</span> <span class="n">t</span><span class="p">[</span><span class="n">L</span><span class="p">(</span><span class="n">tl</span><span class="p">)].</span><span class="n">v</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">	<span class="k">return</span> <span class="n">k</span> <span class="o">&lt;=</span> <span class="n">s</span> <span class="o">?</span> <span class="n">query</span><span class="p">(</span><span class="n">L</span><span class="p">(</span><span class="n">tl</span><span class="p">),</span> <span class="n">L</span><span class="p">(</span><span class="n">tr</span><span class="p">),</span> <span class="n">l</span><span class="p">,</span> <span class="n">mid</span><span class="p">,</span> <span class="n">k</span><span class="p">)</span> <span class="o">:</span> <span class="n">query</span><span class="p">(</span><span class="n">R</span><span class="p">(</span><span class="n">tl</span><span class="p">),</span> <span class="n">R</span><span class="p">(</span><span class="n">tr</span><span class="p">),</span> <span class="n">mid</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span> <span class="n">r</span><span class="p">,</span> <span class="n">k</span><span class="o">-</span><span class="n">s</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="kt">int</span> <span class="nf">main</span><span class="p">()</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">	<span class="n">read</span><span class="p">(</span><span class="n">n</span><span class="p">);</span> <span class="n">read</span><span class="p">(</span><span class="n">m</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">	<span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;=</span> <span class="n">n</span><span class="p">;</span> <span class="o">++</span><span class="n">i</span><span class="p">)</span> <span class="n">read</span><span class="p">(</span><span class="n">a</span><span class="p">[</span><span class="n">i</span><span class="p">]),</span> <span class="n">o</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">a</span><span class="p">[</span><span class="n">i</span><span class="p">];</span>
</span></span><span class="line"><span class="cl">	<span class="n">sort</span><span class="p">(</span><span class="n">o</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span> <span class="n">o</span><span class="o">+</span><span class="n">n</span><span class="o">+</span><span class="mi">1</span><span class="p">);</span> <span class="kt">int</span> <span class="n">_n</span> <span class="o">=</span> <span class="n">unique</span><span class="p">(</span><span class="n">o</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span> <span class="n">o</span><span class="o">+</span><span class="n">n</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">-</span><span class="n">o</span><span class="o">-</span><span class="mi">1</span><span class="p">;</span> <span class="n">build</span><span class="p">(</span><span class="n">rt</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="mi">1</span><span class="p">,</span> <span class="n">_n</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">	<span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;=</span> <span class="n">n</span><span class="p">;</span> <span class="o">++</span><span class="n">i</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">		<span class="n">update</span><span class="p">(</span><span class="n">rt</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">rt</span><span class="p">[</span><span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="mi">1</span><span class="p">,</span> <span class="n">_n</span><span class="p">,</span> <span class="n">lower_bound</span><span class="p">(</span><span class="n">o</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span> <span class="n">o</span><span class="o">+</span><span class="n">_n</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span> <span class="n">a</span><span class="p">[</span><span class="n">i</span><span class="p">])</span><span class="o">-</span><span class="n">o</span><span class="p">,</span> <span class="mi">1</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">	<span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">l</span><span class="p">,</span> <span class="n">r</span><span class="p">,</span> <span class="n">k</span><span class="p">;</span> <span class="n">m</span><span class="o">--</span><span class="p">;</span> <span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">		<span class="n">read</span><span class="p">(</span><span class="n">l</span><span class="p">);</span> <span class="n">read</span><span class="p">(</span><span class="n">r</span><span class="p">);</span> <span class="n">read</span><span class="p">(</span><span class="n">k</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">		<span class="n">printf</span><span class="p">(</span><span class="s">&#34;%d</span><span class="se">\n</span><span class="s">&#34;</span><span class="p">,</span> <span class="n">query</span><span class="p">(</span><span class="n">rt</span><span class="p">[</span><span class="n">l</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="n">rt</span><span class="p">[</span><span class="n">r</span><span class="p">],</span> <span class="mi">1</span><span class="p">,</span> <span class="n">_n</span><span class="p">,</span> <span class="n">k</span><span class="p">));</span>
</span></span><span class="line"><span class="cl">	<span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span></span></span></code></pre></td></tr></table>
</div>
</div><h2 id="gcd-blackmagic" class="heading-element"><span>GCD-BlackMagic</span>
  <a href="#gcd-blackmagic" class="heading-mark">
    <svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg>
  </a>
</h2><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-C++" data-lang="C++"><span class="line"><span class="cl"><span class="kt">int</span> <span class="nf">gcd</span><span class="p">(</span><span class="kt">int</span> <span class="n">a</span><span class="p">,</span> <span class="kt">int</span> <span class="n">b</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">	<span class="kt">int</span> <span class="n">g</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">	<span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">tmp</span><span class="p">,</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="mi">3</span><span class="p">;</span> <span class="n">b</span> <span class="o">/=</span> <span class="n">tmp</span><span class="p">,</span> <span class="n">g</span> <span class="o">*=</span> <span class="n">tmp</span><span class="p">,</span> <span class="o">++</span><span class="n">i</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">		<span class="n">tmp</span> <span class="o">=</span> <span class="p">(</span><span class="n">k</span><span class="p">[</span><span class="n">a</span><span class="p">][</span><span class="n">i</span><span class="p">]</span> <span class="o">&gt;</span> <span class="n">siz</span><span class="p">)</span> <span class="o">?</span> <span class="p">(</span><span class="n">b</span> <span class="o">%</span> <span class="n">k</span><span class="p">[</span><span class="n">a</span><span class="p">][</span><span class="n">i</span><span class="p">]</span> <span class="o">==</span> <span class="mi">0</span> <span class="o">?</span> <span class="n">k</span><span class="p">[</span><span class="n">a</span><span class="p">][</span><span class="n">i</span><span class="p">]</span> <span class="o">:</span> <span class="mi">1</span><span class="p">)</span> <span class="o">:</span> <span class="n">_gcd</span><span class="p">[</span><span class="n">k</span><span class="p">[</span><span class="n">a</span><span class="p">][</span><span class="n">i</span><span class="p">]][</span><span class="n">b</span><span class="o">%</span><span class="n">k</span><span class="p">[</span><span class="n">a</span><span class="p">][</span><span class="n">i</span><span class="p">]];</span>
</span></span><span class="line"><span class="cl">	<span class="k">return</span> <span class="n">g</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="kt">int</span> <span class="nf">main</span><span class="p">()</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">	<span class="n">k</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">k</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">k</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span> <span class="n">notp</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">	<span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">2</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;=</span> <span class="n">V</span><span class="p">;</span> <span class="o">++</span><span class="n">i</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">		<span class="k">if</span><span class="p">(</span><span class="o">!</span><span class="n">notp</span><span class="p">[</span><span class="n">i</span><span class="p">])</span> <span class="n">p</span><span class="p">[</span><span class="o">++</span><span class="n">cnt</span><span class="p">]</span> <span class="o">=</span> <span class="n">i</span><span class="p">,</span> <span class="n">k</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="n">i</span><span class="p">,</span> <span class="n">k</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">k</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">		<span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">j</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span> <span class="n">p</span><span class="p">[</span><span class="n">j</span><span class="p">]</span> <span class="o">*</span> <span class="n">i</span> <span class="o">&lt;=</span> <span class="n">V</span><span class="p">;</span> <span class="o">++</span><span class="n">j</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">			<span class="n">notp</span><span class="p">[</span><span class="n">i</span> <span class="o">*</span> <span class="n">p</span><span class="p">[</span><span class="n">j</span><span class="p">]]</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span> <span class="kt">int</span> <span class="o">*</span><span class="n">t</span> <span class="o">=</span> <span class="n">k</span><span class="p">[</span><span class="n">i</span><span class="o">*</span><span class="n">p</span><span class="p">[</span><span class="n">j</span><span class="p">]];</span>
</span></span><span class="line"><span class="cl">			<span class="n">t</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">k</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span> <span class="o">*</span> <span class="n">p</span><span class="p">[</span><span class="n">j</span><span class="p">];</span> <span class="n">t</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">k</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">1</span><span class="p">];</span> <span class="n">t</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="n">k</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">2</span><span class="p">];</span>
</span></span><span class="line"><span class="cl">			<span class="k">if</span><span class="p">(</span><span class="n">t</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">&lt;</span> <span class="n">t</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="n">swap</span><span class="p">(</span><span class="n">t</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">t</span><span class="p">[</span><span class="mi">1</span><span class="p">]);</span> <span class="k">if</span><span class="p">(</span><span class="n">t</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">&lt;</span> <span class="n">t</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span> <span class="n">swap</span><span class="p">(</span><span class="n">t</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">t</span><span class="p">[</span><span class="mi">2</span><span class="p">]);</span>
</span></span><span class="line"><span class="cl">			<span class="k">if</span><span class="p">(</span><span class="n">i</span> <span class="o">%</span> <span class="n">p</span><span class="p">[</span><span class="n">j</span><span class="p">]</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="k">break</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">		<span class="p">}</span>
</span></span><span class="line"><span class="cl">	<span class="p">}</span>
</span></span><span class="line"><span class="cl">	<span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;=</span> <span class="n">siz</span><span class="p">;</span> <span class="o">++</span><span class="n">i</span><span class="p">)</span> <span class="n">_gcd</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">_gcd</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">i</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">	<span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">_max</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span> <span class="n">_max</span> <span class="o">&lt;=</span> <span class="n">siz</span><span class="p">;</span> <span class="o">++</span><span class="n">_max</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">		<span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;=</span> <span class="n">_max</span><span class="p">;</span> <span class="o">++</span><span class="n">i</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">			<span class="n">_gcd</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">_max</span><span class="p">]</span> <span class="o">=</span> <span class="n">_gcd</span><span class="p">[</span><span class="n">_max</span><span class="p">][</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">_gcd</span><span class="p">[</span><span class="n">_max</span> <span class="o">%</span> <span class="n">i</span><span class="p">][</span><span class="n">i</span><span class="p">];</span></span></span></code></pre></td></tr></table>
</div>
</div><h2 id="fft" class="heading-element"><span>FFT</span>
  <a href="#fft" class="heading-mark">
    <svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg>
  </a>
</h2><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-C++" data-lang="C++"><span class="line"><span class="cl"><span class="k">struct</span> <span class="nc">Complex</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">	<span class="kt">double</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">	<span class="n">Complex</span><span class="p">(</span><span class="kt">double</span> <span class="n">xx</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="kt">double</span> <span class="n">yy</span> <span class="o">=</span> <span class="mi">0</span><span class="p">)</span> <span class="p">{</span><span class="n">x</span> <span class="o">=</span> <span class="n">xx</span><span class="p">;</span> <span class="n">y</span> <span class="o">=</span> <span class="n">yy</span><span class="p">;}</span>
</span></span><span class="line"><span class="cl">	<span class="n">Complex</span> <span class="k">operator</span> <span class="o">+</span> <span class="p">(</span><span class="n">Complex</span> <span class="o">&amp;</span><span class="n">b</span><span class="p">)</span> <span class="k">const</span> <span class="p">{</span><span class="k">return</span> <span class="nf">Complex</span><span class="p">(</span><span class="n">x</span><span class="o">+</span><span class="n">b</span><span class="p">.</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="o">+</span><span class="n">b</span><span class="p">.</span><span class="n">y</span><span class="p">);}</span>
</span></span><span class="line"><span class="cl">	<span class="n">Complex</span> <span class="k">operator</span> <span class="o">-</span> <span class="p">(</span><span class="n">Complex</span> <span class="o">&amp;</span><span class="n">b</span><span class="p">)</span> <span class="k">const</span> <span class="p">{</span><span class="k">return</span> <span class="nf">Complex</span><span class="p">(</span><span class="n">x</span><span class="o">-</span><span class="n">b</span><span class="p">.</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="o">-</span><span class="n">b</span><span class="p">.</span><span class="n">y</span><span class="p">);}</span>
</span></span><span class="line"><span class="cl">	<span class="n">Complex</span> <span class="k">operator</span> <span class="o">*</span> <span class="p">(</span><span class="n">Complex</span> <span class="o">&amp;</span><span class="n">b</span><span class="p">)</span> <span class="k">const</span> <span class="p">{</span><span class="k">return</span> <span class="nf">Complex</span><span class="p">(</span><span class="n">x</span><span class="o">*</span><span class="n">b</span><span class="p">.</span><span class="n">x</span><span class="o">-</span><span class="n">y</span><span class="o">*</span><span class="n">b</span><span class="p">.</span><span class="n">y</span><span class="p">,</span> <span class="n">y</span><span class="o">*</span><span class="n">b</span><span class="p">.</span><span class="n">x</span><span class="o">+</span><span class="n">x</span><span class="o">*</span><span class="n">b</span><span class="p">.</span><span class="n">y</span><span class="p">);}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span> <span class="n">a</span><span class="p">[</span><span class="n">MAXN</span><span class="p">],</span> <span class="n">b</span><span class="p">[</span><span class="n">MAXN</span><span class="p">];</span>
</span></span><span class="line"><span class="cl"><span class="kt">int</span> <span class="n">r</span><span class="p">[</span><span class="n">MAXN</span><span class="p">],</span> <span class="n">n</span><span class="p">,</span> <span class="n">m</span><span class="p">,</span> <span class="n">l</span><span class="p">,</span> <span class="n">limit</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="kt">void</span> <span class="nf">FFT</span> <span class="p">(</span><span class="n">Complex</span> <span class="o">*</span><span class="n">A</span><span class="p">,</span> <span class="kt">int</span> <span class="n">t</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">	<span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">limit</span><span class="p">;</span> <span class="o">++</span><span class="n">i</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">		<span class="k">if</span><span class="p">(</span><span class="n">i</span> <span class="o">&lt;</span> <span class="n">r</span><span class="p">[</span><span class="n">i</span><span class="p">])</span> <span class="n">swap</span><span class="p">(</span><span class="n">A</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">A</span><span class="p">[</span><span class="n">r</span><span class="p">[</span><span class="n">i</span><span class="p">]]);</span>
</span></span><span class="line"><span class="cl">	<span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">mid</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span> <span class="n">mid</span> <span class="o">&lt;</span> <span class="n">limit</span><span class="p">;</span> <span class="n">mid</span> <span class="o">&lt;&lt;=</span> <span class="mi">1</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">		<span class="n">Complex</span> <span class="n">Wn</span> <span class="o">=</span> <span class="n">Complex</span><span class="p">(</span><span class="n">cos</span><span class="p">(</span><span class="n">Pi</span><span class="o">/</span><span class="n">mid</span><span class="p">),</span> <span class="n">t</span> <span class="o">*</span> <span class="n">sin</span><span class="p">(</span><span class="n">Pi</span><span class="o">/</span><span class="n">mid</span><span class="p">));</span>
</span></span><span class="line"><span class="cl">		<span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">R</span> <span class="o">=</span> <span class="n">mid</span><span class="o">&lt;&lt;</span><span class="mi">1</span><span class="p">,</span> <span class="n">j</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">j</span> <span class="o">&lt;</span> <span class="n">limit</span><span class="p">;</span> <span class="n">j</span> <span class="o">+=</span> <span class="n">R</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">			<span class="n">Complex</span> <span class="n">w</span> <span class="o">=</span> <span class="n">Complex</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">			<span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">k</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">k</span> <span class="o">&lt;</span> <span class="n">mid</span><span class="p">;</span> <span class="o">++</span><span class="n">k</span><span class="p">,</span> <span class="n">w</span> <span class="o">=</span> <span class="n">w</span> <span class="o">*</span> <span class="n">Wn</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">				<span class="n">Complex</span> <span class="n">x</span> <span class="o">=</span> <span class="n">A</span><span class="p">[</span><span class="n">j</span><span class="o">+</span><span class="n">k</span><span class="p">],</span> <span class="n">y</span> <span class="o">=</span> <span class="n">w</span><span class="o">*</span><span class="n">A</span><span class="p">[</span><span class="n">j</span><span class="o">+</span><span class="n">mid</span><span class="o">+</span><span class="n">k</span><span class="p">];</span>
</span></span><span class="line"><span class="cl">				<span class="n">A</span><span class="p">[</span><span class="n">j</span><span class="o">+</span><span class="n">k</span><span class="p">]</span> <span class="o">=</span> <span class="n">x</span><span class="o">+</span><span class="n">y</span><span class="p">;</span> <span class="n">A</span><span class="p">[</span><span class="n">j</span><span class="o">+</span><span class="n">mid</span><span class="o">+</span><span class="n">k</span><span class="p">]</span> <span class="o">=</span> <span class="n">x</span><span class="o">-</span><span class="n">y</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">			<span class="p">}</span>
</span></span><span class="line"><span class="cl">		<span class="p">}</span>
</span></span><span class="line"><span class="cl">	<span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="kt">int</span> <span class="nf">main</span><span class="p">()</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">	<span class="n">n</span> <span class="o">=</span> <span class="n">read</span><span class="p">();</span> <span class="n">m</span> <span class="o">=</span> <span class="n">read</span><span class="p">();</span>
</span></span><span class="line"><span class="cl">	<span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;=</span> <span class="n">n</span><span class="p">;</span> <span class="o">++</span><span class="n">i</span><span class="p">)</span> <span class="n">a</span><span class="p">[</span><span class="n">i</span><span class="p">].</span><span class="n">x</span> <span class="o">=</span> <span class="n">read</span><span class="p">();</span>
</span></span><span class="line"><span class="cl">	<span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;=</span> <span class="n">m</span><span class="p">;</span> <span class="o">++</span><span class="n">i</span><span class="p">)</span> <span class="n">b</span><span class="p">[</span><span class="n">i</span><span class="p">].</span><span class="n">x</span> <span class="o">=</span> <span class="n">read</span><span class="p">();</span>
</span></span><span class="line"><span class="cl">	<span class="k">for</span><span class="p">(</span><span class="n">limit</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span> <span class="n">limit</span> <span class="o">&lt;=</span> <span class="n">n</span><span class="o">+</span><span class="n">m</span><span class="p">;</span> <span class="n">limit</span> <span class="o">&lt;&lt;=</span> <span class="mi">1</span><span class="p">,</span> <span class="o">++</span><span class="n">l</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">	<span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">limit</span><span class="p">;</span> <span class="o">++</span><span class="n">i</span><span class="p">)</span> <span class="n">r</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="n">r</span><span class="p">[</span><span class="n">i</span><span class="o">&gt;&gt;</span><span class="mi">1</span><span class="p">]</span><span class="o">&gt;&gt;</span><span class="mi">1</span><span class="p">)</span><span class="o">|</span><span class="p">((</span><span class="n">i</span><span class="o">&amp;</span><span class="mi">1</span><span class="p">)</span><span class="o">&lt;&lt;</span><span class="p">(</span><span class="n">l</span><span class="o">-</span><span class="mi">1</span><span class="p">));</span>
</span></span><span class="line"><span class="cl">	<span class="n">FFT</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="mi">1</span><span class="p">);</span> <span class="n">FFT</span><span class="p">(</span><span class="n">b</span><span class="p">,</span> <span class="mi">1</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">	<span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;=</span> <span class="n">limit</span><span class="p">;</span> <span class="o">++</span><span class="n">i</span><span class="p">)</span> <span class="n">a</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">a</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">*</span><span class="n">b</span><span class="p">[</span><span class="n">i</span><span class="p">];</span>
</span></span><span class="line"><span class="cl">	<span class="n">FFT</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">	<span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;=</span> <span class="n">n</span><span class="o">+</span><span class="n">m</span><span class="p">;</span> <span class="o">++</span><span class="n">i</span><span class="p">)</span> <span class="n">printf</span><span class="p">(</span><span class="s">&#34;%d &#34;</span><span class="p">,</span> <span class="p">(</span><span class="kt">int</span><span class="p">)(</span><span class="n">a</span><span class="p">[</span><span class="n">i</span><span class="p">].</span><span class="n">x</span><span class="o">/</span><span class="n">limit</span><span class="o">+</span><span class="mf">0.5</span><span class="p">));</span>
</span></span><span class="line"><span class="cl">	<span class="n">puts</span><span class="p">(</span><span class="s">&#34;&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">	
</span></span><span class="line"><span class="cl"><span class="p">}</span> 
</span></span></code></pre></td></tr></table>
</div>
</div><h2 id="多项式" class="heading-element"><span>多项式</span>
  <a href="#%e5%a4%9a%e9%a1%b9%e5%bc%8f" class="heading-mark">
    <svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg>
  </a>
</h2><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">  1
</span><span class="lnt">  2
</span><span class="lnt">  3
</span><span class="lnt">  4
</span><span class="lnt">  5
</span><span class="lnt">  6
</span><span class="lnt">  7
</span><span class="lnt">  8
</span><span class="lnt">  9
</span><span class="lnt"> 10
</span><span class="lnt"> 11
</span><span class="lnt"> 12
</span><span class="lnt"> 13
</span><span class="lnt"> 14
</span><span class="lnt"> 15
</span><span class="lnt"> 16
</span><span class="lnt"> 17
</span><span class="lnt"> 18
</span><span class="lnt"> 19
</span><span class="lnt"> 20
</span><span class="lnt"> 21
</span><span class="lnt"> 22
</span><span class="lnt"> 23
</span><span class="lnt"> 24
</span><span class="lnt"> 25
</span><span class="lnt"> 26
</span><span class="lnt"> 27
</span><span class="lnt"> 28
</span><span class="lnt"> 29
</span><span class="lnt"> 30
</span><span class="lnt"> 31
</span><span class="lnt"> 32
</span><span class="lnt"> 33
</span><span class="lnt"> 34
</span><span class="lnt"> 35
</span><span class="lnt"> 36
</span><span class="lnt"> 37
</span><span class="lnt"> 38
</span><span class="lnt"> 39
</span><span class="lnt"> 40
</span><span class="lnt"> 41
</span><span class="lnt"> 42
</span><span class="lnt"> 43
</span><span class="lnt"> 44
</span><span class="lnt"> 45
</span><span class="lnt"> 46
</span><span class="lnt"> 47
</span><span class="lnt"> 48
</span><span class="lnt"> 49
</span><span class="lnt"> 50
</span><span class="lnt"> 51
</span><span class="lnt"> 52
</span><span class="lnt"> 53
</span><span class="lnt"> 54
</span><span class="lnt"> 55
</span><span class="lnt"> 56
</span><span class="lnt"> 57
</span><span class="lnt"> 58
</span><span class="lnt"> 59
</span><span class="lnt"> 60
</span><span class="lnt"> 61
</span><span class="lnt"> 62
</span><span class="lnt"> 63
</span><span class="lnt"> 64
</span><span class="lnt"> 65
</span><span class="lnt"> 66
</span><span class="lnt"> 67
</span><span class="lnt"> 68
</span><span class="lnt"> 69
</span><span class="lnt"> 70
</span><span class="lnt"> 71
</span><span class="lnt"> 72
</span><span class="lnt"> 73
</span><span class="lnt"> 74
</span><span class="lnt"> 75
</span><span class="lnt"> 76
</span><span class="lnt"> 77
</span><span class="lnt"> 78
</span><span class="lnt"> 79
</span><span class="lnt"> 80
</span><span class="lnt"> 81
</span><span class="lnt"> 82
</span><span class="lnt"> 83
</span><span class="lnt"> 84
</span><span class="lnt"> 85
</span><span class="lnt"> 86
</span><span class="lnt"> 87
</span><span class="lnt"> 88
</span><span class="lnt"> 89
</span><span class="lnt"> 90
</span><span class="lnt"> 91
</span><span class="lnt"> 92
</span><span class="lnt"> 93
</span><span class="lnt"> 94
</span><span class="lnt"> 95
</span><span class="lnt"> 96
</span><span class="lnt"> 97
</span><span class="lnt"> 98
</span><span class="lnt"> 99
</span><span class="lnt">100
</span><span class="lnt">101
</span><span class="lnt">102
</span><span class="lnt">103
</span><span class="lnt">104
</span><span class="lnt">105
</span><span class="lnt">106
</span><span class="lnt">107
</span><span class="lnt">108
</span><span class="lnt">109
</span><span class="lnt">110
</span><span class="lnt">111
</span><span class="lnt">112
</span><span class="lnt">113
</span><span class="lnt">114
</span><span class="lnt">115
</span><span class="lnt">116
</span><span class="lnt">117
</span><span class="lnt">118
</span><span class="lnt">119
</span><span class="lnt">120
</span><span class="lnt">121
</span><span class="lnt">122
</span><span class="lnt">123
</span><span class="lnt">124
</span><span class="lnt">125
</span><span class="lnt">126
</span><span class="lnt">127
</span><span class="lnt">128
</span><span class="lnt">129
</span><span class="lnt">130
</span><span class="lnt">131
</span><span class="lnt">132
</span><span class="lnt">133
</span><span class="lnt">134
</span><span class="lnt">135
</span><span class="lnt">136
</span><span class="lnt">137
</span><span class="lnt">138
</span><span class="lnt">139
</span><span class="lnt">140
</span><span class="lnt">141
</span><span class="lnt">142
</span><span class="lnt">143
</span><span class="lnt">144
</span><span class="lnt">145
</span><span class="lnt">146
</span><span class="lnt">147
</span><span class="lnt">148
</span><span class="lnt">149
</span><span class="lnt">150
</span><span class="lnt">151
</span><span class="lnt">152
</span><span class="lnt">153
</span><span class="lnt">154
</span><span class="lnt">155
</span><span class="lnt">156
</span><span class="lnt">157
</span><span class="lnt">158
</span><span class="lnt">159
</span><span class="lnt">160
</span><span class="lnt">161
</span><span class="lnt">162
</span><span class="lnt">163
</span><span class="lnt">164
</span><span class="lnt">165
</span><span class="lnt">166
</span><span class="lnt">167
</span><span class="lnt">168
</span><span class="lnt">169
</span><span class="lnt">170
</span><span class="lnt">171
</span><span class="lnt">172
</span><span class="lnt">173
</span><span class="lnt">174
</span><span class="lnt">175
</span><span class="lnt">176
</span><span class="lnt">177
</span><span class="lnt">178
</span><span class="lnt">179
</span><span class="lnt">180
</span><span class="lnt">181
</span><span class="lnt">182
</span><span class="lnt">183
</span><span class="lnt">184
</span><span class="lnt">185
</span><span class="lnt">186
</span><span class="lnt">187
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-c++" data-lang="c++"><span class="line"><span class="cl"><span class="cp">#include&lt;bits/stdc++.h&gt;
</span></span></span><span class="line"><span class="cl"><span class="cp">#define ll long long
</span></span></span><span class="line"><span class="cl"><span class="cp">#define FIO &#34;loj150&#34;
</span></span></span><span class="line"><span class="cl"><span class="cp"></span><span class="k">using</span> <span class="k">namespace</span> <span class="n">std</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="k">const</span> <span class="kt">int</span> <span class="n">N</span><span class="o">=</span><span class="mf">1e5</span><span class="o">+</span><span class="mi">5</span><span class="p">,</span><span class="n">MOD</span><span class="o">=</span><span class="mi">998244353</span><span class="p">,</span><span class="n">P</span><span class="o">=</span><span class="mi">19</span><span class="p">,</span><span class="n">INV2</span><span class="o">=</span><span class="n">MOD</span><span class="o">+</span><span class="mi">1</span><span class="o">&gt;&gt;</span><span class="mi">1</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kr">inline</span> <span class="kt">int</span> <span class="nf">add</span><span class="p">(</span><span class="kt">int</span> <span class="n">a</span><span class="p">,</span><span class="k">const</span> <span class="kt">int</span> <span class="o">&amp;</span><span class="n">b</span><span class="p">){</span><span class="k">if</span><span class="p">((</span><span class="n">a</span><span class="o">+=</span><span class="n">b</span><span class="p">)</span><span class="o">&gt;=</span><span class="n">MOD</span><span class="p">)</span><span class="n">a</span><span class="o">-=</span><span class="n">MOD</span><span class="p">;</span><span class="k">return</span> <span class="n">a</span><span class="p">;}</span>
</span></span><span class="line"><span class="cl"><span class="kr">inline</span> <span class="kt">int</span> <span class="nf">sub</span><span class="p">(</span><span class="kt">int</span> <span class="n">a</span><span class="p">,</span><span class="k">const</span> <span class="kt">int</span> <span class="o">&amp;</span><span class="n">b</span><span class="p">){</span><span class="k">if</span><span class="p">((</span><span class="n">a</span><span class="o">-=</span><span class="n">b</span><span class="p">)</span><span class="o">&lt;</span>		<span class="mi">0</span><span class="p">)</span><span class="n">a</span><span class="o">+=</span><span class="n">MOD</span><span class="p">;</span><span class="k">return</span> <span class="n">a</span><span class="p">;}</span>
</span></span><span class="line"><span class="cl"><span class="kr">inline</span> <span class="kt">int</span> <span class="nf">mul</span><span class="p">(</span><span class="k">const</span> <span class="kt">int</span> <span class="o">&amp;</span><span class="n">a</span><span class="p">,</span><span class="k">const</span> <span class="kt">int</span> <span class="o">&amp;</span><span class="n">b</span><span class="p">){</span><span class="k">return</span> <span class="mi">1ll</span><span class="o">*</span><span class="n">a</span><span class="o">*</span><span class="n">b</span><span class="o">%</span><span class="n">MOD</span><span class="p">;}</span>
</span></span><span class="line"><span class="cl"><span class="kr">inline</span> <span class="kt">void</span> <span class="nf">inc</span><span class="p">(</span><span class="kt">int</span> <span class="o">&amp;</span><span class="n">a</span><span class="p">,</span><span class="k">const</span> <span class="kt">int</span> <span class="o">&amp;</span><span class="n">b</span><span class="o">=</span><span class="mi">1</span><span class="p">){</span><span class="n">a</span><span class="o">=</span><span class="n">add</span><span class="p">(</span><span class="n">a</span><span class="p">,</span><span class="n">b</span><span class="p">);}</span>
</span></span><span class="line"><span class="cl"><span class="kr">inline</span> <span class="kt">void</span> <span class="nf">dec</span><span class="p">(</span><span class="kt">int</span> <span class="o">&amp;</span><span class="n">a</span><span class="p">,</span><span class="k">const</span> <span class="kt">int</span> <span class="o">&amp;</span><span class="n">b</span><span class="o">=</span><span class="mi">1</span><span class="p">){</span><span class="n">a</span><span class="o">=</span><span class="n">sub</span><span class="p">(</span><span class="n">a</span><span class="p">,</span><span class="n">b</span><span class="p">);}</span>
</span></span><span class="line"><span class="cl"><span class="kr">inline</span> <span class="kt">void</span> <span class="nf">pro</span><span class="p">(</span><span class="kt">int</span> <span class="o">&amp;</span><span class="n">a</span><span class="p">,</span><span class="k">const</span> <span class="kt">int</span> <span class="o">&amp;</span><span class="n">b</span><span class="p">){</span><span class="n">a</span><span class="o">=</span><span class="n">mul</span><span class="p">(</span><span class="n">a</span><span class="p">,</span><span class="n">b</span><span class="p">);}</span>
</span></span><span class="line"><span class="cl"><span class="kr">inline</span> <span class="kt">int</span> <span class="nf">qpow</span><span class="p">(</span><span class="kt">int</span> <span class="n">a</span><span class="p">,</span><span class="kt">int</span> <span class="n">b</span><span class="p">){</span><span class="kt">int</span> <span class="n">c</span><span class="o">=</span><span class="mi">1</span><span class="p">;</span><span class="k">for</span><span class="p">(;</span><span class="n">b</span><span class="p">;</span><span class="n">b</span><span class="o">&gt;&gt;=</span><span class="mi">1</span><span class="p">,</span><span class="n">pro</span><span class="p">(</span><span class="n">a</span><span class="p">,</span><span class="n">a</span><span class="p">))</span><span class="k">if</span><span class="p">(</span><span class="n">b</span><span class="o">&amp;</span><span class="mi">1</span><span class="p">)</span><span class="n">pro</span><span class="p">(</span><span class="n">c</span><span class="p">,</span><span class="n">a</span><span class="p">);</span><span class="k">return</span> <span class="n">c</span><span class="p">;}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kt">int</span> <span class="n">n</span><span class="p">,</span><span class="n">k</span><span class="p">,</span><span class="n">w</span><span class="p">[</span><span class="mi">2</span><span class="p">][</span><span class="mi">1</span><span class="o">&lt;&lt;</span><span class="n">P</span><span class="p">];</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kr">inline</span> <span class="kt">void</span> <span class="nf">pre</span><span class="p">(){</span>
</span></span><span class="line"><span class="cl">	<span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">i</span><span class="o">=</span><span class="mi">1</span><span class="p">;</span><span class="n">i</span><span class="o">&lt;</span><span class="mi">1</span><span class="o">&lt;&lt;</span><span class="n">P</span><span class="p">;</span><span class="n">i</span><span class="o">&lt;&lt;=</span><span class="mi">1</span><span class="p">){</span>
</span></span><span class="line"><span class="cl">		<span class="n">w</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="n">i</span><span class="p">]</span><span class="o">=</span><span class="n">w</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="n">i</span><span class="p">]</span><span class="o">=</span><span class="mi">1</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">		<span class="kt">int</span> <span class="n">wn1</span><span class="o">=</span><span class="n">qpow</span><span class="p">(</span><span class="mi">3</span><span class="p">,(</span><span class="n">MOD</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="n">i</span><span class="o">&lt;&lt;</span><span class="mi">1</span><span class="p">)),</span><span class="n">wn0</span><span class="o">=</span><span class="n">qpow</span><span class="p">(</span><span class="n">wn1</span><span class="p">,</span><span class="n">MOD</span><span class="o">-</span><span class="mi">2</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">		<span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">j</span><span class="o">=</span><span class="mi">1</span><span class="p">;</span><span class="n">j</span><span class="o">&lt;</span><span class="n">i</span><span class="p">;</span><span class="n">j</span><span class="o">++</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">			<span class="n">w</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="n">i</span><span class="o">+</span><span class="n">j</span><span class="p">]</span><span class="o">=</span><span class="n">mul</span><span class="p">(</span><span class="n">w</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="n">i</span><span class="o">+</span><span class="n">j</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span><span class="n">wn0</span><span class="p">),</span><span class="n">w</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="n">i</span><span class="o">+</span><span class="n">j</span><span class="p">]</span><span class="o">=</span><span class="n">mul</span><span class="p">(</span><span class="n">w</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="n">i</span><span class="o">+</span><span class="n">j</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span><span class="n">wn1</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">	<span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="cp">#define poly vector&lt;int&gt; 
</span></span></span><span class="line"><span class="cl"><span class="cp"></span><span class="kr">inline</span> <span class="kt">void</span> <span class="nf">read</span><span class="p">(</span><span class="n">poly</span> <span class="o">&amp;</span><span class="n">a</span><span class="p">,</span><span class="k">const</span> <span class="kt">int</span> <span class="o">&amp;</span><span class="n">n</span><span class="p">){</span>
</span></span><span class="line"><span class="cl">	<span class="n">a</span><span class="p">.</span><span class="n">resize</span><span class="p">(</span><span class="n">n</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">	<span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">i</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span><span class="n">i</span><span class="o">&lt;</span><span class="n">n</span><span class="p">;</span><span class="n">i</span><span class="o">++</span><span class="p">)</span><span class="n">scanf</span><span class="p">(</span><span class="s">&#34;%d&#34;</span><span class="p">,</span><span class="o">&amp;</span><span class="n">a</span><span class="p">[</span><span class="n">i</span><span class="p">]);</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kr">inline</span> <span class="kt">void</span> <span class="nf">out</span><span class="p">(</span><span class="k">const</span> <span class="n">poly</span> <span class="o">&amp;</span><span class="n">a</span><span class="p">){</span>
</span></span><span class="line"><span class="cl">	<span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">i</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span><span class="n">n</span><span class="o">=</span><span class="n">a</span><span class="p">.</span><span class="n">size</span><span class="p">();</span><span class="n">i</span><span class="o">&lt;</span><span class="n">n</span><span class="p">;</span><span class="n">i</span><span class="o">++</span><span class="p">)</span><span class="n">printf</span><span class="p">(</span><span class="s">&#34;%d%c&#34;</span><span class="p">,</span><span class="n">a</span><span class="p">[</span><span class="n">i</span><span class="p">],</span><span class="n">i</span><span class="o">^</span><span class="n">n</span><span class="o">-</span><span class="mi">1</span><span class="o">?</span><span class="sc">&#39; &#39;</span><span class="o">:</span><span class="sc">&#39;\n&#39;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kr">inline</span> <span class="kt">void</span> <span class="nf">clear</span><span class="p">(</span><span class="n">poly</span> <span class="o">&amp;</span><span class="n">a</span><span class="p">){</span>
</span></span><span class="line"><span class="cl">	<span class="kt">int</span> <span class="n">n</span><span class="o">=</span><span class="n">a</span><span class="p">.</span><span class="n">size</span><span class="p">();</span>
</span></span><span class="line"><span class="cl">	<span class="k">while</span><span class="p">(</span><span class="n">n</span><span class="o">&gt;</span><span class="mi">1</span><span class="o">&amp;&amp;!</span><span class="n">a</span><span class="p">[</span><span class="n">n</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span><span class="n">n</span><span class="o">--</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">	<span class="n">a</span><span class="p">.</span><span class="n">resize</span><span class="p">(</span><span class="n">n</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kr">inline</span> <span class="n">poly</span> <span class="k">operator</span> <span class="o">+</span><span class="p">(</span><span class="n">poly</span> <span class="n">a</span><span class="p">,</span><span class="k">const</span> <span class="kt">int</span> <span class="o">&amp;</span><span class="n">b</span><span class="p">){</span><span class="n">inc</span><span class="p">(</span><span class="n">a</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="n">b</span><span class="p">);</span><span class="k">return</span> <span class="n">a</span><span class="p">;}</span>
</span></span><span class="line"><span class="cl"><span class="kr">inline</span> <span class="n">poly</span> <span class="k">operator</span> <span class="o">+</span><span class="p">(</span><span class="k">const</span> <span class="kt">int</span> <span class="o">&amp;</span><span class="n">b</span><span class="p">,</span><span class="n">poly</span> <span class="n">a</span><span class="p">){</span><span class="n">inc</span><span class="p">(</span><span class="n">a</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="n">b</span><span class="p">);</span><span class="k">return</span> <span class="n">a</span><span class="p">;}</span>
</span></span><span class="line"><span class="cl"><span class="kr">inline</span> <span class="n">poly</span> <span class="k">operator</span> <span class="o">-</span><span class="p">(</span><span class="n">poly</span> <span class="n">a</span><span class="p">,</span><span class="k">const</span> <span class="kt">int</span> <span class="o">&amp;</span><span class="n">b</span><span class="p">){</span><span class="n">dec</span><span class="p">(</span><span class="n">a</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="n">b</span><span class="p">);</span><span class="k">return</span> <span class="n">a</span><span class="p">;}</span>
</span></span><span class="line"><span class="cl"><span class="kr">inline</span> <span class="n">poly</span> <span class="k">operator</span> <span class="o">-</span><span class="p">(</span><span class="k">const</span> <span class="kt">int</span> <span class="o">&amp;</span><span class="n">b</span><span class="p">,</span><span class="n">poly</span> <span class="n">a</span><span class="p">){</span><span class="n">dec</span><span class="p">(</span><span class="n">a</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="n">b</span><span class="p">);</span><span class="k">return</span> <span class="n">a</span><span class="p">;}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kr">inline</span> <span class="n">poly</span> <span class="k">operator</span> <span class="o">+</span><span class="p">(</span><span class="n">poly</span> <span class="n">a</span><span class="p">,</span><span class="k">const</span> <span class="n">poly</span> <span class="o">&amp;</span><span class="n">b</span><span class="p">){</span>
</span></span><span class="line"><span class="cl">	<span class="k">if</span><span class="p">(</span><span class="n">a</span><span class="p">.</span><span class="n">size</span><span class="p">()</span><span class="o">&lt;</span><span class="n">b</span><span class="p">.</span><span class="n">size</span><span class="p">())</span><span class="n">a</span><span class="p">.</span><span class="n">resize</span><span class="p">(</span><span class="n">b</span><span class="p">.</span><span class="n">size</span><span class="p">());</span>
</span></span><span class="line"><span class="cl">	<span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">i</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span><span class="n">n</span><span class="o">=</span><span class="n">a</span><span class="p">.</span><span class="n">size</span><span class="p">();</span><span class="n">i</span><span class="o">&lt;</span><span class="n">n</span><span class="p">;</span><span class="n">i</span><span class="o">++</span><span class="p">)</span><span class="n">inc</span><span class="p">(</span><span class="n">a</span><span class="p">[</span><span class="n">i</span><span class="p">],</span><span class="n">b</span><span class="p">[</span><span class="n">i</span><span class="p">]);</span>
</span></span><span class="line"><span class="cl">	<span class="k">return</span> <span class="n">a</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kr">inline</span> <span class="n">poly</span> <span class="k">operator</span> <span class="o">-</span><span class="p">(</span><span class="n">poly</span> <span class="n">a</span><span class="p">,</span><span class="k">const</span> <span class="n">poly</span> <span class="o">&amp;</span><span class="n">b</span><span class="p">){</span>
</span></span><span class="line"><span class="cl">	<span class="k">if</span><span class="p">(</span><span class="n">a</span><span class="p">.</span><span class="n">size</span><span class="p">()</span><span class="o">&lt;</span><span class="n">b</span><span class="p">.</span><span class="n">size</span><span class="p">())</span><span class="n">a</span><span class="p">.</span><span class="n">resize</span><span class="p">(</span><span class="n">b</span><span class="p">.</span><span class="n">size</span><span class="p">());</span>
</span></span><span class="line"><span class="cl">	<span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">i</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span><span class="n">n</span><span class="o">=</span><span class="n">a</span><span class="p">.</span><span class="n">size</span><span class="p">();</span><span class="n">i</span><span class="o">&lt;</span><span class="n">n</span><span class="p">;</span><span class="n">i</span><span class="o">++</span><span class="p">)</span><span class="n">dec</span><span class="p">(</span><span class="n">a</span><span class="p">[</span><span class="n">i</span><span class="p">],</span><span class="n">b</span><span class="p">[</span><span class="n">i</span><span class="p">]);</span>
</span></span><span class="line"><span class="cl">	<span class="k">return</span> <span class="n">a</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kr">inline</span> <span class="kt">void</span> <span class="nf">ntt</span><span class="p">(</span><span class="kt">int</span> <span class="o">*</span><span class="n">f</span><span class="p">,</span><span class="kt">int</span> <span class="n">opt</span><span class="p">,</span><span class="kt">int</span> <span class="n">l</span><span class="p">){</span>
</span></span><span class="line"><span class="cl">	<span class="n">poly</span> <span class="n">rev</span><span class="p">(</span><span class="n">l</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">	<span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">i</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span><span class="n">i</span><span class="o">&lt;</span><span class="n">l</span><span class="p">;</span><span class="n">i</span><span class="o">++</span><span class="p">){</span><span class="n">rev</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">=</span><span class="p">(</span><span class="n">rev</span><span class="p">[</span><span class="n">i</span><span class="o">&gt;&gt;</span><span class="mi">1</span><span class="p">]</span><span class="o">&gt;&gt;</span><span class="mi">1</span><span class="p">)</span><span class="o">|</span><span class="p">((</span><span class="n">i</span><span class="o">&amp;</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">l</span><span class="o">&gt;&gt;</span><span class="mi">1</span><span class="p">));</span><span class="k">if</span><span class="p">(</span><span class="n">i</span><span class="o">&lt;</span><span class="n">rev</span><span class="p">[</span><span class="n">i</span><span class="p">])</span><span class="n">swap</span><span class="p">(</span><span class="n">f</span><span class="p">[</span><span class="n">i</span><span class="p">],</span><span class="n">f</span><span class="p">[</span><span class="n">rev</span><span class="p">[</span><span class="n">i</span><span class="p">]]);}</span>
</span></span><span class="line"><span class="cl">	<span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">i</span><span class="o">=</span><span class="mi">1</span><span class="p">;</span><span class="n">i</span><span class="o">&lt;</span><span class="n">l</span><span class="p">;</span><span class="n">i</span><span class="o">&lt;&lt;=</span><span class="mi">1</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">		<span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">j</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span><span class="n">j</span><span class="o">&lt;</span><span class="n">l</span><span class="p">;</span><span class="n">j</span><span class="o">+=</span><span class="n">i</span><span class="o">&lt;&lt;</span><span class="mi">1</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">			<span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">k</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span><span class="n">k</span><span class="o">&lt;</span><span class="n">i</span><span class="p">;</span><span class="n">k</span><span class="o">++</span><span class="p">){</span>
</span></span><span class="line"><span class="cl">				<span class="kt">int</span> <span class="n">x</span><span class="o">=</span><span class="n">f</span><span class="p">[</span><span class="n">j</span><span class="o">+</span><span class="n">k</span><span class="p">],</span><span class="n">y</span><span class="o">=</span><span class="n">mul</span><span class="p">(</span><span class="n">f</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="n">j</span><span class="o">+</span><span class="n">k</span><span class="p">],</span><span class="n">w</span><span class="p">[</span><span class="n">opt</span><span class="p">][</span><span class="n">i</span><span class="o">+</span><span class="n">k</span><span class="p">]);</span>
</span></span><span class="line"><span class="cl">				<span class="n">f</span><span class="p">[</span><span class="n">j</span><span class="o">+</span><span class="n">k</span><span class="p">]</span><span class="o">=</span><span class="n">add</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">				<span class="n">f</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="n">j</span><span class="o">+</span><span class="n">k</span><span class="p">]</span><span class="o">=</span><span class="n">sub</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">			<span class="p">}</span>
</span></span><span class="line"><span class="cl">	<span class="k">if</span><span class="p">(</span><span class="n">opt</span><span class="p">)</span><span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">i</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span><span class="n">inv</span><span class="o">=</span><span class="n">qpow</span><span class="p">(</span><span class="n">l</span><span class="p">,</span><span class="n">MOD</span><span class="o">-</span><span class="mi">2</span><span class="p">);</span><span class="n">i</span><span class="o">&lt;</span><span class="n">l</span><span class="p">;</span><span class="n">i</span><span class="o">++</span><span class="p">)</span><span class="n">pro</span><span class="p">(</span><span class="n">f</span><span class="p">[</span><span class="n">i</span><span class="p">],</span><span class="n">inv</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kr">inline</span> <span class="n">poly</span> <span class="k">operator</span> <span class="o">*</span><span class="p">(</span><span class="n">poly</span> <span class="n">a</span><span class="p">,</span><span class="n">poly</span> <span class="n">b</span><span class="p">){</span>
</span></span><span class="line"><span class="cl">	<span class="kt">int</span> <span class="n">n</span><span class="o">=</span><span class="n">a</span><span class="p">.</span><span class="n">size</span><span class="p">(),</span><span class="n">m</span><span class="o">=</span><span class="n">b</span><span class="p">.</span><span class="n">size</span><span class="p">(),</span><span class="n">l</span><span class="o">=</span><span class="mi">1</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">	<span class="k">while</span><span class="p">(</span><span class="n">l</span><span class="o">&lt;</span><span class="n">n</span><span class="o">+</span><span class="n">m</span><span class="p">)</span><span class="n">l</span><span class="o">&lt;&lt;=</span><span class="mi">1</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">	<span class="n">a</span><span class="p">.</span><span class="n">resize</span><span class="p">(</span><span class="n">l</span><span class="p">);</span><span class="n">b</span><span class="p">.</span><span class="n">resize</span><span class="p">(</span><span class="n">l</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">	<span class="n">ntt</span><span class="p">(</span><span class="o">&amp;</span><span class="n">a</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="mi">0</span><span class="p">,</span><span class="n">l</span><span class="p">);</span><span class="n">ntt</span><span class="p">(</span><span class="o">&amp;</span><span class="n">b</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="mi">0</span><span class="p">,</span><span class="n">l</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">	<span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">i</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span><span class="n">i</span><span class="o">&lt;</span><span class="n">l</span><span class="p">;</span><span class="n">i</span><span class="o">++</span><span class="p">)</span><span class="n">pro</span><span class="p">(</span><span class="n">a</span><span class="p">[</span><span class="n">i</span><span class="p">],</span><span class="n">b</span><span class="p">[</span><span class="n">i</span><span class="p">]);</span>
</span></span><span class="line"><span class="cl">	<span class="n">ntt</span><span class="p">(</span><span class="o">&amp;</span><span class="n">a</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="mi">1</span><span class="p">,</span><span class="n">l</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">	<span class="n">clear</span><span class="p">(</span><span class="n">a</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">	<span class="k">return</span> <span class="n">a</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kr">inline</span> <span class="n">poly</span><span class="o">&amp;</span> <span class="k">operator</span> <span class="o">*=</span><span class="p">(</span><span class="n">poly</span> <span class="o">&amp;</span><span class="n">a</span><span class="p">,</span><span class="k">const</span> <span class="n">poly</span> <span class="n">b</span><span class="p">){</span><span class="k">return</span> <span class="n">a</span><span class="o">=</span><span class="n">a</span><span class="o">*</span><span class="n">b</span><span class="p">;}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kr">inline</span> <span class="n">poly</span> <span class="k">operator</span> <span class="o">*</span><span class="p">(</span><span class="n">poly</span> <span class="n">a</span><span class="p">,</span><span class="k">const</span> <span class="kt">int</span> <span class="o">&amp;</span><span class="n">b</span><span class="p">){</span>
</span></span><span class="line"><span class="cl">	<span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">i</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span><span class="n">n</span><span class="o">=</span><span class="n">a</span><span class="p">.</span><span class="n">size</span><span class="p">();</span><span class="n">i</span><span class="o">&lt;</span><span class="n">n</span><span class="p">;</span><span class="n">i</span><span class="o">++</span><span class="p">)</span><span class="n">pro</span><span class="p">(</span><span class="n">a</span><span class="p">[</span><span class="n">i</span><span class="p">],</span><span class="n">b</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">	<span class="k">return</span> <span class="n">a</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kr">inline</span> <span class="n">poly</span> <span class="nf">inv</span><span class="p">(</span><span class="k">const</span> <span class="n">poly</span> <span class="o">&amp;</span><span class="n">a</span><span class="p">,</span><span class="k">const</span> <span class="kt">int</span> <span class="o">&amp;</span><span class="n">n</span><span class="p">){</span>
</span></span><span class="line"><span class="cl">	<span class="k">if</span><span class="p">(</span><span class="n">n</span><span class="o">==</span><span class="mi">1</span><span class="p">)</span><span class="k">return</span> <span class="n">poly</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="n">qpow</span><span class="p">(</span><span class="n">a</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="n">MOD</span><span class="o">-</span><span class="mi">2</span><span class="p">));</span>
</span></span><span class="line"><span class="cl">	<span class="kt">int</span> <span class="n">l</span><span class="o">=</span><span class="mi">1</span><span class="p">;</span><span class="k">while</span><span class="p">(</span><span class="n">l</span><span class="o">&lt;=</span><span class="n">n</span><span class="o">&lt;&lt;</span><span class="mi">1</span><span class="p">)</span><span class="n">l</span><span class="o">&lt;&lt;=</span><span class="mi">1</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">	<span class="n">poly</span> <span class="n">b</span><span class="o">=</span><span class="n">inv</span><span class="p">(</span><span class="n">a</span><span class="p">,</span><span class="n">n</span><span class="o">+</span><span class="mi">1</span><span class="o">&gt;&gt;</span><span class="mi">1</span><span class="p">),</span><span class="n">c</span><span class="p">(</span><span class="n">l</span><span class="p">);</span><span class="n">b</span><span class="p">.</span><span class="n">resize</span><span class="p">(</span><span class="n">l</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">	<span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">i</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span><span class="n">i</span><span class="o">&lt;</span><span class="n">n</span><span class="p">;</span><span class="n">i</span><span class="o">++</span><span class="p">)</span><span class="n">c</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">=</span><span class="n">a</span><span class="p">[</span><span class="n">i</span><span class="p">];</span>
</span></span><span class="line"><span class="cl">	<span class="n">ntt</span><span class="p">(</span><span class="o">&amp;</span><span class="n">b</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="mi">0</span><span class="p">,</span><span class="n">l</span><span class="p">);</span><span class="n">ntt</span><span class="p">(</span><span class="o">&amp;</span><span class="n">c</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="mi">0</span><span class="p">,</span><span class="n">l</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">	<span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">i</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span><span class="n">i</span><span class="o">&lt;</span><span class="n">l</span><span class="p">;</span><span class="n">i</span><span class="o">++</span><span class="p">)</span><span class="n">pro</span><span class="p">(</span><span class="n">b</span><span class="p">[</span><span class="n">i</span><span class="p">],</span><span class="n">sub</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="n">mul</span><span class="p">(</span><span class="n">b</span><span class="p">[</span><span class="n">i</span><span class="p">],</span><span class="n">c</span><span class="p">[</span><span class="n">i</span><span class="p">])));</span>
</span></span><span class="line"><span class="cl">	<span class="n">ntt</span><span class="p">(</span><span class="o">&amp;</span><span class="n">b</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="mi">1</span><span class="p">,</span><span class="n">l</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">	<span class="n">b</span><span class="p">.</span><span class="n">resize</span><span class="p">(</span><span class="n">n</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">	<span class="n">clear</span><span class="p">(</span><span class="n">b</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">	<span class="k">return</span> <span class="n">b</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kr">inline</span> <span class="n">poly</span> <span class="nf">inv</span><span class="p">(</span><span class="k">const</span> <span class="n">poly</span> <span class="o">&amp;</span><span class="n">a</span><span class="p">){</span><span class="k">return</span> <span class="n">inv</span><span class="p">(</span><span class="n">a</span><span class="p">,</span><span class="n">a</span><span class="p">.</span><span class="n">size</span><span class="p">());}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kt">int</span> <span class="n">B</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="cp">#define pii pair&lt;int,int&gt;
</span></span></span><span class="line"><span class="cl"><span class="cp"></span><span class="kr">inline</span> <span class="n">pii</span> <span class="k">operator</span> <span class="o">*</span><span class="p">(</span><span class="n">pii</span> <span class="n">a</span><span class="p">,</span><span class="n">pii</span> <span class="n">b</span><span class="p">){</span>
</span></span><span class="line"><span class="cl">	<span class="k">return</span> <span class="nf">pii</span><span class="p">(</span><span class="n">add</span><span class="p">(</span><span class="n">mul</span><span class="p">(</span><span class="n">a</span><span class="p">.</span><span class="n">first</span><span class="p">,</span><span class="n">b</span><span class="p">.</span><span class="n">first</span><span class="p">),</span><span class="n">mul</span><span class="p">(</span><span class="n">mul</span><span class="p">(</span><span class="n">a</span><span class="p">.</span><span class="n">second</span><span class="p">,</span><span class="n">b</span><span class="p">.</span><span class="n">second</span><span class="p">),</span><span class="n">B</span><span class="p">)),</span><span class="n">add</span><span class="p">(</span><span class="n">mul</span><span class="p">(</span><span class="n">a</span><span class="p">.</span><span class="n">first</span><span class="p">,</span><span class="n">b</span><span class="p">.</span><span class="n">second</span><span class="p">),</span><span class="n">mul</span><span class="p">(</span><span class="n">a</span><span class="p">.</span><span class="n">second</span><span class="p">,</span><span class="n">b</span><span class="p">.</span><span class="n">first</span><span class="p">)));</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="kr">inline</span> <span class="n">pii</span> <span class="nf">qpow</span><span class="p">(</span><span class="n">pii</span> <span class="n">a</span><span class="p">,</span><span class="kt">int</span> <span class="n">b</span><span class="p">){</span><span class="n">pii</span> <span class="n">c</span><span class="o">=</span><span class="n">pii</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">);</span><span class="k">for</span><span class="p">(;</span><span class="n">b</span><span class="p">;</span><span class="n">b</span><span class="o">&gt;&gt;=</span><span class="mi">1</span><span class="p">,</span><span class="n">a</span><span class="o">=</span><span class="n">a</span><span class="o">*</span><span class="n">a</span><span class="p">)</span><span class="k">if</span><span class="p">(</span><span class="n">b</span><span class="o">&amp;</span><span class="mi">1</span><span class="p">)</span><span class="n">c</span><span class="o">=</span><span class="n">c</span><span class="o">*</span><span class="n">a</span><span class="p">;</span><span class="k">return</span> <span class="n">c</span><span class="p">;}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kr">inline</span> <span class="kt">int</span> <span class="nf">remain</span><span class="p">(</span><span class="kt">int</span> <span class="n">x</span><span class="p">){</span>
</span></span><span class="line"><span class="cl">	<span class="k">if</span><span class="p">(</span><span class="n">x</span><span class="o">&lt;=</span><span class="mi">1</span><span class="p">)</span><span class="k">return</span> <span class="n">x</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">	<span class="kt">int</span> <span class="n">a</span><span class="o">=</span><span class="n">mul</span><span class="p">(</span><span class="n">mul</span><span class="p">(</span><span class="n">rand</span><span class="p">(),</span><span class="n">rand</span><span class="p">()),</span><span class="n">rand</span><span class="p">());</span>
</span></span><span class="line"><span class="cl">	<span class="k">while</span><span class="p">(</span><span class="n">qpow</span><span class="p">(</span><span class="n">B</span><span class="o">=</span><span class="n">sub</span><span class="p">(</span><span class="n">mul</span><span class="p">(</span><span class="n">a</span><span class="p">,</span><span class="n">a</span><span class="p">),</span><span class="n">x</span><span class="p">),</span><span class="n">MOD</span><span class="o">-</span><span class="mi">1</span><span class="o">&gt;&gt;</span><span class="mi">1</span><span class="p">)</span><span class="o">==</span><span class="mi">1</span><span class="p">)</span><span class="n">a</span><span class="o">=</span><span class="n">mul</span><span class="p">(</span><span class="n">mul</span><span class="p">(</span><span class="n">rand</span><span class="p">(),</span><span class="n">rand</span><span class="p">()),</span><span class="n">rand</span><span class="p">());</span>
</span></span><span class="line"><span class="cl">	<span class="n">pii</span> <span class="n">A</span><span class="o">=</span><span class="n">pii</span><span class="p">(</span><span class="n">a</span><span class="p">,</span><span class="mi">1</span><span class="p">),</span><span class="n">ans</span><span class="o">=</span><span class="n">qpow</span><span class="p">(</span><span class="n">A</span><span class="p">,</span><span class="n">MOD</span><span class="o">+</span><span class="mi">1</span><span class="o">&gt;&gt;</span><span class="mi">1</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">	<span class="k">return</span> <span class="n">min</span><span class="p">(</span><span class="n">ans</span><span class="p">.</span><span class="n">first</span><span class="p">,</span><span class="n">MOD</span><span class="o">-</span><span class="n">ans</span><span class="p">.</span><span class="n">first</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kr">inline</span> <span class="n">poly</span> <span class="nf">sqrt</span><span class="p">(</span><span class="k">const</span> <span class="n">poly</span> <span class="o">&amp;</span><span class="n">a</span><span class="p">,</span><span class="k">const</span> <span class="kt">int</span> <span class="o">&amp;</span><span class="n">n</span><span class="p">){</span>
</span></span><span class="line"><span class="cl">	<span class="k">if</span><span class="p">(</span><span class="n">n</span><span class="o">==</span><span class="mi">1</span><span class="p">)</span><span class="k">return</span> <span class="n">poly</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="n">remain</span><span class="p">(</span><span class="n">a</span><span class="p">[</span><span class="mi">0</span><span class="p">]));</span>
</span></span><span class="line"><span class="cl">	<span class="kt">int</span> <span class="n">l</span><span class="o">=</span><span class="mi">1</span><span class="p">;</span><span class="k">while</span><span class="p">(</span><span class="n">l</span><span class="o">&lt;=</span><span class="n">n</span><span class="o">&lt;&lt;</span><span class="mi">1</span><span class="p">)</span><span class="n">l</span><span class="o">&lt;&lt;=</span><span class="mi">1</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">	<span class="n">poly</span> <span class="n">b</span><span class="o">=</span><span class="n">sqrt</span><span class="p">(</span><span class="n">a</span><span class="p">,</span><span class="n">n</span><span class="o">+</span><span class="mi">1</span><span class="o">&gt;&gt;</span><span class="mi">1</span><span class="p">),</span><span class="n">c</span><span class="p">(</span><span class="n">l</span><span class="p">),</span><span class="n">d</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">	<span class="n">b</span><span class="p">.</span><span class="n">resize</span><span class="p">(</span><span class="n">n</span><span class="p">);</span><span class="n">d</span><span class="o">=</span><span class="n">inv</span><span class="p">(</span><span class="n">b</span><span class="p">)</span><span class="o">*</span><span class="n">INV2</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">	<span class="n">b</span><span class="p">.</span><span class="n">resize</span><span class="p">(</span><span class="n">l</span><span class="p">);</span><span class="n">d</span><span class="p">.</span><span class="n">resize</span><span class="p">(</span><span class="n">l</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">	<span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">i</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span><span class="n">i</span><span class="o">&lt;</span><span class="n">n</span><span class="p">;</span><span class="n">i</span><span class="o">++</span><span class="p">)</span><span class="n">c</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">=</span><span class="n">a</span><span class="p">[</span><span class="n">i</span><span class="p">];</span>
</span></span><span class="line"><span class="cl">	<span class="n">ntt</span><span class="p">(</span><span class="o">&amp;</span><span class="n">b</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="mi">0</span><span class="p">,</span><span class="n">l</span><span class="p">);</span><span class="n">ntt</span><span class="p">(</span><span class="o">&amp;</span><span class="n">c</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="mi">0</span><span class="p">,</span><span class="n">l</span><span class="p">);</span><span class="n">ntt</span><span class="p">(</span><span class="o">&amp;</span><span class="n">d</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="mi">0</span><span class="p">,</span><span class="n">l</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">	<span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">i</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span><span class="n">i</span><span class="o">&lt;</span><span class="n">l</span><span class="p">;</span><span class="n">i</span><span class="o">++</span><span class="p">)</span><span class="n">b</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">=</span><span class="n">mul</span><span class="p">(</span><span class="n">d</span><span class="p">[</span><span class="n">i</span><span class="p">],</span><span class="n">add</span><span class="p">(</span><span class="n">mul</span><span class="p">(</span><span class="n">b</span><span class="p">[</span><span class="n">i</span><span class="p">],</span><span class="n">b</span><span class="p">[</span><span class="n">i</span><span class="p">]),</span><span class="n">c</span><span class="p">[</span><span class="n">i</span><span class="p">]));</span>
</span></span><span class="line"><span class="cl">	<span class="n">ntt</span><span class="p">(</span><span class="o">&amp;</span><span class="n">b</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="mi">1</span><span class="p">,</span><span class="n">l</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">	<span class="n">b</span><span class="p">.</span><span class="n">resize</span><span class="p">(</span><span class="n">n</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">	<span class="n">clear</span><span class="p">(</span><span class="n">b</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">	<span class="k">return</span> <span class="n">b</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kr">inline</span> <span class="n">poly</span> <span class="nf">sqrt</span><span class="p">(</span><span class="k">const</span> <span class="n">poly</span> <span class="o">&amp;</span><span class="n">a</span><span class="p">){</span><span class="k">return</span> <span class="n">sqrt</span><span class="p">(</span><span class="n">a</span><span class="p">,</span><span class="n">a</span><span class="p">.</span><span class="n">size</span><span class="p">());}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kr">inline</span> <span class="n">poly</span> <span class="nf">deri</span><span class="p">(</span><span class="n">poly</span> <span class="n">a</span><span class="p">){</span>
</span></span><span class="line"><span class="cl">	<span class="kt">int</span> <span class="n">n</span><span class="o">=</span><span class="n">a</span><span class="p">.</span><span class="n">size</span><span class="p">();</span>
</span></span><span class="line"><span class="cl">	<span class="k">if</span><span class="p">(</span><span class="n">n</span><span class="o">==</span><span class="mi">1</span><span class="p">)</span><span class="k">return</span> <span class="n">poly</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">	<span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">i</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span><span class="n">i</span><span class="o">&lt;</span><span class="n">n</span><span class="p">;</span><span class="n">i</span><span class="o">++</span><span class="p">)</span><span class="n">a</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">=</span><span class="n">mul</span><span class="p">(</span><span class="n">a</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">],</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">	<span class="n">a</span><span class="p">.</span><span class="n">resize</span><span class="p">(</span><span class="n">n</span><span class="o">-</span><span class="mi">1</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">	<span class="k">return</span> <span class="n">a</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kr">inline</span> <span class="n">poly</span> <span class="nf">inte</span><span class="p">(</span><span class="n">poly</span> <span class="n">a</span><span class="p">){</span>
</span></span><span class="line"><span class="cl">	<span class="kt">int</span> <span class="n">n</span><span class="o">=</span><span class="n">a</span><span class="p">.</span><span class="n">size</span><span class="p">();</span>
</span></span><span class="line"><span class="cl">	<span class="n">a</span><span class="p">.</span><span class="n">resize</span><span class="p">(</span><span class="n">n</span><span class="o">+</span><span class="mi">1</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">	<span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">i</span><span class="o">=</span><span class="n">n</span><span class="p">;</span><span class="n">i</span><span class="p">;</span><span class="n">i</span><span class="o">--</span><span class="p">)</span><span class="n">a</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">=</span><span class="n">mul</span><span class="p">(</span><span class="n">a</span><span class="p">[</span><span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span><span class="n">qpow</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="n">MOD</span><span class="o">-</span><span class="mi">2</span><span class="p">));</span>
</span></span><span class="line"><span class="cl">	<span class="n">a</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">	<span class="k">return</span> <span class="n">a</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kr">inline</span> <span class="n">poly</span> <span class="nf">ln</span><span class="p">(</span><span class="k">const</span> <span class="n">poly</span> <span class="o">&amp;</span><span class="n">a</span><span class="p">){</span>
</span></span><span class="line"><span class="cl">	<span class="kt">int</span> <span class="n">n</span><span class="o">=</span><span class="n">a</span><span class="p">.</span><span class="n">size</span><span class="p">();</span>
</span></span><span class="line"><span class="cl">	<span class="n">poly</span> <span class="n">c</span><span class="o">=</span><span class="n">inv</span><span class="p">(</span><span class="n">a</span><span class="p">)</span><span class="o">*</span><span class="n">deri</span><span class="p">(</span><span class="n">a</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">	<span class="n">c</span><span class="p">.</span><span class="n">resize</span><span class="p">(</span><span class="n">n</span><span class="o">-</span><span class="mi">1</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">	<span class="k">return</span> <span class="n">inte</span><span class="p">(</span><span class="n">c</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kr">inline</span> <span class="n">poly</span> <span class="nf">exp</span><span class="p">(</span><span class="k">const</span> <span class="n">poly</span> <span class="o">&amp;</span><span class="n">a</span><span class="p">,</span><span class="k">const</span> <span class="kt">int</span> <span class="o">&amp;</span><span class="n">n</span><span class="p">){</span>
</span></span><span class="line"><span class="cl">	<span class="k">if</span><span class="p">(</span><span class="n">n</span><span class="o">==</span><span class="mi">1</span><span class="p">)</span><span class="k">return</span> <span class="n">poly</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">	<span class="n">poly</span> <span class="n">b</span><span class="o">=</span><span class="n">exp</span><span class="p">(</span><span class="n">a</span><span class="p">,</span><span class="n">n</span><span class="o">+</span><span class="mi">1</span><span class="o">&gt;&gt;</span><span class="mi">1</span><span class="p">),</span><span class="n">c</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">	<span class="n">b</span><span class="p">.</span><span class="n">resize</span><span class="p">(</span><span class="n">n</span><span class="p">);</span><span class="n">c</span><span class="o">=</span><span class="n">ln</span><span class="p">(</span><span class="n">b</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">	<span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">i</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span><span class="n">i</span><span class="o">&lt;</span><span class="n">n</span><span class="p">;</span><span class="n">i</span><span class="o">++</span><span class="p">)</span><span class="n">c</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">=</span><span class="n">sub</span><span class="p">(</span><span class="n">a</span><span class="p">[</span><span class="n">i</span><span class="p">],</span><span class="n">c</span><span class="p">[</span><span class="n">i</span><span class="p">]);</span>
</span></span><span class="line"><span class="cl">	<span class="n">inc</span><span class="p">(</span><span class="n">c</span><span class="p">[</span><span class="mi">0</span><span class="p">]);</span>
</span></span><span class="line"><span class="cl">	<span class="n">b</span><span class="o">*=</span><span class="n">c</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">	<span class="n">b</span><span class="p">.</span><span class="n">resize</span><span class="p">(</span><span class="n">n</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">	<span class="k">return</span> <span class="n">b</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kr">inline</span> <span class="n">poly</span> <span class="nf">exp</span><span class="p">(</span><span class="k">const</span> <span class="n">poly</span> <span class="o">&amp;</span><span class="n">a</span><span class="p">){</span><span class="k">return</span> <span class="n">exp</span><span class="p">(</span><span class="n">a</span><span class="p">,</span><span class="n">a</span><span class="p">.</span><span class="n">size</span><span class="p">());}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kr">inline</span> <span class="n">poly</span> <span class="nf">qpow</span><span class="p">(</span><span class="n">poly</span> <span class="n">a</span><span class="p">,</span><span class="k">const</span> <span class="kt">double</span> <span class="o">&amp;</span><span class="n">b</span><span class="p">){</span><span class="k">return</span> <span class="n">exp</span><span class="p">(</span><span class="n">ln</span><span class="p">(</span><span class="n">a</span><span class="p">)</span><span class="o">*</span><span class="n">b</span><span class="p">);}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">poly</span> <span class="n">a</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kt">int</span> <span class="nf">main</span><span class="p">(){</span>
</span></span><span class="line"><span class="cl">	<span class="n">srand</span><span class="p">(</span><span class="mi">19260817</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">	<span class="n">pre</span><span class="p">();</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">	<span class="n">scanf</span><span class="p">(</span><span class="s">&#34;%d%d&#34;</span><span class="p">,</span><span class="o">&amp;</span><span class="n">n</span><span class="p">,</span><span class="o">&amp;</span><span class="n">k</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">	<span class="n">read</span><span class="p">(</span><span class="n">a</span><span class="p">,</span><span class="mi">1</span><span class="o">+</span><span class="n">n</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">	<span class="n">a</span><span class="o">=</span><span class="n">deri</span><span class="p">(</span><span class="n">qpow</span><span class="p">(</span><span class="mi">1</span><span class="o">+</span><span class="n">ln</span><span class="p">(</span><span class="mi">2</span><span class="o">+</span><span class="n">a</span><span class="o">-</span><span class="n">a</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">-</span><span class="n">exp</span><span class="p">(</span><span class="n">inte</span><span class="p">(</span><span class="n">inv</span><span class="p">(</span><span class="n">sqrt</span><span class="p">(</span><span class="n">a</span><span class="p">))))),</span><span class="n">k</span><span class="p">));</span>
</span></span><span class="line"><span class="cl">	<span class="n">a</span><span class="p">.</span><span class="n">resize</span><span class="p">(</span><span class="n">n</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">	<span class="n">out</span><span class="p">(</span><span class="n">a</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">	<span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span></span></span></code></pre></td></tr></table>
</div>
</div><h2 id="珂朵莉树" class="heading-element"><span>珂朵莉树</span>
  <a href="#%e7%8f%82%e6%9c%b5%e8%8e%89%e6%a0%91" class="heading-mark">
    <svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg>
  </a>
</h2><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-c++" data-lang="c++"><span class="line"><span class="cl"><span class="c1">//以防我忘了set迭代器怎么写
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="k">struct</span> <span class="nc">node</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">	<span class="kt">int</span> <span class="n">l</span><span class="p">,</span> <span class="n">r</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">	<span class="k">mutable</span> <span class="n">lint</span> <span class="n">v</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">	<span class="n">node</span><span class="p">(</span><span class="kt">int</span> <span class="n">L</span><span class="p">,</span> <span class="kt">int</span> <span class="n">R</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="n">lint</span> <span class="n">V</span> <span class="o">=</span> <span class="mi">0</span><span class="p">)</span> <span class="o">:</span> <span class="n">l</span><span class="p">(</span><span class="n">L</span><span class="p">),</span> <span class="n">r</span><span class="p">(</span><span class="n">R</span><span class="p">),</span> <span class="n">v</span><span class="p">(</span><span class="n">V</span><span class="p">)</span> <span class="p">{}</span>
</span></span><span class="line"><span class="cl">	<span class="kt">bool</span> <span class="k">operator</span> <span class="o">&lt;</span> <span class="p">(</span><span class="k">const</span> <span class="n">node</span> <span class="o">&amp;</span><span class="n">o</span><span class="p">)</span> <span class="k">const</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">		<span class="k">return</span> <span class="n">l</span> <span class="o">&lt;</span> <span class="n">o</span><span class="p">.</span><span class="n">l</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">	<span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">};</span>
</span></span><span class="line"><span class="cl"><span class="n">set</span> <span class="o">&lt;</span><span class="n">node</span><span class="o">&gt;</span> <span class="n">s</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="n">IT</span> <span class="nf">spilit</span> <span class="p">(</span><span class="kt">int</span> <span class="n">pos</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">	<span class="n">IT</span> <span class="n">it</span> <span class="o">=</span> <span class="n">s</span><span class="p">.</span><span class="n">lower_bound</span><span class="p">(</span><span class="n">node</span><span class="p">(</span><span class="n">pos</span><span class="p">));</span>
</span></span><span class="line"><span class="cl">	<span class="k">if</span><span class="p">(</span><span class="n">it</span> <span class="o">!=</span> <span class="n">s</span><span class="p">.</span><span class="n">end</span><span class="p">()</span> <span class="o">&amp;&amp;</span> <span class="n">it</span><span class="o">-&gt;</span><span class="n">l</span> <span class="o">==</span> <span class="n">pos</span><span class="p">)</span> <span class="k">return</span> <span class="n">it</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">	<span class="n">it</span><span class="o">--</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">	<span class="kt">int</span> <span class="n">L</span> <span class="o">=</span> <span class="n">it</span> <span class="o">-&gt;</span> <span class="n">l</span><span class="p">,</span> <span class="n">R</span> <span class="o">=</span> <span class="n">it</span> <span class="o">-&gt;</span> <span class="n">r</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">	<span class="n">lint</span> <span class="n">V</span> <span class="o">=</span> <span class="n">it</span><span class="o">-&gt;</span><span class="n">v</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">	<span class="n">s</span><span class="p">.</span><span class="n">erase</span><span class="p">(</span><span class="n">it</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">	<span class="n">s</span><span class="p">.</span><span class="n">insert</span><span class="p">(</span><span class="n">node</span><span class="p">(</span><span class="n">L</span><span class="p">,</span> <span class="n">pos</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="n">V</span><span class="p">));</span>
</span></span><span class="line"><span class="cl">	<span class="k">return</span> <span class="n">s</span><span class="p">.</span><span class="n">insert</span><span class="p">(</span><span class="n">node</span><span class="p">(</span><span class="n">pos</span><span class="p">,</span> <span class="n">R</span><span class="p">,</span> <span class="n">V</span><span class="p">)).</span><span class="n">first</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="kt">void</span> <span class="nf">add</span><span class="p">(</span><span class="kt">int</span> <span class="n">l</span><span class="p">,</span> <span class="kt">int</span> <span class="n">r</span><span class="p">,</span> <span class="kt">int</span> <span class="n">val</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">	<span class="n">IT</span> <span class="n">il</span> <span class="o">=</span> <span class="n">spilit</span><span class="p">(</span><span class="n">l</span><span class="p">),</span> <span class="n">ir</span> <span class="o">=</span> <span class="n">spilit</span><span class="p">(</span><span class="n">r</span><span class="o">+</span><span class="mi">1</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">	<span class="k">for</span><span class="p">(;</span> <span class="n">il</span> <span class="o">!=</span> <span class="n">ir</span><span class="p">;</span> <span class="n">il</span><span class="o">-&gt;</span><span class="n">v</span> <span class="o">+=</span> <span class="n">val</span><span class="p">,</span> <span class="n">il</span><span class="o">++</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="kt">void</span> <span class="nf">tp</span><span class="p">(</span><span class="kt">int</span> <span class="n">l</span><span class="p">,</span> <span class="kt">int</span> <span class="n">r</span><span class="p">,</span> <span class="kt">int</span> <span class="n">val</span> <span class="o">=</span> <span class="mi">0</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">	<span class="n">IT</span> <span class="n">il</span> <span class="o">=</span> <span class="n">spilit</span><span class="p">(</span><span class="n">l</span><span class="p">),</span> <span class="n">ir</span> <span class="o">=</span> <span class="n">spilit</span><span class="p">(</span><span class="n">r</span><span class="o">+</span><span class="mi">1</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">	<span class="n">s</span><span class="p">.</span><span class="n">erase</span><span class="p">(</span><span class="n">il</span><span class="p">,</span> <span class="n">ir</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">	<span class="n">s</span><span class="p">.</span><span class="n">insert</span><span class="p">(</span><span class="n">node</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="n">r</span><span class="p">,</span> <span class="n">val</span><span class="p">));</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span></span></span></code></pre></td></tr></table>
</div>
</div></div><div class="post-footer" id="post-footer">
  <div class="post-info">
    <div class="post-info-line">
      <div class="post-info-mod">
        <span title="Updated on 2022-03-09 18:26:20">Updated on 2022-03-09&nbsp;</span>
      </div><div class="post-info-license">
            <span><a rel="license external nofollow noopener noreferrer" href="https://creativecommons.org/licenses/by-nc-sa/4.0/" target="_blank">CC BY-NC-SA 4.0</a></span>
          </div></div><div class="post-info-line">
        <div class="post-info-md"><span><a href="/posts/templates/index.md" title="Read Markdown" class="link-to-markdown">Read Markdown</a></span></div>
        <div class="post-info-share">
          <span><a href="javascript:void(0);" title="Share on X" data-sharer="twitter" data-url="https://www.sh1no.icu/posts/templates/" data-title="板子 (Ver.诗乃)" data-via="ShinoLeah"><i class="fa-brands fa-x-twitter fa-fw" aria-hidden="true"></i></a>
  <a href="javascript:void(0);" title="Share on Facebook" data-sharer="facebook" data-url="https://www.sh1no.icu/posts/templates/"><i class="fa-brands fa-facebook-square fa-fw" aria-hidden="true"></i></a>
  <a href="javascript:void(0);" title="Share on 微博" data-sharer="weibo" data-url="https://www.sh1no.icu/posts/templates/" data-title="板子 (Ver.诗乃)"><i class="fa-brands fa-weibo fa-fw" aria-hidden="true"></i></a>
  </span>
        </div>
      </div></div>

  <div class="post-info-more">
    <section class="post-tags"></section>
    <section>
      <span><a href="javascript:void(0);" onclick="window.history.back();">Back</a></span>&nbsp;|&nbsp;<span><a href="/">Home</a></span>
    </section>
  </div><div class="post-nav"><a href="/posts/d3ctf2022/" class="post-nav-item" rel="prev" title="D3CTF2022wp-BadW3ter &amp; D3bug"><i class="fa-solid fa-angle-left fa-fw" aria-hidden="true"></i>D3CTF2022wp-BadW3ter &amp; D3bug</a><a href="/posts/go-auth/" class="post-nav-item" rel="next" title="使用Go&#43;Gin&#43;Redis实现一个简单的登录注册系统">使用Go&#43;Gin&#43;Redis实现一个简单的登录注册系统<i class="fa-solid fa-angle-right fa-fw" aria-hidden="true"></i></a></div>
</div>
</article>

  <aside class="toc" id="toc-auto" aria-label="Contents"><h2 class="toc-title">Contents&nbsp;<i class="toc-icon fa-solid fa-angle-down fa-fw" aria-hidden="true"></i></h2>
      <div class="toc-content" id="toc-content-auto"></div></aside></main><footer class="footer">
    <div class="footer-container"><div class="footer-line powered">Powered by <a href="https://gohugo.io/" target="_blank" rel="external nofollow noopener noreferrer" title="Hugo 0.144.2"><img class="hugo-icon" src="/images/hugo.min.svg" alt="Hugo logo" /> Hugo</a> | Theme - <a href="https://github.com/hugo-fixit/FixIt" target="_blank" rel="external" title="FixIt v0.3.17-8b402129"><img class="fixit-icon" src="/images/fixit.min.svg" alt="FixIt logo" /> FixIt</a>
        </div><div class="footer-line copyright" itemscope itemtype="http://schema.org/CreativeWork"><i class="fa-regular fa-copyright fa-fw" aria-hidden="true"></i>
            <span itemprop="copyrightYear">2020 - 2025</span><span class="author" itemprop="copyrightHolder">
              <a href="/">Shino</a></span></div></div>
  </footer></div><div class="widgets"><div class="fixed-buttons animate__faster d-none"><div class="fixed-button back-to-top" role="button" aria-label="Back to Top"><i class="fa-solid fa-arrow-up fa-fw" aria-hidden="true"></i><span class="variant-numeric d-none">0%</span>
        </div></div><div id="mask"></div><div class="reading-progress-bar" style="left: 0;top: 0;"></div><noscript>
    <div class="noscript-warning">This website works best with JavaScript enabled.</div>
  </noscript>
</div><link rel="preload" href="/lib/katex/katex.min.css" as="style" onload="this.removeAttribute('onload');this.rel='stylesheet'">
    <noscript><link rel="stylesheet" href="/lib/katex/katex.min.css"></noscript><script src="/lib/autocomplete/autocomplete.min.js" defer></script><script src="/lib/fuse/fuse.min.js" defer></script><script src="/lib/sharer/sharer.min.js" async defer></script><script src="/lib/katex/katex.min.js" defer></script><script src="/lib/katex/auto-render.min.js" defer></script><script src="/lib/katex/copy-tex.min.js" defer></script><script src="/lib/katex/mhchem.min.js" defer></script><script>var postChatConfig={"addButton":true,"backgroundColor":"","blackDom":[".expiration-reminder","meting-js",".lnt"],"bottom":"","defaultChatQuestions":[],"defaultInput":false,"defaultSearchQuestions":[],"fill":"","frameHeight":"","frameWidth":"","height":"","left":"","showInviteLink":true,"upLoadWeb":true,"userDesc":"","userIcon":"","userMode":"magic","userTitle":"","width":""}</script><script src="https://ai.tianli0.top/static/public/postChatUser.min.js" defer data-postChat_key="94e33c8ca2fc6b925063d733c79bb98c27972f8f"></script><script>window.config={"code":{"copyTitle":"Copy to clipboard","editLockTitle":"Lock editable code block","editUnLockTitle":"Unlock editable code block","editable":true,"maxShownLines":10},"comment":{"enable":false},"enablePWA":true,"math":{"delimiters":[{"display":true,"left":"$$","right":"$$"},{"display":true,"left":"\\[","right":"\\]"},{"display":true,"left":"\\begin{equation}","right":"\\end{equation}"},{"display":true,"left":"\\begin{equation*}","right":"\\end{equation*}"},{"display":true,"left":"\\begin{align}","right":"\\end{align}"},{"display":true,"left":"\\begin{align*}","right":"\\end{align*}"},{"display":true,"left":"\\begin{alignat}","right":"\\end{alignat}"},{"display":true,"left":"\\begin{alignat*}","right":"\\end{alignat*}"},{"display":true,"left":"\\begin{gather}","right":"\\end{gather}"},{"display":true,"left":"\\begin{CD}","right":"\\end{CD}"},{"display":false,"left":"$","right":"$"},{"display":false,"left":"\\(","right":"\\)"}],"strict":false},"search":{"distance":100,"findAllMatches":false,"fuseIndexURL":"/search.json","highlightTag":"em","ignoreFieldNorm":false,"ignoreLocation":false,"isCaseSensitive":false,"location":0,"maxResultLength":10,"minMatchCharLength":2,"noResultsFound":"No results found","snippetLength":30,"threshold":0.3,"type":"fuse","useExtendedSearch":false},"version":"v0.3.17-8b402129"};</script><script src="/js/theme.min.js" defer></script></body>
</html>
